(()=>{"use strict";var e={6169:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.update_commentTags=t.checksamenameerr=t.samenameerr=t.formatMarkdowndetail=t.getincludetable=t.getFuncCallInfo=t.searchNode=t.detectExp=t.detectVariableType=t.detectExpType=t.getcacheproperty=t.cleardetectcache=t.getClassMembers=t.parseinclude=t.pathanalyze=t.Lexer=t.allIdentifierChar=t.isIdentifierChar=t.FuncNode=t.SymbolNode=t.SemanticTokenModifiers=t.SemanticTokenTypes=t.FuncScope=void 0;const i=n(7147),o=n(1017),r=n(7282),s=n(2374),a=n(6288),c=n(6630),l=n(4780),d=n(7994),u=n(3939);var f,p,h,m,g,y;function v(e){return!(e<48)&&(e<58||!(e<65)&&(e<91||(e<97?95===e:e<123||e>127)))}!function(e){e[e.DEFAULT=0]="DEFAULT",e[e.STATIC=1]="STATIC",e[e.GLOBAL=2]="GLOBAL"}(f=t.FuncScope||(t.FuncScope={})),function(e){e[e.class=0]="class",e[e.function=1]="function",e[e.method=2]="method",e[e.parameter=3]="parameter",e[e.variable=4]="variable",e[e.property=5]="property",e[e.keyword=6]="keyword",e[e.string=7]="string",e[e.number=8]="number"}(p=t.SemanticTokenTypes||(t.SemanticTokenTypes={})),function(e){e[e.definition=0]="definition",e[e.readonly=1]="readonly",e[e.static=2]="static",e[e.deprecated=3]="deprecated",e[e.modification=4]="modification",e[e.documentation=5]="documentation",e[e.defaultLibrary=6]="defaultLibrary"}(h=t.SemanticTokenModifiers||(t.SemanticTokenModifiers={})),function(e){e.create=function(e,t,n,i,o){return{name:e,kind:t,range:n,selectionRange:i,children:o}}}(m=t.SymbolNode||(t.SymbolNode={})),function(e){e.create=function(e,t,n,i,o,r,s){var a,c;let l="",d=[],u=!1;return null===(c=(a=o).format)||void 0===c||c.call(a,o),o.map((e=>{"*"!==e.name&&d.push(e),l+=", "+(e.ref?(u=!0,"&"):"")+e.name+(e.defaultVal?" := "+e.defaultVal:e.arr?"*":null===e.defaultVal?"?":"")})),l=(s?"static ":"")+e+"("+l.substring(2)+")",o=d,{assume:f.DEFAULT,static:s,hasref:u,name:e,kind:t,range:n,selectionRange:i,params:o,full:l,children:r,funccall:[],declaration:{},global:{},local:{},labels:{}}}}(g=t.FuncNode||(t.FuncNode={})),function(e){e.create=function(e,t,n){return{name:e,kind:t,range:n,selectionRange:n}}}(y||(y={})),t.isIdentifierChar=v,t.allIdentifierChar=new RegExp("^[^\0-/:-@[\\]^`{-]+$");let b=new RegExp("^;;\\s*(?<tag>.+)");const _=new RegExp(/(?<=['"\s])(c|background|#)?((0x)?[\da-f]{6}([\da-f]{2})?|(black|silver|gray|white|maroon|red|purple|fuchsia|green|lime|olive|yellow|navy|blue|teal|aqua))\b/i),k=JSON.parse('{ "black": "000000", "silver": "c0c0c0", "gray": "808080", "white": "ffffff", "maroon": "800000", "red": "ff0000", "purple": "800080", "fuchsia": "ff00ff", "green": "008000", "lime": "00ff00", "olive": "808000", "yellow": "ffff00", "navy": "000080", "blue": "0000ff", "teal": "008080", "aqua": "00ffff" }'),T=" \t\r\n",R="+ - * / % & ++ -- ** // = += -= *= /= //= .= == := != !== ~= > < >= <= >>> >> << >>>= >>= <<= && &= | || ! ~ , ?? : ? ^ ^= |= =>".split(" "),w="try,throw,return,global,local,static,if,switch,case,for,while,loop,continue,break,goto".split(","),S=w.concat(["class","in","is","isset","contains","else","until","catch","finally","and","or","not","as","super"]),C={BlockStatement:"BlockStatement",Statement:"Statement",ObjectLiteral:"ObjectLiteral",ArrayLiteral:"ArrayLiteral",Conditional:"Conditional",Expression:"Expression"},x=/^(alttab|alttabandmenu|alttabmenu|alttabmenudismiss|shiftalttab|shift|lshift|rshift|alt|lalt|ralt|control|lcontrol|rcontrol|ctrl|lctrl|rctrl|lwin|rwin|appskey|lbutton|rbutton|mbutton|wheeldown|wheelup|wheelleft|wheelright|xbutton1|xbutton2|joy1|joy2|joy3|joy4|joy5|joy6|joy7|joy8|joy9|joy10|joy11|joy12|joy13|joy14|joy15|joy16|joy17|joy18|joy19|joy20|joy21|joy22|joy23|joy24|joy25|joy26|joy27|joy28|joy29|joy30|joy31|joy32|joyx|joyy|joyz|joyr|joyu|joyv|joypov|joyname|joybuttons|joyaxes|joyinfo|space|tab|enter|escape|esc|backspace|bs|delete|del|insert|ins|pgdn|pgup|home|end|up|down|left|right|printscreen|ctrlbreak|pause|scrolllock|capslock|numlock|numpad0|numpad1|numpad2|numpad3|numpad4|numpad5|numpad6|numpad7|numpad8|numpad9|numpadmult|numpadadd|numpadsub|numpaddiv|numpaddot|numpaddel|numpadins|numpadclear|numpadleft|numpadright|numpaddown|numpadup|numpadhome|numpadend|numpadpgdn|numpadpgup|numpadenter|f1|f2|f3|f4|f5|f6|f7|f8|f9|f10|f11|f12|f13|f14|f15|f16|f17|f18|f19|f20|f21|f22|f23|f24|browser_back|browser_forward|browser_refresh|browser_stop|browser_search|browser_favorites|browser_home|volume_mute|volume_down|volume_up|media_next|media_prev|media_stop|media_play_pause|launch_mail|launch_media|launch_app1|launch_app2|vk[a-f\d]{1,2}(sc[a-f\d]+)?|sc[a-f\d]+|`[;{]|[\x21-\x3A\x3C-\x7E])$/i,E={type:"",content:"",offset:0,length:0,topofline:0,next_token_offset:-1};let D={},O={};class K{constructor(e,t){this.message=e,this.token=t}}class P{constructor(e,n,o=0){let r,_,k,D,O,L,N,M,I,j,q,F,W,$,V,H;this.actived=!1,this.children=[],this.d=0,this.declaration={},this.diagnostics=[],this.diags=0,this.foldingranges=[],this.funccall=[],this.include={},this.includedir=new Map,this.dlldir=new Map,this.dllpaths=[],this.labels={},this.libdirs=[],this.object={method:{},property:{},userdef:{}},this.reflat=!1,this.isparsed=!1,this.scriptdir="",this.scriptpath="",this.tokens={},this.STB=new s.SemanticTokensBuilder,this.linepos={},this.strcommpos=[],this.texts={},this.uri="",this.anonymous=[];let z,G,Y,X,J,Q,Z,ee,te,ne,ie,oe,re,se,ae,ce=this,le=u.isahk2_h,de="",ue=[],fe={},pe=!0,he=!1,me=!1,ge={TK_START_EXPR:function(){var e;Ne()||Ue()&&xe();let t=C.Expression;if("["===M){if(!Y)if(null===(e=ae.previous_token)||void 0===e?void 0:e.callinfo)X=!0;else if(["TK_WORD","TK_STRING","TK_END_EXPR"].includes(q))return Ke(t),O.indentation_level=qe(),Ee(),k.indentation_level=O.indentation_level+1,void(D.space_in_paren&&(X=!0));"TK_RESERVED"===q&&(X=!0),t=C.ArrayLiteral,Pe(k.mode)&&("["!==k.last_text&&(","!==k.last_text||"]"!==W&&"}"!==W)||D.keep_array_indentation||xe())}else ae.ignore?xe(!0):"TK_END_EXPR"===q||"TK_WORD"===q?X=T.includes(ae.prefix_is_whitespace||"\0"):"TK_STRING"===q?X=!0:"TK_RESERVED"===q&&(X=!F.match(/^(break|continue|goto)$/i)&&(["if","for","while","loop","case","catch","switch"].includes(F)?Boolean(D.space_before_conditional):te));if(Y&&D.preserve_newlines?xe(!0):"TK_EQUALS"!==q&&"TK_COMMA"!==q&&"TK_OPERATOR"!==q||Le()||Ce(),Ke(t),k.indentation_level=qe(),Ee(),ae.ignore){let e=ae.data.content;e&&Ee(e)}else D.space_in_paren&&(X=!0);De(),"["!==M||D.keep_array_indentation||xe(!0)},TK_END_EXPR:function(){for(;k.mode===C.Statement;)Ae();("TK_END_EXPR"===q||"TK_END_BLOCK"===q)&&k.indentation_level<k.parent.indentation_level?we():Ce("]"===M&&Pe(k.mode)&&!D.keep_array_indentation),X=Boolean(D.space_in_paren&&!("TK_START_EXPR"===q&&!D.space_in_empty_paren)),Ae(),Se()&&O.indentation_level===k.indentation_level&&(Oe(),O.indentation_level===k.indentation_level&&we()),Ee()},TK_START_BLOCK:function(){var e;if(ae.data)Ke(C.ObjectLiteral),Q=!(null===(e=ce.tokens[ae.next_token_offset])||void 0===e?void 0:e.topofline),k.indentation_level=qe(),O.mode!==C.Conditional&&(O.indentation_level=k.indentation_level),Pe(O.mode)&&","===k.last_text&&Y&&D.preserve_newlines&&(k.indentation_level=++O.indentation_level,xe()),X||(X="TK_START_EXPR"!==q&&te),Ee(),De(),X=te;else{if(!["try","if","for","while","loop","catch","else","finally"].includes(k.last_word))for(;k.mode===C.Statement;)Ae();Ke(C.BlockStatement),k.had_comment=O.had_comment,X=te,O.in_case_statement&&k.last_text.endsWith(":")&&(k.indentation_level--,we()),(0===D.one_true_brace||Y&&D.preserve_newlines&&!D.one_true_brace)&&xe(!0);let e=!Se();Ee(),De(),e||void 0!==D.one_true_brace?xe():X=te}},TK_END_BLOCK:function(){for(;k.mode===C.Statement;)Ae();let e=k.mode===C.ObjectLiteral;e?"TK_START_BLOCK"===q?X=!1:Pe(k.mode)&&D.keep_array_indentation?(D.keep_array_indentation=!1,xe(),D.keep_array_indentation=!0):(X=te,("TK_END_EXPR"===q||"TK_END_BLOCK"===q)&&k.indentation_level<k.parent.indentation_level?we():(Y&&D.preserve_newlines||k.mode!==C.ObjectLiteral||!Q)&&xe()):(void 0!==D.one_true_brace||Y)&&xe(),Ae(),O.indentation_level===k.indentation_level&&Se()&&Oe(),Ee(),e||(k.in_case_statement&&k.last_text.endsWith(":")&&k.indentation_level++,void 0!==D.one_true_brace&&xe(!0),X=te)},TK_WORD:Fe,TK_RESERVED:Fe,TK_STRING:function(){if(Ne()?Y&&D.preserve_newlines?xe(!0):X=!0:"TK_RESERVED"===q||"TK_WORD"===q?Y?xe():X=!0:"TK_COMMA"===q||"TK_START_EXPR"===q||"TK_EQUALS"===q||"TK_OPERATOR"===q?Le()||Ce():(Y&&xe(),X=!ae.ignore&&void 0===ae.data),ae.ignore)return xe(!0),void(_[_.length-1].text=[M]);Ee()},TK_EQUALS:function(){Ne(),X=te,Ee(),X=te},TK_OPERATOR:function(){var e,t,n,i;let o=Boolean(te||M.match(/^\w/)),s=o;if((null===(e=ae.previous_token)||void 0===e?void 0:e.callinfo)&&(X=!0),Ne()){if(I.match(/^(\+\+|--|%|!|~|not)$/))return X=!0,Ee(),void(X="not"===I)}else if("=>"===M)k.mode===C.BlockStatement&&Ke(C.Statement),De();else if(I.match(/^(\+\+|--|%|!|~|not)$/)&&Ue())return xe(),Ee(),void(X="not"===I);if("TK_RESERVED"===q&&(X=!0),"%"===M)return s=Boolean(void 0!==ae.previous_pair_pos&&" \t".includes(r.charAt(ae.offset+1)||"\0")),X||(X=Boolean(ae.next_pair_pos&&" \t".includes(ae.prefix_is_whitespace||"\0"))),Y&&D.preserve_newlines&&k.mode===C.Statement&&$e(null!==(t=ae.previous_token)&&void 0!==t?t:E,ae)&&xe(!0),Ee(),void(X=s);if(":"===M&&(k.in_case||k.mode===C.Statement&&k.parent.in_case))return k.in_case||Ae(),De(),Ee(),Me("\n")?xe():X=te,k.in_case=!1,void(k.case_body=!0);if(Y&&D.preserve_newlines?xe(!0):"TK_OPERATOR"!==q||F.match(/^(--|\+\+|%|!|~|not)$/)||Ce(),["--","++","!","~"].includes(M)||"-+".includes(M)&&(["TK_START_BLOCK","TK_START_EXPR","TK_EQUALS","TK_OPERATOR","TK_COMMA","TK_RESERVED"].includes(q)||(null===(n=ae.previous_token)||void 0===n?void 0:n.callinfo)))s=!1,o="!"===M&&"TK_WORD"===q,X||"++"!==M&&"--"!==M||!["TK_END_EXPR","TK_WORD"].includes(q)||(s=!0);else if(":"===M)k.ternary_depth?k.ternary_depth--:o=!1;else if("?"===M)if(ae.ignore)o=s=!1;else if(k.ternary_depth+=1,k.indentation_level){if(_.length){let e=_[_.length-1].text;e[k.indentation_level-(e[0]===re?0:1)]===$&&De()}}else De();else"."===M?s=o=!0:"&"===M?(("TK_WORD"!==q&&"TK_END_EXPR"!==q||(null===(i=ae.previous_token)||void 0===i?void 0:i.callinfo))&&(s=!1),"TK_COMMA"!==q&&"TK_START_EXPR"!==q||(o=!1)):"*"===M&&("("===F||"TK_WORD"===q&&(Me(")")||Me("]"))?o=s=!1:","===F&&(s=!1));X||(X=o),Ee(),X=s},TK_COMMA:function(){var e;(k.mode===C.BlockStatement||k.declaration_statement)&&(Ke(C.Statement),De()),"TK_WORD"===q&&T.includes(ae.prefix_is_whitespace||"\0")&&(null===(e=ae.previous_token)||void 0===e?void 0:e.callinfo)?Y&&D.preserve_newlines?xe(!0):X=!0:(X=te&&"TK_COMMA"===q,k.mode===C.Statement&&k.parent.mode===C.ObjectLiteral&&Ae(),Y&&D.preserve_newlines?xe(!0):Se()||(Y=!1)),Ee(),Y||Q||k.mode!==C.ObjectLiteral?X=te:xe()},TK_BLOCK_COMMENT:function(){var e,t;let n,i,o=M.split("\n"),r=!o[0].match(/^\/\*(@ahk2exe-keep|[^*]|$)/i),s="";if(!r&&(n=o[o.length-1].match(/^(\s)\1*/))&&" "!==n[0]&&(s=new RegExp(`^${n[1]}{1,${n[0].length}}`)),xe(!0),k.mode===C.Statement){let n=ce.tokens[null===(e=ae.previous_token)||void 0===e?void 0:e.next_token_offset];n&&(k.in_expression||$e(null!==(t=n.previous_token)&&void 0!==t?t:E,n))?k.had_comment<2&&we():xe()}for(Ee(o[0].trimRight()),i=1;i<o.length-1;i++)xe(!0),Ee(r?" * "+o[i].replace(/^\s*\* ?|\s+$/g,""):o[i].trimRight().replace(s,""));o.length>1&&(xe(!0),Ee((r?" ":"")+o[o.length-1].trim())),xe(!0),k.had_comment=3},TK_INLINE_COMMENT:function(){if(D.ignore_comment)return M="";Se()&&_.pop(),_[_.length-1].text.push($||"\t",M),xe(!0),k.had_comment=1},TK_COMMENT:function(){var e,t;if(!D.ignore_comment){if(xe(!0),k.mode===C.Statement){let n=ce.tokens[null===(e=ae.previous_token)||void 0===e?void 0:e.next_token_offset];n&&(k.in_expression||$e(null!==(t=n.previous_token)&&void 0!==t?t:E,n))?k.had_comment<2&&we():xe()}M.split("\n").map((e=>{xe(!0),Ee(e.trim())})),xe(!0),k.had_comment=2}},TK_DOT:function(){Ne(),Ce(")"===k.last_text&&D.break_chained_methods),Ee()},TK_HOT:We,TK_SHARP:We,TK_NUMBER:function(){j="TK_WORD",Fe()},TK_LABEL:function(){if(xe(),"default:"===I&&(k.in_case_statement||k.mode===C.BlockStatement&&"switch"===k.last_word))return k.case_body?Oe():k.case_body=!0,Ee(),De(),k.in_case=!1,k.in_case_statement=!0,void(X=te);Ee();let e=_[_.length-1].text;""===e[0].trim()?_[_.length-1].text=e.slice(1):De()},TK_HOTLINE:We,TK_UNKNOWN:function(){Ee(),xe()}};function ye(e,t){D={keep_array_indentation:!0,max_preserve_newlines:1},te=!0,$="\t",delete t.format,he=!0,re="";for(let n of t){if(!n.range_offset)continue;let[t,i]=n.range_offset;for(delete n.range_offset,q=W=F="",_=[{text:[],indent:0}],X=!1,L=[],k=null,Ke(C.Expression),ae=e[e[t].next_token_offset];ae&&ae.offset<i;ae=e[ae.next_token_offset])j=ae.type,M=ae.content,I=M.toLowerCase(),ge[j](),W=k.last_text,q=j,k.last_text=F=I;n.defaultVal=_.map((e=>e.text.join(""))).join("\n").trim()}he=!1,_=[]}function ve(e=0,n=new Map,i=""){var o,a;const c=[],b=ce.document,_=ce.tokens;let k,R,S,C,x,D=n.get("#parent")||ce,O=null!==(o=ce.tokens[z-1])&&void 0!==o?o:E,P=null!==(a=O.previous_token)&&void 0!==a?a:E,A=0,L=0,N=!0,M="",I=[];return pe=!0,0!==e&&(I.push(z-1),delete O.data),q(),"TK_EOF"===O.type&&A>(0===e?0:-1)&&ce.addDiagnostic(d.diagnostic.missing("}"),I[A-(0===e?1:0)],1),c;function j(e){if("("!==r.charAt(O.offset+O.length))return!1;let t=P,n=O,i=se,o=z,s="",a=0,c=O.topofline>0,l="";for(pe=!1;ge();)if("("===(s=O.content))a++;else if(")"===s&&!--a){ge(),l=O.content;break}return P=t,O=n,se=i,z=o,N=!0,"=>"===l||c&&"{"===l}function q(n=0,o=0){var a,l,u,f,v,w,K,q,W,U;let V=L;for(L=o,"TK_START_BLOCK"===O.type&&(delete O.data,ge(),N=!1,O.topofline||P.topofline||ce.addDiagnostic(d.diagnostic.unexpected(O.content),O.offset,O.length));pe=!0,ge();){let o;switch(1===O.topofline&&(R=O.offset,2===e?"TK_RESERVED"!==O.type&&t.allIdentifierChar.test(O.content)&&(O.type="TK_WORD",delete O.semantic):":"===r.charAt(z)&&(T.includes(r.charAt(z+1))&&t.allIdentifierChar.test(O.content)||L&&"default"===O.content.toLowerCase())&&((o=_[z])&&((O.next_token_offset=o.next_token_offset)>0&&(_[o.next_token_offset].previous_token=O),delete _[z]),O.content+=":",O.length++,O.type="TK_LABEL",z++,R=void 0)),O.type){case"TK_EOF":return;case"TK_WORD":if(O.topofline>0){let t=j();if(ge(),t||!le||2===e||1!==P.topofline||O.topofline||"TK_WORD"!==O.type||"macro"!==P.content.toLowerCase()||(O.topofline=1,(t=j())?ge():O.topofline=0),t){let t,n,o=P,r=c.length,l=P.semantic={type:2===e?p.method:p.function},u=Q(),f=2===o.topofline,m=f?null===(a=o.previous_token)||void 0===a?void 0:a.offset:o.offset;if(R=void 0,(M=o.content.toLowerCase()).match(/^\d/)&&ce.addDiagnostic(d.diagnostic.invalidsymbolname(o.content),o.offset,o.length),u||(u=[],ce.addDiagnostic(d.diagnostic.invalidparam(),o.offset,O.offset+1-o.offset)),o.symbol=t=g.create(o.content,2===e?s.SymbolKind.Method:s.SymbolKind.Function,s.Range.create(o.pos=b.positionAt(o.offset),{line:0,character:0}),ke(o.offset,o.length),u,void 0,f),0!==e&&(t.parent=D),ge()&&"=>"===O.content){let n=c.splice(r),i=e,o=D;e|=1,D=t;let s=G(x,void 0,"return",1);c.push(t),D=o,e=i,t.range.end=b.positionAt(P.offset+P.length),ce.addFoldingRangePos(t.range.start,t.range.end,"line"),t.returntypes=x,t.children=n.concat(s);for(const e in x)x[e]=t.range.end;ce.linepos[t.range.end.line]=m}else{if("{"!==O.content){ce.addDiagnostic(d.diagnostic.unexpected(O.content),O.offset,O.length);break}{let n=c.splice(r),o=new Map,s=O.offset;O.previous_pair_pos=m,o.set("#parent",t),t.funccall=[],c.push(t),t.children=n,t.children.push(...ve(1|e,o,i)),t.range.end=b.positionAt(z),ce.addSymbolFolding(t,s)}}l.modifier=1<<h.definition|1<<h.readonly|(f?1<<h.static:0),(n=fe[t.selectionRange.start.line])&&(t.detail=_e(n.content)),t.closure=!!(1&e)&&!f,me(t),2===e&&(t.full=`(${i.slice(0,-1)}) `+t.full,f||"__new"!==t.name.toLowerCase()||(t.returntypes={[i.replace(/([^.]+)\.?$/,"@$1")]:t.range.end}),ce.object.method[M]||(ce.object.method[M]=[]),ce.object.method[M].push(t));break}if(2===e){if("["===r.charAt(P.offset+P.length)||O.content.match(/^(=>|\{)$/)){let t,n=P,o=c.length,r=[];if(R=void 0,"["===O.content&&(r=null!==(l=Q(void 0,"]"))&&void 0!==l?l:[],ge(),0===r.length&&ce.addDiagnostic(d.diagnostic.propemptyparams(),n.offset,P.offset-n.offset+1),!O.content.match(/^(=>|\{)$/))){ce.addDiagnostic(d.diagnostic.propdeclaraerr(),n.offset,n.length),N=!1;break}let a=2===n.topofline,m=a?null===(u=n.previous_token)||void 0===u?void 0:u.offset:n.offset,_=n.symbol=s.DocumentSymbol.create(n.content,void 0,s.SymbolKind.Property,t=ke(n.offset,n.length),Object.assign({},t));if((k=fe[_.selectionRange.start.line])&&(_.detail=_e(k.content)),null===(f=r.format)||void 0===f||f.call(r,r),_.parent=D,_.params=r,_.full=`(${i.slice(0,-1)}) ${a?"static ":""}${n.content}`+(r.length?`[${r.map((e=>(e.ref?"&":"")+e.name+(e.defaultVal?" := "+e.defaultVal:e.arr?"*":null===e.defaultVal?"?":""))).join(", ")}]`:""),_.static=a,_.children=c.splice(o),c.push(_),ue(n),_.funccall=[],n.semantic={type:p.property,modifier:1<<h.definition|(a?1<<h.static:0)},"{"===O.content){let t,n,o,a=e,c=O.offset;for(O.previous_pair_pos=m,ge(),N=!1,e=1,"TK_END_BLOCK"!==O.type||P.topofline||O.topofline||ce.addDiagnostic(d.diagnostic.unexpected(O.content),O.offset,O.length);ge()&&"TK_END_BLOCK"!==O.type;)if(O.topofline&&(O.content=O.content.toLowerCase()).match(/^[gs]et$/)){let a;if(O.semantic={type:p.function,modifier:1<<h.definition|1<<h.readonly},ge(),t=P,"=>"===O.content){let n,i={},c=D.funccall.length;o=g.create(P.content.toLowerCase(),s.SymbolKind.Function,ke(P.offset,z-P.offset),ke(P.offset,P.length),[...r]),P.content.match(/^\d/)&&ce.addDiagnostic(d.diagnostic.invalidsymbolname(P.content),P.offset,P.length),P.symbol=o,e=3,o.parent=_,n=G(i,void 0,"return",1),e=2,null===(v=o.funccall)||void 0===v||v.push(...D.funccall.splice(c)),o.range.end=b.positionAt(P.offset+P.length),_.range.end=o.range.end,ce.addFoldingRangePos(o.range.start,o.range.end,"line"),o.returntypes=i,o.children=[],"=>"===P.content&&ce.addDiagnostic(d.diagnostic.invaliddefinition("function"),t.offset,t.length);for(const e in i)i[e]=o.range.end;"set"===t.content.toLowerCase()&&(o.params.unshift(a=y.create("Value",s.SymbolKind.Variable,s.Range.create(0,0,0,0))),a.detail=d.completionitem.value()),o.children.push(...n),me(o),ce.linepos[o.range.end.line]=t.offset}else if("{"===O.content){n=O,t.symbol=o=g.create(t.content,s.SymbolKind.Function,ke(t.offset,z-t.offset),ke(t.offset,3),[...r]);let e=new Map([["#parent",o]]);o.parent=_,o.children=ve(3,e,i),o.range.end=b.positionAt(z),"set"===t.content.toLowerCase()&&(o.params.unshift(a=y.create("Value",s.SymbolKind.Variable,s.Range.create(0,0,0,0))),a.detail=d.completionitem.value()),me(o),ce.addSymbolFolding(o,n.offset),t.content.match(/^\d/)&&ce.addDiagnostic(d.diagnostic.invalidsymbolname(t.content),t.offset,t.length)}else{if(ce.addDiagnostic(d.diagnostic.invalidprop(),O.offset,O.length),"}"===O.content){N=!1;break}{o=void 0;let e=0;for(;"TK_EOF"!==O.type;){if("{"===O.content)e++;else if("}"===O.content&&--e<0)break;ge()}N=!1}}o&&_.children.push(o)}else{let e=0;for(ce.addDiagnostic(d.diagnostic.invalidprop(),O.offset,O.length),N=!1;ge();)if("{"===O.content)e++;else if("}"===O.content&&--e<0)break;N=!1}_.range.end=b.positionAt(z-1),e=a,ce.addSymbolFolding(_,c)}else if("=>"===O.content){let n,i=z,o={},a=D.funccall.length;e=3,n=g.create("get",s.SymbolKind.Function,t=ke(i,z-i),Object.assign({},t),r),n.parent=_,n.children=G(o,void 0,"return",1),n.returntypes=o,null===(w=n.funccall)||void 0===w||w.push(...D.funccall.splice(a)),e=2,n.range.end=b.positionAt(P.offset+P.length),_.range.end=n.range.end,ce.addFoldingRangePos(n.range.start,n.range.end,"line");for(const e in o)o[e]=n.range.end;0!==e&&(n.parent=D),me(n),_.children.push(n),ce.linepos[_.range.end.line]=m}1===_.children.length&&"get"===_.children[0].name&&(n.semantic.modifier=(n.semantic.modifier||0)|1<<h.readonly);break}":="!==O.content?(ce.addDiagnostic(d.diagnostic.propdeclaraerr(),P.offset,P.length),N=!1,O.topofline||(O=P,P=E,z=O.offset+O.length,G())):(O=P,P=E,N=!1,z=O.offset+O.length,c.push(...X("")),void 0!==R&&(ce.linepos[(null!==(K=P.pos)&&void 0!==K?K:P.pos=b.positionAt(P.offset)).line]=R))}else $(O),O=P,P=E,z=O.offset+O.length,B(),void 0!==R&&(ce.linepos[(null!==(q=P.pos)&&void 0!==q?q:P.pos=b.positionAt(P.offset)).line]=R);break}2===e?c.push(...X("")):(O.topofline?B():(N=!1,c.push(...G())),void 0!==R&&(ce.linepos[(null!==(W=P.pos)&&void 0!==W?W:P.pos=b.positionAt(P.offset)).line]=R));break;case"TK_SHARP":Y();break;case"TK_RESERVED":F();break;case"TK_START_BLOCK":2===e?ce.addDiagnostic(d.diagnostic.unexpected(O.content),O.offset,O.length):(A++,I.push(z-1));break;case"TK_END_BLOCK":if(--A>=0&&I.length){let e=I.pop();ce.addFoldingRange(O.previous_pair_pos=e,z-1),_[e].next_pair_pos=O.offset,1===O.topofline&&(oe=O.offset,Z=!0)}if(A<n){if(0!==e||0!==n)return I.length&&(_[O.previous_pair_pos=I[I.length-1]].next_pair_pos=O.offset),void(L=V);ce.addDiagnostic(d.diagnostic.unexpected("}"),O.offset,1),A=0,I.length=0}break;case"TK_END_EXPR":ce.addDiagnostic(d.diagnostic.unexpected(O.content),O.offset,1),R=void 0;break;case"TK_LABEL":if(L&&"default:"===O.content.toLowerCase()){ge(),N=!1,O.topofline||(O.topofline=-1);break}if(2===e){ce.addDiagnostic(d.diagnostic.propdeclaraerr(),O.offset,O.length);break}O.symbol=S=m.create(O.content,s.SymbolKind.Field,ke(O.offset,O.length),ke(O.offset,O.length-1)),c.push(S),D.labels&&(M=O.content.toLowerCase().slice(0,-1),S.def=!0,D.labels[M]?D.labels[M][0].def?(ce.addDiagnostic(d.diagnostic.duplabel(),O.offset,O.length-1),D.labels[M].push(S)):D.labels[M].unshift(S):D.labels[M]=[S]),(k=fe[S.selectionRange.start.line])&&(S.detail=_e(k.content)),(o=ce.get_token(z,!0)).topofline||ce.addDiagnostic(d.diagnostic.unexpected(o.content),o.offset,o.length);break;case"TK_HOTLINE":if(O.symbol=S=m.create(O.content,s.SymbolKind.Event,ke(O.offset,O.length),ke(O.offset,O.length-2)),S.range.end=b.positionAt(z-1),c.push(S),(k=fe[S.selectionRange.start.line])&&(S.detail=_e(k.content)),0!==e&&ce.addDiagnostic(d.diagnostic.hotdeferr(),O.offset,O.length),O.ignore){for(;ge()&&O.ignore&&"TK_STRING"===O.type;);S.range.end=b.positionAt(P.offset+P.length),N=!1;break}(O.content.match(/\s::$/)||(C=O.content.match(/\S(\s*)&(\s*)\S+::/))&&(""===C[1]||""===C[2]))&&ce.addDiagnostic(d.diagnostic.invalidhotdef(),O.offset,O.length);break;case"TK_HOT":{0!==e?ce.addDiagnostic(d.diagnostic.hotdeferr(),O.offset,O.length):O.ignore||!O.content.match(/\s::$/)&&(!(C=O.content.match(/\S(\s*)&(\s*)\S+::/))||""!==C[1]&&""!==C[2])||ce.addDiagnostic(d.diagnostic.invalidhotdef(),O.offset,O.length);let t=m.create(O.content,s.SymbolKind.Event,ke(O.offset,O.length),ke(O.offset,O.length-2));(k=fe[t.selectionRange.start.line])&&(t.detail=_e(k.content)),O.symbol=t,ge();let n,i=P,o=new Map([["#parent",t]]);if(t.funccall=[],t.declaration={},c.push(t),t.global={},t.local={},"{"===O.content)O.previous_pair_pos=i.offset,t.params=[n=y.create("ThisHotkey",s.SymbolKind.Variable,ke(0,0))],n.detail=d.completionitem.thishotkey(),t.children=[],t.children.push(...ve(1,o)),t.range=ke(i.offset,z-i.offset),ce.addSymbolFolding(t,O.offset),me(t);else if(O.topofline){for(me(t);"TK_SHARP"===O.type;)Y(),ge();if(N=!1,O.type.startsWith("TK_HOT"))break;"TK_WORD"===O.type&&j()||ce.addDiagnostic(d.diagnostic.hotmissbrace(),P.offset,P.length),N=!1}else{let n=D,o=e,s=O.content.toLowerCase();if(D=t,e=1,"return"===s)t.children=G(void 0,void 0,"return");else if(["global","local","static"].includes(s)){let e=D,n=c.length;D=t,F(),t.children=c.splice(n),D=e}else{let e=c.length;N=!1,H(null,i.offset),t.children=c.splice(e)}D=n,e=o,me(t);let a=P.offset+P.length;for(;" \t".includes(r.charAt(a)||"\0");)a++;t.range=ke(i.offset,a-i.offset),ce.linepos[t.range.end.line]=i.offset}break}case"TK_UNKNOWN":ce.addDiagnostic(d.diagnostic.unknowntoken(O.content),O.offset,O.length);break;default:O.topofline&&(P=E),N=!1,2===e?(ce.addDiagnostic(d.diagnostic.propdeclaraerr(),O.offset,O.length),G()):(c.push(...G()),void 0!==R&&(ce.linepos[(null!==(U=P.pos)&&void 0!==U?U:P.pos=b.positionAt(P.offset)).line]=R))}}}function F(){let n,o=O.content.toLowerCase(),a=O.offset,l=P,u=z;if(pe=!1,2===e){if(n=je(),N=!1,z=u,O.type="TK_WORD",".[(".includes(r.charAt(O.offset+O.length))||n.content.match(/^(:=|=>|\{)$/))return;if("TK_EQUALS"===n.type||"class"!==o&&"static"!==o)return;n=void 0,N=!0,O.type="TK_RESERVED"}else if("%"===r.charAt(O.offset-1)||"%"===r.charAt(O.offset+O.length))return O.type="TK_WORD",N=!1,void(O.semantic={type:p.variable});switch(o){case"class":if(!O.topofline||1&e){N=!1,O.type="TK_WORD";break}let g,v,_="",T=new Map;if(ge(),O.topofline||"TK_RESERVED"!==O.type||(O.type="TK_WORD",2!==e&&ce.addDiagnostic(d.diagnostic.reservedworderr(O.content),O.offset,O.length)),!O.topofline&&"TK_WORD"===O.type){if(1&e&&ce.addDiagnostic(d.diagnostic.classinfuncerr(),O.offset,O.length),g=O,ge(),"extends"===O.content.toLowerCase())if(O=je(),"TK_WORD"===O.type){for(_=O.content,c.push(y.create(O.content,s.SymbolKind.Variable,v=ke(O.offset,O.length)));z<ne&&"."===r.charAt(z)&&(z++,O=je(),"TK_WORD"===O.type);)_+="."+O.content;"TK_WORD"===O.type&&ge()}else ce.addDiagnostic(d.diagnostic.unexpected(O.content),O.offset,O.length);if("TK_START_BLOCK"!==O.type){N=!1;break}O.previous_pair_pos=a,g.content.match(/^\d/)&&ce.addDiagnostic(d.diagnostic.invalidsymbolname(g.content),g.offset,g.length);let t=s.DocumentSymbol.create(g.content,void 0,s.SymbolKind.Class,ke(0,0),ke(g.offset,g.length));g.symbol=t,T.set("#parent",t),t.full=i+g.content,t.funccall=[],t.children=[],t.cache=[],t.staticdeclaration={},t.declaration={},t.returntypes={[(i+"@"+g.content).toLowerCase()]:!0},(k=fe[t.selectionRange.start.line])&&(t.detail=_e(k.content)),_&&(t.extends=_),t.children.push(...ve(2,T,i+g.content+".")),t.range=ke(a,z-a),me(t),g.semantic={type:p.class,modifier:1<<h.definition|1<<h.readonly},ce.addSymbolFolding(t,O.offset);for(const e of t.children)e.children&&e.kind!=s.SymbolKind.Property&&(e.parent=t);return c.push(t),!0}N=!1,P.type="TK_WORD",z=P.offset+P.length,O=P,P=l;break;case"global":case"static":case"local":if(ge(),2===e&&!O.topofline&&t.allIdentifierChar.test(O.content)&&(O.type="TK_WORD"),O.topofline)2===e?ce.addDiagnostic(d.diagnostic.propdeclaraerr(),P.offset,P.length):"local"===o?ce.addDiagnostic(d.diagnostic.declarationerr(),P.offset,P.length):(D.assume>0&&ce.addDiagnostic(d.diagnostic.declarationerr(),P.offset,P.length),D.assume="static"===o?f.STATIC:f.GLOBAL);else if("TK_WORD"===O.type||"TK_RESERVED"===O.type){if(0===e){N=!1,"global"!==o&&ce.addDiagnostic(d.diagnostic.declarationerr(),P.offset,P.length);break}if(2===e&&"static"!==o){ce.addDiagnostic(d.diagnostic.propdeclaraerr(),P.offset,P.length),N=!1;break}if("([".includes(r.charAt(z))||ce.get_token(z,!0).content.match(/^(\{|=>)$/))O.topofline=2;else{let t;if(N=!1,t=X("global"===o?"":o),"global"===o)t.map((e=>{D.global[e.name.toLowerCase()]=e}));else if(2===e)for(const e of t)e.kind===s.SymbolKind.Property&&(e.static=!0);else{let e="static"===o;t.map((t=>{D.local[t.name.toLowerCase()]=t,e&&(t.static=!0)}))}c.push(...t)}}else"TK_EQUALS"===O.type&&(z=P.offset+P.length,P.type="TK_WORD",O=P,P=l,2!==e&&ce.addDiagnostic(d.diagnostic.reservedworderr(O.content),O.offset,O.length));N=!1;break;case"loop":if(2===e){n=ce.get_token(z),N=!1,O.type="TK_WORD",":="!==n.content&&ce.addDiagnostic(d.diagnostic.propdeclaraerr(),O.offset,O.length);break}if(P=O,O=je(),"TK_EQUALS"===O.type)z=P.offset+P.length,P.type="TK_WORD",O=P,P=l,N=!1,2!==e&&ce.addDiagnostic(d.diagnostic.reservedworderr(O.content),O.offset,O.length);else{if(2===e){ce.addDiagnostic(d.diagnostic.propdeclaraerr(),P.offset,P.length);break}(N="TK_WORD"===O.type&&["parse","files","read","reg"].includes(O.content.toLowerCase()))&&(O.type="TK_RESERVED")}if(O.topofline||"TK_START_BLOCK"===O.type||c.push(...G(void 0,"{")),H(void 0,a))return;"TK_RESERVED"===O.type&&"until"===O.content.toLowerCase()&&(N=!0,R=O.offset,c.push(...G(void 0,void 0,"until",1)));break;case"for":for(Me("(")&&(n=je());ge();)switch(O.type){case"TK_COMMA":break;case"TK_RESERVED":if(!("class"===O.content.toLowerCase()&&1&e)){ce.addDiagnostic(d.diagnostic.reservedworderr(O.content),O.offset,O.length);break}O.type="TK_WORD";case"TK_WORD":de(O,0)&&(c[c.length-1].def=!0);break;case"TK_OPERATOR":return"in"===O.content.toLowerCase()?(c.push(...J()),n&&(")"!==O.content?ce.addDiagnostic(d.diagnostic.missing(")"),n.offset,n.length):(N=!0,ge())),void(H(void 0,a)||"TK_RESERVED"!==O.type||"until"!==O.content.toLowerCase()||(N=!0,R=O.offset,c.push(...G(void 0,void 0,"until",1))))):(ce.addDiagnostic(d.diagnostic.unknownoperatoruse(),O.offset,O.length),void(N=!1));default:N=!1;case"TK_END_EXPR":return void ce.addDiagnostic(d.diagnostic.unexpected(O.content),O.offset,O.length);case"TK_EQUALS":return void ce.addDiagnostic(d.diagnostic.reservedworderr(P.content),P.offset,P.length)}break;case"continue":case"break":case"goto":if(2===e){N=!1,O.type="TK_WORD",":="!==ce.get_token(z,!0).content&&ce.addDiagnostic(d.diagnostic.propdeclaraerr(),O.offset,O.length);break}if(P=O,O=je(),N=!1,!O.topofline)if(t.allIdentifierChar.test(O.content))O.ignore=!0,O.type="TK_WORD",m(O);else if(O.type.endsWith("COMMENT"))"goto"===o&&ce.addDiagnostic(d.diagnostic.unexpected(O.content),O.offset,O.length);else if("("!==r.charAt(P.offset+P.length))z=P.offset+P.length,P.type="TK_WORD",O=P,P=l,N=!1,ce.addDiagnostic(d.diagnostic.reservedworderr(O.content),O.offset,O.length);else{let e=[];N=!0,ie("(",")",void 0,{},e),e.map((e=>{e.content.indexOf("\n")<0&&m({content:e.content.slice(1,-1),offset:e.offset+1,length:e.length-2,type:"",topofline:0,next_token_offset:-1})})),ge(),N=!1}break;case"as":case"catch":case"else":case"finally":case"until":ce.addDiagnostic(d.diagnostic.unexpected(O.content),O.offset,O.length);break;case"super":3&e?O.ignore=!0:ce.addDiagnostic(d.diagnostic.reservedworderr(O.content),O.offset,O.length),O.type="TK_WORD",N=!1;break;case"case":L&&O.topofline?(ge(),N=!1,":"===O.content||O.topofline?(N=":"===O.content,ce.addDiagnostic(d.diagnostic.unexpected(O.content),O.offset,O.length)):(L=2,c.push(...G(void 0,":","case",1,20)),L=1,":"!==O.content?(ce.addDiagnostic(d.diagnostic.unexpected(O.content),O.offset,O.length),N=!1):(N=!0,ge(),N=!1,"TK_START_BLOCK"===O.type?O.previous_pair_pos=a:O.topofline||(O.topofline=-1)))):(O.type="TK_WORD",ce.addDiagnostic(d.diagnostic.reservedworderr(O.content),O.offset,O.length));break;case"try":if(ge(),N=!1,H(!0,a),"TK_RESERVED"===O.type&&"else"!==O.content.toLowerCase()){for(;"catch"===O.content.toLowerCase();)N=!0,R=O.offset,W();for(let e of["else","finally"])O.content.toLowerCase()===e&&(N=!0,R=O.offset,ge(),N=!1,H(!0,P.offset))}break;case"isset":"("===r.charAt(O.offset+5)?(O.type="TK_WORD",N=!1):ce.addDiagnostic(d.diagnostic.missing("("),O.offset,5);break;default:if(n=Ie(),"TK_EQUALS"===n.type||n.content.match(/^([<>]=?|~=|&&|\|\||[.&|?:^]|\*\*?|\/\/?|<<|>>|!?==?)$/))O.type="TK_WORD",z=u,ce.addDiagnostic(d.diagnostic.reservedworderr(O.content),O.offset,O.length);else{let t={};if(P=O,O=n,N=!1,"return"===o){if(c.push(...G(t,void 0,o)),1&e){let e=b.positionAt(P.offset+P.length);D.returntypes||(D.returntypes={});for(const n in t)D.returntypes[n]=e}}else"switch"===o?(c.push(...G(void 0,"{",o,0,2)),"{"===O.content?(O.previous_pair_pos=a,N=!0,I.push(z-1),q(++A,1),ge(),N=!1):ce.addDiagnostic(d.diagnostic.unexpected(O.content),O.offset,O.length)):"if"!==o&&"while"!==o||(c.push(...G(void 0,"{",o,1)),H(void 0,a))}}function m(e){if(D.labels){o=e.content.toLowerCase(),D.labels[o]||(D.labels[o]=[]);let t=ke(e.offset,e.length);D.labels[o].push(e.symbol=S=s.DocumentSymbol.create(e.content,void 0,s.SymbolKind.Field,t,t))}}}function W(){let e,n,i=O.offset;if(R=i,P=n=O,e=Ie(),e.topofline||"("!==e.content?(O=e,e=void 0):O=Ie(),O.topofline||"TK_WORD"!==O.type&&!t.allIdentifierChar.test(O.content))e?(z=e.offset-1,ce.addDiagnostic(d.diagnostic.unexpected(O.content),O.offset,O.length)):(N=!1,O.topofline||"{"===O.content?H(null,i):ce.addDiagnostic(d.diagnostic.unexpected(O.content),O.offset,O.length));else{if(N=!0,"as"!==O.content.toLowerCase()){for(;;){if("TK_WORD"!==O.type?ce.addDiagnostic(d.diagnostic.unexpected(O.content),O.offset,O.length):de(O),P=O,O=Ie(),"TK_DOT"===O.type)for(ge();;){if("TK_WORD"===O.type)ue(O),ge();else{if("%"!==O.content)break;ce.addDiagnostic(d.diagnostic.unexpected(O.content),O.offset,O.length),ie("%","%"),ge()}if("TK_DOT"!==O.type)break;ge()}if(","!==O.content)break;if(P=O,O=Ie(),!t.allIdentifierChar.test(O.content))break}if(e){if("{"===O.content)return ce.addDiagnostic(d.diagnostic.missing(")"),e.offset,1),H(null,i);if(")"===O.content)return ge(),N=!1,H(null,i)}else if("{"===O.content||O.topofline)return N=!1,H(null,i)}if("as"===O.content.toLowerCase())if(P=O,O=Ie(),N=!1,"TK_WORD"===O.type||t.allIdentifierChar.test(O.content))if("TK_WORD"!==O.type)ce.addDiagnostic(d.diagnostic.reservedworderr(O.content),O.offset,O.length),O.type="TK_WORD";else{let t=Ie();z=O.offset+O.length,t.topofline||"{"===t.content||e&&")"===t.content?(de(O)&&(N=!0,c[c.length-1].def=!0),e&&(")"===t.content?(z=t.offset+1,N=!0):ce.addDiagnostic(d.diagnostic.missing(")"),e.offset,1)),N&&(ge(),N=!1,H(null,i))):(ce.addDiagnostic(d.diagnostic.unexpected(n.content),n.offset,n.length),N=!1)}else ce.addDiagnostic(d.diagnostic.unexpected(n.content),n.offset,n.length);else e&&(")"===O.content?(P=O,O=Ie()):ce.addDiagnostic(d.diagnostic.missing(")"),e.offset,1)),O.topofline?(N=!1,H(null,i)):ce.addDiagnostic(d.diagnostic.unexpected(O.content),O.offset,O.length)}}function $(e){let t=e.previous_extra_tokens;t&&(t.i=0)}function B(){var e;let t="";if(N=!0,ge(),N=!1,"TK_EQUALS"===O.type||"=?".includes(O.content||" ")||"TK_DOT"!==O.type&&!", \t\r\n".includes(t=r.charAt(P.offset+P.length)))$(O),O=P,P=E,N=!1,z=null!==(e=O.skip_pos)&&void 0!==e?e:O.offset+O.length,c.push(...G());else if("TK_DOT"===O.type)for(N=!0,de(P);ge();){if("TK_WORD"===O.type){if(ue(O),ge(),":="===O.content)re(P);else{if("TK_DOT"===O.type)continue;"%"===O.content&&P.offset+P.length===O.offset&&re(P,null)}N=!1,"TK_EQUALS"!==O.type&&!"=?".includes(O.content||" ")&&", \t\r\n".includes(t=r.charAt(P.offset+P.length))?V(s.SymbolKind.Method,t):c.push(...G())}else N=!1,c.push(...G());break}else de(P),V(s.SymbolKind.Function,t)}function V(e,t){let n,i,o=P;if(","===t){if(e===s.SymbolKind.Function&&l.builtin_ahkv1_commands.includes(o.content.toLowerCase()))return Re(o);ce.addDiagnostic(d.diagnostic.funccallerr(),O.offset,1)}if(i=G(),c.push(...i),o.semantic={type:e===s.SymbolKind.Function?p.function:p.method},D.funccall.push(n=s.DocumentSymbol.create(o.content,void 0,e,ke(o.offset,P.offset+P.length-o.offset),ke(o.offset,o.length))),n.paraminfo=i.paraminfo,n.offset=o.offset,o.callinfo=n,P===o){let e=r.indexOf("\n",o.offset);n.range.end=b.positionAt(e<0?ne:e)}e===s.SymbolKind.Method&&re(o,!0)}function H(e=!1,t){var n;if(pe=!1,"TK_START_BLOCK"===O.type)void 0!==t&&(O.previous_pair_pos=t),N=!0,I.push(z-1),q(++A),ge(),N="TK_RESERVED"===O.type&&"else"===O.content.toLowerCase();else{if("TK_RESERVED"===O.type&&w.includes(O.content.toLowerCase())){let t=O;if("try"!==P.content.toLowerCase()&&(R=O.offset),N=!0,F())return e;t!==O&&(t!==P||N||O.topofline)||c.push(...G())}else"TK_WORD"===O.type?B():"TK_EOF"!==O.type&&(P=E,N=!1,c.push(...G())),void 0!==R&&(ce.linepos[(null!==(n=P.pos)&&void 0!==n?n:P.pos=b.positionAt(P.offset)).line]=R);N="TK_RESERVED"===O.type&&"else"===O.content.toLowerCase()}if("boolean"==typeof e){if(e)N=!1;else if(N)return R=O.offset,ge(),N=!1,H(!0,P.offset),!0}else N=!1;return!1}function G(e,t,n,i=0,o=1){var r;let s,a,c=[],l=0,u=0,f={count:0,comma:[],miss:[],unknown:!1};if(pe=!1,N){let e=ce.get_token(z,!0);s=e.content?e.offset:z+1,"TK_COMMA"===e.type?f.miss.push(f.count++):e.topofline&&!$e(O,e)||(++f.count,a=e)}else s=O.content?O.offset:P.offset+P.length+1,"TK_COMMA"===O.type?f.miss.push(f.count++):O.topofline&&!$e(P,O)||(++f.count,a=O);for(;;){let n={};if(c.push(...J(void 0,n,0,t)),"TK_COMMA"===O.type)N=!0,++l,++f.count,"TK_COMMA"===P.type||"("===P.content?f.miss.push(f.comma.length):"TK_OPERATOR"!==P.type||P.ignore||P.content.match(/(--|\+\+|%)/)||ce.addDiagnostic(d.diagnostic.unexpected(","),O.offset,1),f.comma.push(O.offset);else{if(O.topofline){N=!1,e&&(n=null===(r=Object.keys(n).pop())||void 0===r?void 0:r.toLowerCase())&&(e[n]=!0);break}if(t===O.content)break;u!==z&&(ce.addDiagnostic(d.diagnostic.unexpected(O.content),O.offset,O.length),N=!1)}if(u===z&&(!ee||O.length))break;u=z}return n&&(l>=o||f.count-(O===a?1:0)<i)&&ce.addDiagnostic(d.diagnostic.acceptparams(n,o===i?i:`${i}~${o}`),s,P.offset+P.length-s),"*"===P.content&&(f.unknown=!0),Object.defineProperty(c,"paraminfo",{value:f,configurable:!0}),c}function Y(){var t;let n,i=!1,o=null!==(t=O.data)&&void 0!==t?t:{content:"",offset:O.offset+O.length,length:0};switch(n=O.content.toLowerCase()){case"#dllload":i=!0;case"#include":case"#includeagain":be(o.content.replace(/`;/g,";"),o,e,i);break;case"#dllimport":if(C=o.content.match(/^((\w|[^\x00-\x7f])+)/i)){let e,t=ke(o.offset,C[0].length),n=s.Range.create(0,0,0,0),i={t:"ptr",i:"int",s:"str",a:"astr",w:"wstr",h:"short",c:"char",f:"float",d:"double",I:"int64"},r=C[0],a=[],l="",u=0;if(le=!0,C=o.content.substring(C[0].length).match(/^\s*,[^,]+,([^,]*)/),C)for(let t of C[1].replace(/\s/g,"").replace(/^\w*[=@]?=/,"").toLowerCase().replace(/i6/g,"I"))if("u"===t)l="u";else if(i[t])a.push(e=y.create(`p${++u}_${l+i[t]}`,s.SymbolKind.Variable,n)),l="";else{if(!e||"*"!==t&&"p"!==t)return void ce.addDiagnostic(d.diagnostic.invalidparam(),o.offset,o.length);e.name+="p",e=void 0}c.push(g.create(r,s.SymbolKind.Function,t,t,a))}break;case"#requires":o.content.match(/^AutoHotkey\s+v1/i)&&Re(o,"This script requires AutoHotkey v1, and the lexer stops parsing.");break;default:n.match(/^#(if|hotkey|(noenv|persistent|commentflag|escapechar|menumaskkey|maxmem|maxhotkeysperinterval|keyhistory)\b)/i)&&Re(O)}}function X(n){var i;let o,s,a=[];pe=!1;e:for(;ge();){if(O.topofline&&!$e(P,O,D)){N=!1;break}switch(O.type){case"TK_WORD":if(o=P,ge(),"TK_EQUALS"===O.type){let t,r={},l=O.content;if("TK_DOT"===o.type?ue(P):de(P,e,a)?(t=a[a.length-1],(s=fe[t.selectionRange.start.line])&&(t.detail=_e(s.content))):n&&ce.addDiagnostic(d.diagnostic.conflictserr(n,"built-in variable",P.content),P.offset,P.length),c.push(...J(void 0,r)),t){t.returntypes={[":="===l?(null===(i=Object.keys(r).pop())||void 0===i?void 0:i.toLowerCase())||"#any":".="===l?"#string":"#number"]:!0},t.range={start:t.range.start,end:b.positionAt(P.offset+P.length)},t.def=!0,":="===l&&"object"==typeof r[" #object"]&&(t.property=Object.values(r[" #object"]));let e=t.returntypes;for(const n in e)e[n]=t.range.end}}else{if(2===e&&"."!==r.charAt(P.offset+P.length)){if(ce.addDiagnostic(d.diagnostic.propnotinit(),P.offset,P.length),O.topofline&&t.allIdentifierChar.test(O.content)){P=E,N=!1;break e}O.topofline||"TK_COMMA"===O.type||J(","),N=!1;break}if("TK_COMMA"===O.type||O.topofline&&(!["TK_COMMA","TK_OPERATOR","TK_EQUALS"].includes(O.type)||O.content.match(/^(!|~|not)$/i))){if(de(P,e,a)){let e=a[a.length-1];(s=fe[e.selectionRange.start.line])&&(e.detail=_e(s.content))}else n&&ce.addDiagnostic(d.diagnostic.conflictserr(n,"built-in variable",P.content),P.offset,P.length);if("TK_COMMA"!==O.type)break e}}break;case"TK_COMMA":continue;case"TK_UNKNOWN":ce.addDiagnostic(d.diagnostic.unknowntoken(O.content),O.offset,O.length);break;case"TK_RESERVED":2!==e&&ce.addDiagnostic(d.diagnostic.reservedworderr(O.content),O.offset,O.length),N=!1,O.type="TK_WORD";break;case"TK_END_BLOCK":case"TK_END_EXPR":ce.addDiagnostic(d.diagnostic.unexpected(O.content),O.offset,1);default:break e}}return a}function J(n,i={},o=1,a){var l,u,f;let m,v,_=c.length,T="",R=!1,w=[];for(pe=!1;ge();){if(1===O.topofline&&!n&&!$e(P,O,D)){"TK_WORD"===P.type&&"."===r.charAt(P.offset-1)&&ue(P),N=!1;break}switch(O.type){case"TK_WORD":let C="."===r.charAt(O.offset-1);if("("===r.charAt(z))break;if(ge(),"TK_COMMA"===O.type){if(C)ue(P),T+="."+P.content;else if("%"!==r.charAt(P.offset-1)){if(de(P)&&R){let e=c[c.length-1];e.ref=e.def=!0}T+=" "+P.content}else P.ignore=!0;return i[T]=!0,N=!1,c.splice(_)}if(!("TK_OPERATOR"!==O.type||O.topofline&&O.content.match(/^(!|~|not|\+\+|--)$/i))){"%"!==r.charAt(P.offset-1)&&"%"!==r.charAt(P.offset+P.length)?C?(T+="."+P.content,ue(P)):(de(P)&&(c[c.length-1].returntypes={"#number":!0}),T+=" "+P.content):C?(T+=".#any",re(P,null)):(T+=" #any",P.ignore=!0),N=!1;continue}if(O.topofline&&"TK_EQUALS"!==O.type&&"TK_DOT"!==O.type){if(N=!1,C)"%"!==r.charAt(P.offset-1)?(ue(P),i[T+"."+P.content]=!0):(i["#any"]=!0,P.ignore=!0);else{if("%"!==r.charAt(P.offset-1))if(de(P)&&R){let e=c[c.length-1];e.ref=e.def=!0,T=T.slice(0,-1)+"#varref"}else T+=" "+P.content;else P.ignore=!0;i[T]=!0}return S(),c.splice(_)}if("=>"===O.content){let t={},i=c.length,r=D.funccall.length,l=P,d=e;e=1;let u=ke(l.offset,l.length),f=J(n,t,o||1,null!=a?a:w.length?":":void 0);e=d;let p=g.create("",s.SymbolKind.Function,ke(l.offset,P.offset+P.length),ke(l.offset,0),[y.create(l.content,s.SymbolKind.Variable,u)],c.splice(i).concat(f));p.funccall=D.funccall.splice(r),p.returntypes=t;for(const e in t)t[e]=p.range.end;0!==e&&(p.parent=D),me(p),c.push(p),T+=" $"+(ce.anonymous.push(p)-1);break}if(C)"TK_EQUALS"===O.type?(T=T.replace(/\s*\S+$/,""),N=!0,":="===O.content&&re(P)):(T+="."+P.content,N=!1),ue(P);else if("%"!==r.charAt(P.offset-1)&&de(P)){let e=c[c.length-1];if(R&&(e.ref=e.def=!0,R=!1),"TK_EQUALS"===O.type){(k=fe[e.selectionRange.start.line])&&(e.detail=_e(k.content));let t={},i=O.content;N=!0,c.push(...J(n,t,o||1,null!=a?a:w.length?":":void 0)),e.range={start:e.range.start,end:b.positionAt(P.offset+P.length)};let r=":="===i?(null===(l=Object.keys(t).pop())||void 0===l?void 0:l.toLowerCase())||"#any":".="===i?"#string":"#number";e.returntypes={[r]:e.range.end},e.ref?T=T.slice(0,-1)+"#varref":(T+=r,e.def=!0),":="===i&&"object"==typeof t[" #object"]&&(e.property=Object.values(t[" #object"]))}else N=!1,e.ref?T=T.slice(0,-1)+"#varref":T+=" "+P.content}else T+=" "+P.content,N=!1,P.ignore=!0;break;case"TK_START_EXPR":if("["===O.content){let e=!!r.charAt(O.offset-1).match(/^(\w|\)|%|[^\x00-\x7f])$/);ie("[","]"),e?T=T.replace(/\S+$/,"")+"#any":T+=" #array"}else{let t,l,m={},y=O.offset,v="("===r.charAt(P.offset+P.length);if("TK_WORD"===P.type&&v){if("."===r.charAt(P.offset-1)){let e,t=P,n={};ie("(",")",void 0,n),t.semantic={type:p.method},D.funccall.push(e=s.DocumentSymbol.create(t.content,void 0,s.SymbolKind.Method,ke(t.offset,z-t.offset),ke(t.offset,t.length))),e.paraminfo=n.paraminfo,e.offset=t.offset,t.callinfo=e,T+="."+t.content+"()",re(t,!0);continue}t=P}let b=c.length,_=O;if(ie("(",")",O.offset,m),l=z,"=>"===ce.get_token(z).content){c.splice(b),P=null!==(u=(O=_).previous_token)&&void 0!==u?u:E,z=O.offset+1;let r=Q(),m=c.splice(b),v=D.funccall.length,k=t?t.offset:y;l=z,ge();let R=J(n,x={},(null==t?void 0:t.topofline)?2:o||1,null!=a?a:w.length?":":void 0);t?(t.content.match(/^\d/)&&ce.addDiagnostic(d.diagnostic.invalidsymbolname(t.content),t.offset,t.length),t.semantic={type:p.function,modifier:1<<h.definition|1<<h.readonly}):t=Object.assign({},E,{offset:_.offset}),r||(r=[],ce.addDiagnostic(d.diagnostic.invalidparam(),k,l-k));let S=g.create(t.content,s.SymbolKind.Function,ke(t.offset,z-t.offset),ke(t.offset,t.length),r,m.concat(R));c.push(t.symbol=S),S.returntypes=x,ce.addFoldingRangePos(S.range.start,S.range.end,"line"),S.closure=!!(1&e),me(S),null===(f=S.funccall)||void 0===f||f.push(...D.funccall.splice(v));for(const e in x)x[e]=S.range.end;0!==e&&(S.parent=D),t.content?T+=" "+t.content.toLowerCase():T+=" $"+(ce.anonymous.push(S)-1),i[T]=!0}else if(t)if("%"!==r.charAt(t.offset-1)){let e;T+=" "+t.content+"()",de(t),t.semantic={type:p.function},D.funccall.push(e=s.DocumentSymbol.create(t.content,void 0,s.SymbolKind.Function,ke(t.offset,l-t.offset),ke(t.offset,t.length))),e.paraminfo=m.paraminfo,e.offset=t.offset,t.callinfo=e}else t.semantic={type:p.variable},t.ignore=!0;else{let e=Object.keys(m).pop()||"";if("("===r.charAt(l)){let t=e.trim().match(/^\(\s*(([\w.]|[^\x00-\x7f])+)\s*\)$/);t&&(e=t[1])}T+=v?""===T||T.slice(-1).match(/\s/)?e:"()":" "+e}}break;case"TK_START_BLOCK":if(T&&("TK_OPERATOR"!==P.type||P.content.match(/^(\+\+|--)$/))&&"TK_EQUALS"!==P.type)return i[T]=" #object"!==T||!v||v,N=!1,S(),c.splice(_);{let e=ce.diagnostics.length,t=!1;if("TK_RESERVED"===P.type&&"switch"===P.content.toLowerCase()){let e;if(N=!1,O.topofline||(e=ce.get_token(z)).topofline||e.type.endsWith("COMMENT"))return S(),c.splice(_);N=t=!0}else"TK_EQUALS"===P.type?":="!==P.content&&ce.addDiagnostic(d.diagnostic.unknownoperatoruse(P.content),P.offset,P.length):1===o&&("TK_WORD"===P.type||"TK_OPERATOR"===P.type||P.type.startsWith("TK_END"))&&(o=0);if(te(o>0||t,m={},v={})){T+=" "+(Object.keys(m).pop()||"#object");break}return i[T]=!0,ce.diagnostics.splice(e)," #object"===T&&v&&(i[T]=v),S(),N=!1,c.splice(_)}case"TK_NUMBER":T+=" #number";break;case"TK_STRING":T+=" #string";break;case"TK_END_BLOCK":case"TK_END_EXPR":case"TK_COMMA":return N=!1,i[T]=!0," #object"===T&&v&&(i[T]=v),S(),c.splice(_);case"TK_LABEL":ce.addDiagnostic(d.diagnostic.unexpected(O.content),O.offset,O.length);break;case"TK_UNKNOWN":ce.addDiagnostic(d.diagnostic.unknowntoken(O.content),O.offset,O.length);break;case"TK_RESERVED":{let e=r.charAt(O.offset+O.length);if("%"===e||"%"===r.charAt(O.offset-1)){N=!1,O.type="TK_WORD",O.semantic={type:p.variable};break}if(O.content.match(/^(class|super|isset)$/i)){"isset"===O.content.toLowerCase()&&(O.ignore=!0,"("!==e&&ce.addDiagnostic(d.diagnostic.missing("("),O.offset,O.length)),N=!1,O.type="TK_WORD";break}ce.addDiagnostic(d.diagnostic.reservedworderr(O.content),O.offset,O.length);break}case"TK_OPERATOR":if("%"===O.content){if(r.charAt(O.offset-1).match(/\w|[^\x00-\x7f]/)?T=T.replace(/\S+$/,"#any"):"TK_DOT"===P.type?(T+=".#any",re(O,null)):T+=" #any","%"===n)return N=!1,i[T]=!0," #object"===T&&v&&(i[T]=v),S(),c.splice(_);ie("%","%")}else if("=>"===O.content&&"TK_WORD"===P.type){c.length&&c[c.length-1].name===P.content&&c.pop();let t=g.create("",s.SymbolKind.Function,ke(P.offset,P.length),ke(P.offset,0),[y.create(P.content,s.SymbolKind.Variable,ke(P.offset,P.length))]),i=D.funccall.length,o={};t.children=J(n,o,1,null!=a?a:w.length?":":void 0),t.range.end=b.positionAt(P.offset+P.length),t.funccall=D.funccall.splice(i),t.returntypes=o;for(const e in o)o[e]=t.range.end;0!==e&&(t.parent=D),c.push(t),me(t),T=T.replace(/\S+$/,"$"+(ce.anonymous.push(t)-1))}else{if(T+=" "+O.content,t.allIdentifierChar.test(O.content)&&("%"===r[O.offset-1]||"%"===r[O.offset+O.length])){N=!1,O.type="TK_WORD",O.semantic={type:p.variable},T=T.slice(0,-1-O.length);break}if("TK_OPERATOR"!==P.type||P.content.match(/^([:?%]|\+\+|--|=>)$/)||O.content.match(/[+\-%!~]|^not$/i)||ce.addDiagnostic(d.diagnostic.unknownoperatoruse(),O.offset,O.length),"&"===O.content&&("=>"===P.content||["TK_EQUALS","TK_COMMA","TK_START_EXPR"].includes(P.type))){R=!0;break}if("?"===O.content)O.ignore?T=T.slice(0,-2):w.push(O.offset);else if(":"===O.content&&void 0===w.pop()){if(":"===a||2===L)return N=!1,T=T.slice(0,-2),i[T]=!0," #object"===T&&v&&(i[T]=v),c.splice(_);ce.addDiagnostic(d.diagnostic.unexpected(":"),O.offset,1)}}break;case"TK_EQUALS":T+=" :="}R=!1}return i[T]=!0," #object"===T&&v&&(i[T]=v),S(),c.splice(_);function S(){let e;for(;void 0!==(e=w.pop());)ce.addDiagnostic(d.diagnostic.missing(":"),e,1)}}function Q(e={},t=")"){var n;let i,o=!0,r=z-1,a=[],l=[",",")"===t?"(":"["],u=!1,f="",p={count:0,comma:[],miss:[],unknown:!1},h=z,m=O,g=!1;for(pe=!1;ge();){if(O.content===t){if("TK_COMMA"===P.type)return e["#void"]=!0,O.previous_pair_pos=r,p.miss.push(p.count++),Object.defineProperty(e,"paraminfo",{value:p,configurable:!0}),void c.push(...a);break}if("TK_WORD"!==O.type){if(l.includes(P.content)){if("*"===O.content){let e=O;if(ge(),O.content===t){a.push(y.create("*",s.SymbolKind.Null,i=ke(0,0)));break}ce.addDiagnostic(d.diagnostic.unexpected("*"),e.offset,1)}else if("&"===O.content){let e=O;if(O=Ie(),"TK_WORD"===O.type){u=!0,N=!1;continue}ce.addDiagnostic(d.diagnostic.unexpected("&"),e.offset,1)}o=!1;break}o=!1;break}if(ae(O.content.toLowerCase())){o=!1;break}if(p.count++,!l.includes(P.content)){o=!1,p.count--;break}if(ge(),","!==O.content&&O.content!==t){if(":="===O.content){let e,r=O;P.content.match(/^\d/)&&ce.addDiagnostic(d.diagnostic.invalidsymbolname(P.content),P.offset,P.length);let l=y.create(P.content,s.SymbolKind.Variable,i=ke(P.offset,P.length));(k=fe[l.selectionRange.start.line])&&(l.detail=_e(k.content)),l.def=!0,l.defaultVal=null,a.push(l),c.push(...J(",",e={},2)),N=!0,h=z,m=O;let v=Object.keys(e).pop();if(v)if(v=v.trim().toLowerCase(),"#string"===v)l.defaultVal=_[r.next_token_offset].content;else if("true"===v||"false"===v)l.defaultVal=v;else if(v.match(/^([-+]\s)?#number$/))if("#"===v.charAt(0))l.defaultVal=_[r.next_token_offset].content;else{let e=_[r.next_token_offset];l.defaultVal=e.content+_[e.next_token_offset].content}else"unset"!==v&&(l.range_offset=[r.offset,O.offset],g=!0);if(u?(u=!1,l.ref=!0,f="#varref",l.returntypes={"#varref":!0}):(f=null!==(n=Object.keys(e).pop())&&void 0!==n?n:"#void",l.returntypes=e),"TK_COMMA"===O.type){p.comma.push(O.offset);continue}o=O.content===t;break}if("TK_OPERATOR"===O.type){if("*"===O.content){let e=P;if(ge(),O.content===t){S=y.create(e.content,s.SymbolKind.Variable,i=ke(e.offset,e.length)),a.push(S),S.arr=!0,p.unknown=!0,h=z,m=O;break}o=!1,p.count--;break}if("?"===O.content&&O.ignore){let e=P;if(S=y.create(P.content,s.SymbolKind.Variable,i=ke(P.offset,P.length)),S.def=!0,S.defaultVal=null,a.push(S),u?(u=!1,S.ref=!0,f="#varref"):f=P.content,ge(),"TK_COMMA"===O.type){e.content.match(/^\d/)&&ce.addDiagnostic(d.diagnostic.invalidsymbolname(e.content),e.offset,e.length),p.comma.push(O.offset),h=z,m=O;continue}(o=O.content===t)||(a.pop(),p.count--);break}o=!1,p.count--;break}o=!1,p.count--;break}{P.content.match(/^\d/)&&ce.addDiagnostic(d.diagnostic.invalidsymbolname(P.content),P.offset,P.length);let e=y.create(P.content,s.SymbolKind.Variable,i=ke(P.offset,P.length));if((k=fe[e.selectionRange.start.line])&&(e.detail=_e(null==k?void 0:k.content)),u?(u=!1,e.ref=e.def=!0,f="#varref"):f=e.name,a.push(e),h=z,m=O,","!==O.content)break;p.comma.push(O.offset)}}return o?(")"===t&&(e[f.toLowerCase()]=!0,Object.defineProperty(e,"paraminfo",{value:p,configurable:!0})),g&&Object.defineProperty(a,"format",{value:ye.bind(void 0,ce.tokens),configurable:!0}),O.previous_pair_pos=r,ce.addFoldingRange(r,z,"block"),a):(c.push(...a),z=h,O=m,Object.defineProperty(e,"paraminfo",{value:p,configurable:!0}),void ie(")"===t?"(":"[",t,r,e))}function te(e=!1,n={},i={}){var o;let s,a=P,l=O,u=c.length,f=!0,h={};for(pe=!1,N=!0,O.data=i;m()&&!g(););if(!f){let t=O;return P=a,O=l,c.splice(u),z=null!==(o=O.skip_pos)&&void 0!==o?o:O.offset+O.length,e?(function(){let e=0;for(N||"TK_START_BLOCK"!==O.type||(N=!0);ge();)switch(O.type){case"TK_START_BLOCK":e++;break;case"TK_END_BLOCK":if(--e<0)return}}(),O.previous_pair_pos=l.offset,ce.addDiagnostic(d.diagnostic.objectliteralerr(),t.offset,z-t.offset),!0):N=!1}return":"!==P.content&&"TK_LABEL"!==P.type||ce.addDiagnostic(d.diagnostic.unexpected(O.content),O.offset,O.length),"TK_END_BLOCK"===O.type?(ce.addFoldingRange(O.previous_pair_pos=l.offset,O.offset),l.next_pair_pos=O.offset):ce.addDiagnostic(d.diagnostic.missing("}"),l.offset,1),!0;function m(){for(;ge();)switch(s=void 0,O.type){case"TK_RESERVED":case"TK_WORD":if("%"===r.charAt(z))break;return ge(),":"===O.content?(P.semantic={type:p.property},s=P,i[P.content.toLowerCase()]=P.content,!0):f=!1;case"TK_STRING":return ge(),":"===O.content?(ce.addDiagnostic(d.diagnostic.invalidpropname(),P.offset,P.length),!0):f=!1;case"TK_OPERATOR":if("%"===O.content){if(ie("%","%"),v(r.charCodeAt(z)))break;if(ge(),":"===O.content)return!0}else if(t.allIdentifierChar.test(O.content)&&(ge(),":"===O.content))return P.semantic={type:p.property},P.type="TK_WORD",s=P,i[P.content.toLowerCase()]=P.content,!0;return f=!1;case"TK_LABEL":if(O.content.match(/^(\w|[^\x00-\x7f])+:$/)){let e;return he(e=O.content.replace(":","")),i[e.toLowerCase()]=e,!0}return f=!1;case"TK_END_BLOCK":if("TK_START_BLOCK"===P.type||"TK_COMMA"===P.type)return!1;case"TK_NUMBER":if(t.allIdentifierChar.test(O.content)&&(ge(),":"===O.content))return P.type="TK_WORD",s=P,i[P.content.toLowerCase()]=P.content,P.semantic={type:p.property},!0;case"TK_START_EXPR":return f=!1;case"TK_COMMA":if("TK_COMMA"===P.type||"TK_START_BLOCK"===P.type)return!0;default:return f=!1}return!1}function g(){let e=J(",",h={});if(c.push(...e),s)if("base"===s.content.toLowerCase()){let e=Object.keys(h).pop();e&&e.match(/\.prototype$/i)&&(n[e.slice(0,-10).trim().toLowerCase().replace(/([^.]+)$/,"@$1")]=!0)}else ue(s);return"TK_COMMA"===O.type?!(N=!0):"TK_END_BLOCK"===O.type?N=!0:"TK_EOF"===O.type||!(f=!1)}}function ie(n,i,o,a={},l){var u;let f=0,m=c.length,v=z,T=P,R=[null!=o?o:O.offset],w=0,S="",C=!1,E=[],K={count:0,comma:[],miss:[],unknown:!1};for(pe=!1,a.paraminfo&&(K=a.paraminfo,delete a.paraminfo);ge();){if("%"===n&&O.topofline&&(!["TK_COMMA","TK_OPERATOR","TK_EQUALS"].includes(O.type)||O.content.match(/^(!|~|not)$/i))){ce.addDiagnostic(d.diagnostic.missing("%"),R[0],1),N=!1,S="#any";break}if("("!==n&&"("===O.content)m=c.length,v=z,w=1,T=P,ie("(",")");else if(O.content===i){if(_[O.previous_pair_pos=R.pop()].next_pair_pos=O.offset,"%"!==i&&ce.addFoldingRange(O.previous_pair_pos,O.offset+1,"block"),--f<0)break;")"===i&&(S+=")",w++)}else if(O.content===n){if("("===n){if(")"===r.charAt(O.offset-1)){ie("(",")",O.offset,x={}),S+="()";continue}m=c.length,v=z,w=0,S+="("}f++,R.push(z-1),T=P}else if("=>"===O.content){let t,n,o=c.splice(m),a=O,l=-1;if(")"===P.content){if(1!==w){ce.addDiagnostic(d.diagnostic.unknownoperatoruse(),O.offset,2),N=!0;continue}P=T,z=v-1,O=je(),l=O.offset,t=Q(),t||(t=[],ce.addDiagnostic(d.diagnostic.invalidparam(),l,O.offset-l+1)),n=Ie()}else{if("TK_WORD"!==P.type||"."===r.charAt(P.offset-1)){ce.addDiagnostic(d.diagnostic.unknownoperatoruse(),O.offset,2),N=!0;continue}{let e;n=O,l=P.offset,t=[y.create(P.content,s.SymbolKind.Variable,e=ke(P.offset,P.length))]}}if("=>"!==n.content){O=a,z=a.offset+a.length,N=!0,S="",c.push(...o),ce.addDiagnostic(d.diagnostic.unknownoperatoruse(),O.offset,2);continue}o=c.splice(m);let u=D.funccall.length,f=J(i,void 0,1,E.length?":":void 0),p=g.create("",s.SymbolKind.Function,ke(l,P.offset+P.length-l),ke(l,0),t,o.concat(f));c.push(p),me(p),p.funccall=D.funccall.splice(u);for(const e in x)x[e]=p.range.end;0!==e&&(p.parent=D),S=S.replace(/\([^()]*\)$/,"")+" $"+(ce.anonymous.push(p)-1)}else if("TK_WORD"===O.type)if("."!==r.charAt(O.offset-1))if("("!==r.charAt(z))if("%"===n||"%"!==r.charAt(O.offset-1)&&"%"!==r.charAt(O.offset+O.length))if(de(O)){let e=c[c.length-1];if(ge(),N=!1,C&&(e.ref=e.def=!0,C=!1),"TK_EQUALS"===O.type){(k=fe[e.selectionRange.start.line])&&(e.detail=_e(k.content));let t={},n=O.content;N=!0,c.push(...J(i,t,2,E.length?":":void 0)),e.range={start:e.range.start,end:b.positionAt(P.offset+P.length)};let o=":="===n?(null===(u=Object.keys(t).pop())||void 0===u?void 0:u.toLowerCase())||"#any":".="===n?"#string":"#number";e.returntypes={[o]:e.range.end},e.ref?S=S.slice(0,-1)+"#varref":(S+=o,e.def=!0),":="===n&&"object"==typeof t[" #object"]&&(e.property=Object.values(t[" #object"]))}else e.ref?S=S.slice(0,-1)+"#varref":S+=" "+P.content}else S+=" "+O.content;else O.ignore=!0;else{P=O,O=je(),P.semantic={type:p.function};let t=P,n=c.length,o={},a=Q(o),l=z;if(ge(),"=>"===O.content){let o={},r=D;a||ce.addDiagnostic(d.diagnostic.invalidparam(),t.offset,O.offset-t.offset+1);let l=g.create(t.content,s.SymbolKind.Function,ke(t.offset,z-t.offset),ke(t.offset,t.length),a||[]);t.content.match(/^\d/)&&ce.addDiagnostic(d.diagnostic.invalidsymbolname(t.content),t.offset,t.length),t.symbol=D=l,l.children=c.splice(n).concat(J(i,o,2,E.length?":":void 0)),t.semantic.modifier=1<<h.definition|1<<h.readonly,D=r,l.range.end=b.positionAt(P.offset+P.length),l.closure=!!(1&e),l.returntypes=o,me(l);for(const e in o)o[e]=l.range.end;0!==e&&(l.parent=D),c.push(l),ce.addFoldingRangePos(l.range.start,l.range.end,"line"),t.content?S+=" "+t.content.toLowerCase():S+=" $"+(ce.anonymous.push(l)-1)}else{if("%"!==r.charAt(t.offset-1)){let e;de(t),D.funccall.push(e=s.DocumentSymbol.create(t.content,void 0,s.SymbolKind.Function,ke(t.offset,l-t.offset),ke(t.offset,t.length))),e.paraminfo=o.paraminfo,e.offset=t.offset,t.callinfo=e,S+=" "+t.content+"()",t.semantic={type:p.function}}else t.semantic={type:p.variable},t.ignore=!0;if(N=!1,a)for(const e of a)ae(e.name.toLowerCase())||(c.push(e),(e.ref||e.returntypes)&&(e.def=!0))}}else if("("===r.charAt(z)){let e,t=O,n={};O=je(),t.semantic={type:p.method},ie("(",")",void 0,n),S+="."+t.content+"()",t.semantic={type:p.method},D.funccall.push(e=s.DocumentSymbol.create(t.content,void 0,s.SymbolKind.Method,ke(t.offset,z-t.offset),ke(t.offset,t.length))),e.paraminfo=n.paraminfo,e.offset=t.offset,t.callinfo=e,re(t,!0)}else ue(O),ge(),N=!1,":="===O.content&&re(P);else if("TK_START_BLOCK"===O.type){let e={};["TK_WORD","TK_STRING","TK_NUMBER"].includes(P.type)&&ce.addDiagnostic(d.diagnostic.unexpected("{"),O.offset,O.length),te(!0,e),S+=" "+(Object.keys(e).pop()||"#object")}else if("TK_STRING"===O.type)S+=" #string",null==l||l.push(O),"["===n&&Me("]")&&!O.content.match(/\n|`n/)&&he(O.content.substring(1,O.content.length-1));else if("["===O.content){let e=!!r.charAt(O.offset-1).match(/^(\w|\)|%|[^\x00-\x7f])$/);ie("[","]"),e?S=S.replace(/\S+$/,"")+"#any":S+=" #array"}else if("%"===O.content)r.charAt(O.offset-1).match(/\w|[^\x00-\x7f]/)?S=S.replace(/\S+$/,"#any"):S+=" #any",ie("%","%");else{if(O.content.match(/^[)}]$/))return L(),N=!1,a[S.indexOf("#any")<0?"("+S+")":"#any"]=!0,void A();if("TK_RESERVED"===O.type){let e=r.charAt(O.offset+O.length);if("%"!==n&&("%"===e||"%"===r.charAt(O.offset-1))){N=!1,O.type="TK_WORD",O.semantic={type:p.variable};continue}if(O.content.match(/^(class|super|isset)$/i)){"isset"===O.content.toLowerCase()&&(O.ignore=!0,"("!==e&&ce.addDiagnostic(d.diagnostic.missing("("),O.offset,O.length)),N=!1,O.type="TK_WORD";continue}ce.addDiagnostic(d.diagnostic.reservedworderr(O.content),O.offset,O.length)}else if("TK_END_BLOCK"===O.type||"TK_END_EXPR"===O.type)ce.addDiagnostic(d.diagnostic.unexpected(O.content),O.offset,1);else if("TK_COMMA"===O.type)if("("!==n)S+=" ,";else if(0===f)S="",++K.count,"TK_COMMA"===P.type||"("===P.content?K.miss.push(K.comma.length):"TK_OPERATOR"!==P.type||P.ignore||P.content.match(/(--|\+\+|%)/)||ce.addDiagnostic(d.diagnostic.unexpected(","),O.offset,1),K.comma.push(O.offset);else{let e=S.lastIndexOf("(");S=e<0?"":S.substring(0,e+1)}else if("TK_NUMBER"===O.type)S+=" #number";else if("TK_OPERATOR"===O.type){if(S+=" "+O.content,"&"===O.content){C=!0;continue}"?"===O.content?O.ignore?S=S.slice(0,-2):E.push(O.offset):":"===O.content&&void 0===E.pop()?ce.addDiagnostic(d.diagnostic.unexpected(":"),O.offset,1):"%"===n||!t.allIdentifierChar.test(O.content)||"%"!==r[O.offset-1]&&"%"!==r[O.offset+O.length]||(N=!1,O.type="TK_WORD",O.semantic={type:p.variable},S=S.slice(0,-1-O.length))}}C=!1}if(a[n+S+i]=!0,"TK_EOF"===O.type&&f>-1)L();else if("("===n){","===P.content?K.miss.push(K.count++):"("!==P.content&&(K.count++,"*"===P.content&&(K.unknown=!0)),Object.defineProperty(a,"paraminfo",{value:K,configurable:!0});let e=_[O.previous_pair_pos];e.next_pair_pos=O.offset,void 0===e.ignore&&(e.data=K)}function A(){let e;for(;void 0!==(e=E.pop());)ce.addDiagnostic(d.diagnostic.missing(":"),e,1)}function L(){let e;for(;void 0!==(e=R.pop());)ce.addDiagnostic(d.diagnostic.missing(i),e,1)}A()}function re(e,t=!1){var n,o;if(""===i)return;let a,c=null===(n=e.previous_token)||void 0===n?void 0:n.previous_token;if(!c||"."===r.charAt(c.offset-1))return;if(M=c.content.toLowerCase(),"this"!==M&&"super"!==M)return;let l=D,d=!1;if(t){let t=e.callinfo.paraminfo;if("defineprop"===e.content.toLowerCase()&&t.count>1&&0!==t.miss[0]&&(u(),l&&l.kind===s.SymbolKind.Class)){let n=t.comma[0],i=_[e.next_token_offset];if("("===r.charAt(e.offset+e.length)&&(i=_[i.next_token_offset]),"TK_STRING"===i.type&&i.next_token_offset===n){let e=_[_[n].next_token_offset],t=i.content.slice(1,-1),r=y.create(t,s.SymbolKind.Property,a=ke(i.offset+1,t.length));return l.cache.push(r),r.static=d,"TK_START_BLOCK"===e.type&&(null===(o=e.data)||void 0===o?void 0:o.call)&&(r.kind=s.SymbolKind.Method),r}l.checkmember=!1}}else if(u(),l&&l.kind===s.SymbolKind.Class){if(null===t)return void(l.checkmember=!1);let n=y.create(e.content,s.SymbolKind.Property,a=ke(e.offset,e.length));return n.static=d,l.cache.push(n),n.def=!1,n}return;function u(){if(l.kind===s.SymbolKind.Method||l.kind===s.SymbolKind.Function)for(;l&&l.kind!==s.SymbolKind.Class;)l.kind===s.SymbolKind.Method&&l.static&&(d=!0),l=l.parent}}function ae(e,t=0){return 2!==t&&!!(l.builtin_variable.includes(e)||le&&l.builtin_variable_h.includes(e))}function de(e,t=0,n){let o=e.content.toLowerCase();if(e.ignore||ae(o,t))return e.semantic&&delete e.semantic,e.ignore=!0,!1;let r=ke(e.offset,e.length),a=y.create(e.content,s.SymbolKind.Variable,r);return 2===t?(a.kind=s.SymbolKind.Property,ue(e),i&&(a.full=`(${i.slice(0,-1)}) ${a.name}`)):o.match(/^\d/)&&ce.addDiagnostic(d.diagnostic.invalidsymbolname(e.content),e.offset,e.length),n?n.push(a):c.push(a),!0}function ue(e){let t,n=e.content.toLowerCase();e.semantic={type:p.property},ce.object.property[n]||(ce.object.property[n]=y.create(e.content,s.SymbolKind.Property,t=ke(e.offset,e.length)))}function he(e){ce.texts[e.toLowerCase()]=e}function me(e){var t,n,i,o,r,a,c,l;let u=e.declaration,p=ce.diagnostics,h=!1,m={},g={};if(u)if(e.kind===s.SymbolKind.Class){let o=e.staticdeclaration;null===(t=e.children)||void 0===t||t.map((t=>{if([s.SymbolKind.Property,s.SymbolKind.Method,s.SymbolKind.Class].includes(t.kind)){if(u=t.static||t.kind===s.SymbolKind.Class?o:e.declaration,!u)return;u[M=t.name.toLowerCase()]?(t.kind!==s.SymbolKind.Property||t.def)&&p.push({message:U(u[M],t),range:t.selectionRange,severity:s.DiagnosticSeverity.Error}):(t.kind!==s.SymbolKind.Variable||t.def)&&(u[M]=t)}})),null===(n=e.cache)||void 0===n||n.map((t=>{var n;u=t.static?o:e.declaration,u[M=t.name.toLowerCase()]||(u[M]=t,null===(n=e.children)||void 0===n||n.push(t))})),null===(i=e.cache)||void 0===i||i.splice(0)}else{if(e.assume===f.GLOBAL){null===(o=e.children)||void 0===o||o.map((e=>{if(e.kind===s.SymbolKind.Function){if(!(M=e.name.toLowerCase()))return;u[M]?p.push({message:U(u[M],e),range:e.selectionRange,severity:s.DiagnosticSeverity.Error}):u[M]=e,g[M]=e}})),null===(r=e.params)||void 0===r||r.map((t=>{var n;null===(n=e.children)||void 0===n||n.unshift(t),t.def=!0,t.kind=s.SymbolKind.TypeParameter,u[M=t.name.toLowerCase()]&&u[M].kind===s.SymbolKind.Function?p.push({message:U(t,u[M]),range:t.selectionRange,severity:s.DiagnosticSeverity.Error}):u[M]=t,void 0!==t.defaultVal||t.arr?h=!0:h&&p.push({message:d.diagnostic.defaultvalmissing(t.name),range:t.selectionRange,severity:s.DiagnosticSeverity.Error}),m[M]?p.push({message:d.diagnostic.conflictserr("parameter","parameter",t.name),range:t.selectionRange,severity:s.DiagnosticSeverity.Error}):m[M]=t}));for(const t in e.local)u[t]?m[t]&&p.push({message:d.diagnostic.conflictserr("local","parameter",m[t].name),range:e.local[t].selectionRange,severity:s.DiagnosticSeverity.Error}):u[t]=e.local[t];for(const t in e.global)m[t]?p.push({message:d.diagnostic.conflictserr("global","parameter",m[t].name),range:e.local[t].selectionRange,severity:s.DiagnosticSeverity.Error}):(u[t]?(ce.declaration[t]=u[t],delete u[t]):ce.declaration[t]=e.global[t],ce.declaration[t].infunc=!0);let t=ce.declaration;null===(a=e.children)||void 0===a||a.map((e=>{e.kind===s.SymbolKind.Variable&&(u[M=e.name.toLowerCase()]||(t[M]?t[M].kind!==s.SymbolKind.Variable&&p.push({message:U(t[M],e),range:e.selectionRange,severity:s.DiagnosticSeverity.Error}):(t[M]=e,e.infunc=!0)))}))}else{null===(c=e.children)||void 0===c||c.map((e=>{if(e.kind===s.SymbolKind.Function||e.def){if(!(M=e.name.toLowerCase()))return;u[M]?e.kind===s.SymbolKind.Variable&&u[M].kind===s.SymbolKind.Variable||(u[M].kind===s.SymbolKind.Variable?(p.push({message:U(e,u[M]),range:u[M].selectionRange,severity:s.DiagnosticSeverity.Error}),u[M]=e):p.push({message:U(u[M],e),range:e.selectionRange,severity:s.DiagnosticSeverity.Error})):u[M]=e,e.kind===s.SymbolKind.Function&&(g[M]=e)}})),null===(l=e.params)||void 0===l||l.map((t=>{var n;null===(n=e.children)||void 0===n||n.unshift(t),t.def=!0,t.kind=s.SymbolKind.TypeParameter,u[M=t.name.toLowerCase()]&&u[M].kind===s.SymbolKind.Function?p.push({message:U(t,u[M]),range:t.selectionRange,severity:s.DiagnosticSeverity.Error}):u[M]=t,void 0!==t.defaultVal||t.arr?h=!0:h&&p.push({message:d.diagnostic.defaultvalmissing(t.name),range:t.selectionRange,severity:s.DiagnosticSeverity.Error}),m[M]?p.push({message:d.diagnostic.conflictserr("parameter","parameter",t.name),range:t.selectionRange,severity:s.DiagnosticSeverity.Error}):m[M]=t}));for(const t in e.local)u[t]?m[t]&&p.push({message:d.diagnostic.conflictserr("local","parameter",m[t].name),range:e.local[t].selectionRange,severity:s.DiagnosticSeverity.Error}):u[t]=e.local[t];for(const t in e.global)m[t]?p.push({message:d.diagnostic.conflictserr("global","parameter",m[t].name),range:e.local[t].selectionRange,severity:s.DiagnosticSeverity.Error}):(u[t]?(ce.declaration[t]=u[t],u[t].kind!==s.SymbolKind.Variable&&(e.global[t]=u[t]),delete u[t]):ce.declaration[t]=e.global[t],ce.declaration[t].infunc=!0)}for(const t in m)e.local[t]=m[t];for(const t in g)e.local[t]=g[t];e.kind===s.SymbolKind.Method&&m.this&&p.push({message:d.diagnostic.conflictserr("parameter","parameter","this"),range:m.this.selectionRange,severity:s.DiagnosticSeverity.Error});for(const t of["this","super"])if(e.declaration[t]){let n=e;for(;n&&(n.kind===s.SymbolKind.Method||n.kind===s.SymbolKind.Function);)n=n.local[t]||n.global[t]?void 0:n.parent;n&&n.kind===s.SymbolKind.Class&&delete e.declaration[t]}if(e.assume===f.STATIC){let t,n=e.local;for(const e in u)!n[e]&&(t=u[e]).def&&t.kind===s.SymbolKind.Variable&&(t.static=null)}}}function ge(){return N?(P=O,N="TK_EOF"!==(O=Ie()).type):N="TK_EOF"!==O.type}function Re(e,t="This might be a v1 script, and the lexer stops parsing."){if(u.extsettings.DisableV1Script)throw ce.clear(),z=ne,new K(t,e);if("TK_WORD"===e.type){for(ge();" \t".includes(r.charAt(z)||"\0");)z++;let t=r.indexOf("\n",z);t<0&&(t=ne),P=e,e=Te(r.substring(z,t),"TK_STRING",z,t-z,0),z=t}}}function be(e,t,n=0,o=!1){let r,a,c=!1,l=e[0];if("'\"".includes(l)&&e.endsWith(l)&&(e=e.slice(1,-1)),r=e.match(/^(\*[iI]\s)?(.*)$/))if(a=r[2],c=Boolean(r[1]),r=a.replace(/%(a_scriptdir|a_workingdir)%/i,ce.scriptdir).replace(/%a_linefile%/i,de),t&&ce[o?"dlldir":"includedir"].set(ce.document.positionAt(t.offset).line,o?H:V),r.trim()){if(!u.inBrowser)if(o)(0,i.existsSync)(r)&&(0,i.statSync)(r).isDirectory()?H=r.endsWith("/")||r.endsWith("\\")?r:r+"\\":(r.match(/\.\w+$/)||(r+=".dll"),r.includes(":")?ce.dllpaths.push(r.replace(/\\/g,"/").toLowerCase()):ce.dllpaths.push((H&&(0,i.existsSync)(H+r)?H+r:r).replace(/\\/g,"/").toLowerCase()));else if(t){if(r.startsWith("*")){let e=(0,u.getRCDATA)(t.content.substring(1));if(e)return N[e.uri]=e.path,void(t.data=[void 0,e.uri]);ce.addDiagnostic(d.diagnostic.resourcenotfound(),t.offset,t.length,s.DiagnosticSeverity.Warning)}else(r=A(r.toLowerCase(),ce.libdirs,V))&&(0,i.existsSync)(r.path)?(0,i.statSync)(r.path).isDirectory()?V=r.path:(N[r.uri]=r.path,t.data=[r.path,r.uri]):c||ce.addDiagnostic(r?d.diagnostic.filenotexist(r.path):d.diagnostic.pathinvalid(),t.offset,t.length);0!==n&&ce.addDiagnostic(d.diagnostic.unsupportinclude(),t.offset,t.length,s.DiagnosticSeverity.Warning)}else(r=A(r.toLowerCase().replace(/(\.d)?>$/,".d>"),ce.libdirs,ce.scriptpath))&&(0,i.existsSync)(r.path)&&!(0,i.statSync)(r.path).isDirectory()&&(N[r.uri]=r.path)}else o?H="":t&&ce.addDiagnostic(d.diagnostic.pathinvalid(),t.offset,t.length);else e&&t&&ce.addDiagnostic(d.diagnostic.pathinvalid(),t.offset,t.length)}function _e(e){if(e.startsWith(";"))return e.replace(/^\s*;\s*/gm,"");let t=e.split(/\r?\n/),n=e.startsWith("/**");return(t[0]=t[0].replace(/^\/\*+\s*/,""))||t.splice(0,1),(t[t.length-1]=t[t.length-1].replace(/\s*\*+\/\s*$/,""))||t.pop(),n?t.map((e=>e.replace(/^\s*\*(\s*(?=@)| ?)/,""))).join("\n"):t.join("\n")}function ke(e,t){return s.Range.create(ce.document.positionAt(e),ce.document.positionAt(e+t))}function Te(e,t,n,i,o){let s=r.charAt(n-1),a={content:e,type:t,offset:n,length:i,topofline:o,previous_token:se,next_token_offset:-1,prefix_is_whitespace:T.includes(s)?s:void 0};return ce.tokens[n]=a,se.next_token_offset=n,a}function Re(e,t){let n=0,i=0,o="",r="",s=[C.ArrayLiteral,C.Expression,C.ObjectLiteral].includes(t);return e&&(n=e.indentation_level,i=e.had_comment,o=e.last_text,r=e.last_word,s||(s=e.in_expression)),{case_body:!1,catch_block:!1,declaration_statement:!1,else_block:!1,finally_block:!1,had_comment:i,if_block:!1,in_case_statement:!1,in_case:!1,in_expression:s,indentation_level:n,last_text:o,last_word:r,loop_block:0,mode:t,parent:e,start_line_index:_.length,ternary_depth:0,try_block:!1}}function we(){if(ee)return;let e=_.pop();for(;0===(null==e?void 0:e.text.length);)e=_.pop();e&&_.push(e),k.had_comment&&_.push({text:[],indent:0})}function Se(){return 0===_[_.length-1].text.length}function Ce(e=!1){if(D.wrap_line_length&&!e){let t=_[_.length-1],n=0;t.text.length>0&&(n=t.text.join("").length+M.length+(X?1:0),n>=D.wrap_line_length&&(e=!0))}(D.preserve_newlines&&Y||e)&&!Se()&&xe(!0)}function xe(e=!1){if(!e&&"TK_COMMA"!==q&&"TK_EQUALS"!==q&&("TK_OPERATOR"!==q||["++","--","%"].includes(k.last_text)))for(;k.mode===C.Statement&&(k.declaration_statement||!k.if_block&&!k.loop_block&&!k.try_block);)Ae();Se()||_.push({text:[],indent:0})}function Ee(e){let t=_[_.length-1];var n;function i(e){e&&t.text.push($.repeat(t.indent=e))}t.text.length?X&&t.text.push(" "):D.keep_array_indentation&&Pe(k.mode)&&Y?(re&&t.text.push(re),n=k.parent.mode,[C.Expression,C.Conditional].includes(n)?i(k.parent.indentation_level):i(k.indentation_level)):(re&&t.text.push(re),i(k.indentation_level)),X=!1,t.text.push(null!=e?e:M)}function De(){k.indentation_level+=1}function Oe(){k.indentation_level>0&&(!k.parent||k.indentation_level>k.parent.indentation_level)&&(k.indentation_level-=1)}function Ke(e){k?(L.push(k),O=k):O=Re(null,e),k=Re(O,e)}function Pe(e){return e===C.ArrayLiteral}function Ae(){L.length>0&&(O=k,k=L.pop())}function Le(){return k.parent.mode===C.ObjectLiteral&&k.mode===C.Statement&&":"===k.last_text&&0===k.ternary_depth}function Ne(){var e;if("TK_RESERVED"===q&&["try","else","finally"].includes(k.last_text)||"TK_END_EXPR"===q&&O.mode===C.Conditional||"TK_WORD"===q&&k.mode===C.BlockStatement&&(!Y&&(null===(e=ae.previous_token)||void 0===e?void 0:e.callinfo)||!k.in_case&&!["TK_WORD","TK_RESERVED","TK_START_EXPR"].includes(j)&&!["--","++","%"].includes(M))||k.declaration_statement||k.mode===C.ObjectLiteral&&":"===k.last_text&&0===k.ternary_depth){switch(Ke(C.Statement),De(),k.last_word){case"if":case"for":case"loop":case"while":case"catch":xe(!0);case"try":case"finally":case"else":k.declaration_statement=!0}return!0}return!1}function Me(e){let t=z,n=e.length,i=r.substr(t,n);for(;i!==e&&T.includes(i.charAt(0));){if(t++,t>=ne)return!1;i=r.substr(t,n)}return i===e}function Ie(e=0){let t;do{t=je(e)}while(t.type.endsWith("COMMENT"));return t}function je(e=0){var n,i,o,c,l,u;let f,h,m,g=0,y=z;for(ie=0;T.includes(h=r.charAt(z++));)if("\n"===h)oe=z-1,ie+=1,Z=!0;else if(z>=ne)return w(),{content:"",type:"TK_EOF",offset:ne,length:0,topofline:1,next_token_offset:-1,previous_token:se};let _=z-1,k=ce.tokens[_];if(k&&k.length){if(Z=!1,z=null!==(n=k.skip_pos)&&void 0!==n?n:_+k.length,se=k,k.ignore){if("TK_START_EXPR"===k.type){if(ee=!0,!he)return je()}else if("TK_END_EXPR"===k.type&&(ee=!1,!he))return je()}else k.type.endsWith("COMMENT")&&(se=null!==(i=k.previous_token)&&void 0!==i?i:E);if(!he){let e=k.previous_extra_tokens;e&&(y<_&&(e.i=0),e.i<e.len?(k=e.tokens[e.i++],z=_):e.i=0)}return k}if(Z){Z=!1,g=1;let n=r.indexOf("\n",z);n<0&&(n=ne);let i=r.substring(oe+1,n).trim().replace(/(^|\s+);.*$/,"");if(i.includes("::")&&(pe||!"\"'".includes(i[0])||!["TK_EQUALS","TK_COMMA","TK_START_EXPR"].includes(se.type))){if(m=i.match(/^(:([^:]*):(`.|[^`])*?::)(.*)$/i)){let t;if((t=m[2].match(/[xX]/))||m[4].match(/^\s*\{?$/)?(z+=m[1].length-1,se=Te(m[1],"TK_HOT",_,m[1].length,1)):(oe=n,z=_+m[0].length,se=Te(m[1],"TK_HOTLINE",_,m[1].length,1),_+=m[1].length,se.skip_pos=z,se.data={content:r.substring(_,z),offset:_,length:z-_},ce.strcommpos.push({start:_,end:z,type:2})),se.ignore=!0,w(),m[3]||ce.addDiagnostic(d.diagnostic.invalidhotdef(),se.offset,se.length),"TK_HOTLINE"===se.type||!t&&!m[4].match(/^\s*\{/)){if(e>5)return delete ce.tokens[se.offset],se;me=t=!0;let n,i=se,s=Ie(e+1);for(;s.ignore&&"TK_STRING"===s.type;){if((z=r.indexOf("\n",n=z))<0&&(z=ne),n<z){let e=r.substring(n,z).trimRight();s.content+=e,s.length+=e.length}ce.strcommpos.push({start:s.offset,end:s.offset+s.length,type:2}),t=!1,s=Ie(e+1)}me=!1,se=i,t||"TK_HOT"!==se.type?z=null!==(o=i.skip_pos)&&void 0!==o?o:i.offset+i.length:(se.type="TK_HOTLINE",se.skip_pos=z=_+m[0].length,_+=m[1].length,se.data={content:r.substring(_,z),offset:_,length:z-_},ce.strcommpos.push({start:_,end:z,type:2}))}return se}if(m=i.match(/^(((([<>$~*!+#^]*?)(`?;|[\x21-\x3A\x3C-\x7E]|[a-z]\w+|[^\x00-\x7f]))|~?(`?;|[\x21-\x3A\x3C-\x7E]|[a-z]\w+|[^\x00-\x7f])\s*&\s*~?(`?;|[\x21-\x3A\x3C-\x7E]|[a-z]\w+|[^\x00-\x7f]))(\s+up)?\s*::)(.*)$/i)){let e=m[9].match(/^(\s*)(([<>~*!+#^]*?)(`[{;]|[\x21-\x7A\x7C-\x7E]|[a-z]\w+|[^\x00-\x7f]))$/i);if(w(),e){let i=e[2].toLowerCase();if(!t.allIdentifierChar.test(i)||i.match(x))return oe=n,z=_+m[0].length,se=Te(m[1].replace(/\s+/g," "),"TK_HOTLINE",_,m[1].length,1),_+=se.length+e[1].length,se.skip_pos=z,se.data={content:m[9].trim(),offset:_,length:z-_,data:e[2]},se}return z=r.indexOf("::",z)+2,se=Te(m[1].replace(/\s+/g," "),"TK_HOT",_,m[1].length,1)}}"#"!==h&&w()}if(v(h.charCodeAt(0))){for(;z<ne&&v(r.charCodeAt(z));)h+=r.charAt(z),z+=1;if("."!==r.charAt(_-1)){if(m=h.match(/^(\d+[Ee](\d+)?|(0[Xx][\da-fA-F]+)|(\d+))$/)){if(m[2]||m[3])return se=Te(h,"TK_NUMBER",_,h.length,g),se.semantic={type:p.number},se;if(m[4]){if(z<ne&&"."===r.charAt(z)){let e="",t="",n=z+1;for(;n<ne&&v(r.charCodeAt(n));)e+=r.charAt(n),n+=1;if(e.match(/^\d*([Ee]\d+)?$/))return h+="."+e,z=n,se=Te(h,"TK_NUMBER",_,h.length,g),se.semantic={type:p.number},se;if(e.match(/^\d*[Ee]$/)&&n<ne&&"-+".includes(r.charAt(n))){for(e+=r.charAt(n),n+=1;n<ne&&v(r.charCodeAt(n));)t+=r.charAt(n),n+=1;t.match(/^\d+$/)&&(h+="."+e+t,z=n)}}return se=Te(h,"TK_NUMBER",_,h.length,g),se.semantic={type:p.number},se}if(z<ne&&"-+".includes(r.charAt(z))){let t,n=r.charAt(z),i=z;if(z+=1,t=je(e+1),delete ce.tokens[t.offset],"TK_NUMBER"===t.type&&t.content.match(/^\d+$/))return h+=n+t.content,se=Te(h,"TK_NUMBER",_,h.length,g),se.semantic={type:p.number},se;z=i}}if(S.includes(h.toLowerCase())){if(h.match(/^(and|or|not|in|is|contains)$/i))return se=Te(h,"TK_OPERATOR",_,h.length,g);if(g||"class"!==h.toLowerCase())return se=Te(h,"TK_RESERVED",_,h.length,g)}}return se=Te(h,"TK_WORD",_,h.length,g)}if("("===h||"["===h){if("("===h&&g&&!ee){let e,t=z;for(;t<ne;){if("\n"===(e=r.charAt(t++))){if(me){let e=oe+1,n=r.indexOf("\n",t),i=null,o=[];for(;n>0&&!(i=r.substring(t,n).match(/^\s*\)/));)o.push(n-t),n=r.indexOf("\n",t=n+1);return n<0&&(o.push(ne-t),i=r.substring(t,ne).match(/^\s*\)/)),z=i?t+i[0].length:ne,o.push(z-t),f=r.substring(_,z).trimRight(),se=Te(r.substring(e,_)+f,"TK_STRING",_,f.length,1),ce.addFoldingRange(e,z,"block"),se.data=o,se.ignore=!0,se}{let e=!se.type||"TK_START_BLOCK"===se.type&&se.topofline>0;for(se=Te(h,"TK_START_EXPR",_,1,1),se.ignore=!0,z=t-1,ee=!0;" \t".includes(r.charAt(++_)||"\0");)continue;let n=r.substring(_,z).trimRight();se.data={content:n,offset:_,length:z-_},se.skip_pos=z;let i,o=n.match(/(?<=(^|\s))join(\S*)/i),s=se,c=se,l=!1,d=he,u=z,f=(e,t)=>{};if(o){let e=o[2].replace(/`[srn]/g,"  "),t=!1,n=new P(a.TextDocument.create("","ahk2",-10,e));n.parseScript();let i=Object.values(n.tokens);_+=4+o.index,i.length&&(t=T.includes(e.charAt(e.length-1)),i.map((e=>{e.offset+=_,e.length=0,e.next_token_offset=-1})),f=(e,n)=>{let o=[];for(let t=0;t<e;t++){n=r.indexOf("\n",n+1);for(let e of i)e=Object.assign({},e),e.offset=n,o.push(e)}return{i:0,len:o.length,tokens:o,suffix_is_whitespace:t}},",)]}".includes(i[0].content)&&(l=!0))}for(he=!0,i=je(),ee&&"TK_EOF"!==i.type&&(ie>1&&(i.previous_extra_tokens=f(ie-1,u)),i.topofline=e?1:0,u=oe,c=i,i=je());ee&&"TK_EOF"!==i.type;)i.topofline&&(i.previous_extra_tokens=f(ie,u),i.topofline=0,u=oe,l&&"?"===c.content&&(c.ignore=!0)),c=i,i=je();return i.ignore&&"TK_END_EXPR"===i.type&&(ie>1&&(i.previous_extra_tokens=f(ie-1,u)),s.next_pair_pos=i.offset,i.previous_pair_pos=s.offset,ce.addFoldingRange(s.offset,i.offset,"block")),z=s.skip_pos,se=(he=d)?s:je()}}if((")"===e||"("===e)&&!r.substring(t-6,t-1).match(/[(\s]join\S*$/i))break}}return se=Te(h,"TK_START_EXPR",_,1,g)}if(")"===h||"]"===h)return se=Te(h,"TK_END_EXPR",_,1,g),")"===h&&g&&ee?(ee=!1,se.ignore=!0,he?se:je()):se;if("{"===h&&(f="TK_START_BLOCK")||"}"===h&&(f="TK_END_BLOCK"))return g&&(oe=_,Z=!0),se=Te(h,f,_,1,g);if('"'===h||"'"===h){let t,n,i=h,o=_,s=!1,a={type:p.string};for(f="";h=r.charAt(z++);)if("`"===h)z++;else{if(h===i)return f+=r.substring(_,z),se=Te(f,"TK_STRING",_,z-_,g),ce.strcommpos.push({start:_,end:z,type:2}),s&&(se.data=null,se.semantic=a),t&&(se=t,z=se.offset+se.length),se;if(ee){if("\n"===h){let e=z-1;for(;" \t".includes(h=r.charAt(z)||"\0");)z++;if(")"===h){f=r.substring(_,e).trimRight(),se=Te(f,"TK_STRING",_,f.length,g=0),null!=t||(t=se),f="",ce.strcommpos.push({start:_,end:_+se.length,type:2});let n=se.previous_token;for(;n&&(!n.ignore||"("!==n.content);)n=n.previous_token;for(ce.addFoldingRange(_,e,"string"),se=Te(")","TK_END_EXPR",z,1,1),se.ignore=!0,n&&(n.next_pair_pos=z,se.previous_pair_pos=n.offset),ee=!1,s=!0,_=++z;" \t".includes(h=r.charAt(z)||"\0");)z++;f=r.substring(_,z),_=z}}}else if("\n"===h||";"===h&&" \t".includes(r.charAt(z-2))){f=(f+r.substring(_,z-(";"===h?2:1))).trimRight(),--z,f&&(se=Te(f,"TK_STRING",_,f.trimLeft().length,g),ce.strcommpos.push({start:_,end:_+se.length,type:2}),s&&(se.data=null,se.semantic=a),null!=t||(t=se),f="");break}}if(h){if(e>5)return se=t,z=se.offset+se.length,delete ce.tokens[se.offset],se;me=pe=!0;let c=Ie(e+1);e:for(;c.ignore&&"TK_STRING"===c.type;){let t=z,n=c.data;for(s&&(c.semantic=a);h=r.charAt(z++);)if("`"===h)z++;else{if(h===i){let e=r.substring(t,z);c.content+=e,c.length+=e.length,n[n.length-1]+=e.length,ce.strcommpos.push({start:c.offset,end:c.offset+c.length,type:2});break e}if("\n"===h||";"===h&&" \t".includes(r.charAt(z-2))){let e=r.substring(t,z-(";"===h?2:1)).trimRight();e&&(c.content+=e,c.length+=e.length,n[n.length-1]+=e.length),ce.strcommpos.push({start:c.offset,end:c.offset+c.length,type:2}),z--;break}}if(!h){let e=r.substring(t,--z);e&&(c.content+=e,c.length+=e.length),ce.strcommpos.push({start:c.offset,end:c.offset+c.length,type:2})}c=Ie(e+1)}return c.ignore&&"TK_STRING"===c.type||((n=c.previous_token)?ce.addDiagnostic(d.diagnostic.unterminated(),n.offset+n.length,1):ce.addDiagnostic(d.diagnostic.missing(i),o,1)),me=!1,se=t,z=se.offset+se.length,se}return ce.addDiagnostic(d.diagnostic.unterminated(),ne,1),f+=r.substring(_,ne),se=Te(f,"TK_STRING",_,ne-_,g),ce.strcommpos.push({start:_,end:ne,type:2}),s&&(se.data=null,se.semantic=a),ee&&(ce.addFoldingRange(_,ne,"string"),ee=!1),se}if("."===h){let e=r.charAt(z);if("="===e)return z++,se=Te(".=","TK_EQUALS",_,2,g);if(T.includes(r.charAt(z-2))&&T.includes(e))return se=Te(h,"TK_OPERATOR",_,1,g);if(e.match(/\d/)&&("TK_EQUALS"===se.type||"TK_OPERATOR"===se.type)){let t=z+1,n="";for(;t<ne&&v(r.charCodeAt(t));)e+=r.charAt(t),t+=1;if(e.match(/^\d+([Ee]\d+)?$/))return z=t,h+=e,se=Te("0"+h,"TK_NUMBER",_,h.length,g),se.semantic={type:p.number},se;if(t<ne&&e.match(/^\d+[Ee]$/)&&"-+".includes(r.charAt(t))){for(e+=r.charAt(t),t+=1;t<ne&&v(r.charCodeAt(t));)n+=r.charAt(t),t+=1;if(n.match(/^\d+$/))return z=t,h+=e+n,se=Te("0"+h,"TK_NUMBER",_,h.length,g),se.semantic={type:p.number},se}}return se=Te(h,T.includes(e)?"TK_UNKNOWN":"TK_DOT",_,1,g)}if(";"===h){let e,t,n,i,o="",a=g?"TK_COMMENT":"TK_INLINE_COMMENT",u=_-1,f=0;for(;;){if(z=u,u=r.indexOf("\n",z+1),i=r.substring(z+1,u=u<0?ne:u).trim(),i.startsWith(";")){if(f++,e=i.match(/^;+\s*([{}])/)){if("{"===e[1]?G.bracket.push(z+1):void 0!==(e=G.bracket.pop())&&ce.addFoldingRange(e,z+1,"block"),1===f&&(n=!0),g)continue}else if(e=i.match(/^;(\s*~?\s*)(todo|fixme)(:?\s*)(.*)/i)){if(ce.children.push(s.DocumentSymbol.create(`${e[2].toUpperCase()}: ${e[4].trim()}`,void 0,s.SymbolKind.Module,t=ke(z+1,u-z-1),t)),g)continue}else if(g){if(e=i.match(/^;\s*#(end)?region\b/i))n=!0,e[1]?void 0!==(e=G.region.pop())&&ce.addFoldingRange(e,z+1,"region"):(G.region.push(z+1),(i=i.substring(e[0].length).trim())&&ce.children.push(s.DocumentSymbol.create(i,void 0,s.SymbolKind.Module,t=ke(z+1,u-z-1),t)));else if(e=i.match(/^;@include\s+(.*)/i))n=!0,be(e[1].replace(/\s+;.*$/,"").trim());else if(e=i.match(b)){let i=e.groups;if(i){for(let t in i)if(t.startsWith("tag")&&(e=null===(l=i[t])||void 0===l?void 0:l.trim()))break}else e=null===(c=e[1])||void 0===c?void 0:c.trim();e&&(ce.children.push(s.DocumentSymbol.create(e,void 0,s.SymbolKind.Module,t=ke(z+1,u-z-1),t)),n=!0)}continue}z=u}break}o=r.substring(_,z).trimRight(),ce.strcommpos.push({start:_,end:z,type:1});let p=ce.tokens[_]={type:a,content:o,offset:_,length:o.length,next_token_offset:-1,topofline:g,ignore:n,skip_pos:z,previous_token:se};return g?me||n||!i[0]||i.startsWith("/*")||(fe[ce.document.positionAt(z).line+1]=p):T.includes(r.charAt(_-1))||ce.addDiagnostic(d.diagnostic.unexpected(p.content),_,p.length),f>1&&ce.addFoldingRange(_,z,"comment"),p}if("/"===h&&g&&"*"===r.charAt(z)){let t,n=r.indexOf("\n",--z),i=0;for(;!(m=r.substring(z,n>0?n:ne).match(/(^\s*\*\/)|(\*\/\s*$)/))&&n>0;)oe=n,n=r.indexOf("\n",z=n+1),i++;m&&m[1]?(z=r.indexOf("*/",oe)+2,Z=!0,oe=z-1):z=n<0?ne:n,ce.strcommpos.push({start:_,end:z,type:1});let o={type:"TK_BLOCK_COMMENT",content:r.substring(_,z),offset:_,length:z-_,next_token_offset:-1,previous_token:se,topofline:g,skip_pos:z};if(!me){if(e>5)return o;let n=se,i=z;(t=je(1)).length&&(ie<2&&(null!==(u=t.prefix_is_whitespace)&&void 0!==u||(t.prefix_is_whitespace=" "),fe[ce.document.positionAt(t.offset).line]=o),o.next_token_offset=t.offset),se=n,z=i}return ce.tokens[_]=o,i&&ce.addFoldingRange(_,z,"comment"),o}if(R.includes(h)){for(;z<ne&&R.includes(h+r.charAt(z))&&(h+=r.charAt(z),z+=1,!(z>=ne)););if(","===h)return se=Te(h,"TK_COMMA",_,1,g);if("?"===h){se=Te(h,"TK_OPERATOR",_,1,g);let t=z,n=se,i=Ie(e+1);return z=t,"TK_COMMA"!==i.type&&"TK_END_EXPR"!==i.type&&"}"!==i.content&&"TK_EOF"!==i.type||(n.ignore=!0),se=n}return se=Te(h,h.match(/([:.+\-*/|&^]|\/\/|>>|<<)=/)?"TK_EQUALS":"TK_OPERATOR",_,h.length,g)}if("#"===h){let e="#";for(;v((h=r.charAt(z)).charCodeAt(0));)e+=h,z++;if(ue.push(_),se=Te(e,"TK_SHARP",_,e.length,g),"#hotif"===e.toLowerCase()&&g&&T.includes(h))return se;if(oe=r.indexOf("\n",_=z),z=oe<0?ne:oe,g&&T.includes(h)){if(" "===h||"\t"===h){for(;" \t".includes(r.charAt(_)||"\0");)_++;let e=r.substring(_,z).trimRight().replace(/(^|\s+);.*$/,"");se.skip_pos=z=_+e.length,se.data={content:e,offset:_,length:e.length}}}else se.type="TK_UNKNOWN",se.content+=r.substring(_,z).trimRight(),se.length+=z-_;return se}return se=Te(h,"TK_UNKNOWN",_,h.length,g);function w(){ue.length>1&&ce.addFoldingRange(ue[0],ue.pop(),"imports"),ue.length=0}}function qe(){let e=_[k.start_line_index-1];return(null==e?void 0:e.text.length)?e.indent:k.indentation_level}function Fe(){var e;let t=!1;if((F.match(/[^\W]$/)||["TK_END_EXPR","TK_STRING"].includes(q))&&(X=!0),Ne()&&(t=k.declaration_statement,!Y&&["else","finally"].includes(k.last_word)&&["if","while","loop","for","try","switch"].includes(I)&&Oe()),"TK_RESERVED"===j){if(["break","continue","global","goto","local","return","static","throw"].includes(I))Y&&D.preserve_newlines&&xe(t);else{let e=!1;switch(I){case"else":for(;k.mode===C.Statement&&!k.if_block&&!k.loop_block&&(!k.catch_block||k.else_block);)Ae();break;case"finally":for(;!(k.mode!==C.Statement||k.catch_block||k.try_block||k.else_block&&k.catch_block);)Ae();break;case"catch":for(;k.mode===C.Statement&&!k.try_block&&(!k.catch_block||k.else_block);)Ae();break;case"until":for(;k.mode===C.Statement&&1!==k.loop_block;)Ae();break;case"case":case"class":for(;k.mode===C.Statement;)Ae();break;case"if":case"for":case"loop":case"while":case"try":case"switch":if(!t)for(;k.mode===C.Statement&&k.declaration_statement;)Ae()}if(k.if_block?"else"===I?(k.if_block=!1,k.else_block=!0,e=!0):k.if_block=!1:k.loop_block?1===k.loop_block&&"until"===I?(k.loop_block=0,e=!0):"else"===I?(k.else_block=!0,k.loop_block=0,e=!0):k.loop_block=0:k.try_block?"catch"===I?(k.try_block=!1,k.catch_block=!0,e=!0):"finally"===I?(k.try_block=!1,k.finally_block=!0,e=!0):k.try_block=!1:k.catch_block?"finally"===I?(k.catch_block=k.else_block=!1,k.finally_block=!0,e=!0):"else"===I?(k.else_block=!0,e=!0):"catch"===I?e=!0:k.catch_block=k.else_block=!1:k.else_block=k.finally_block=!1,"class"===I)return xe(),Ee(),k.last_word=I,Ke(C.Statement),void(J=!0);if("case"===I&&(k.in_case_statement||"BlockStatement"===k.mode&&"switch"===k.last_word))return xe(),k.case_body&&(Oe(),k.case_body=!1),Ee(),k.in_case=!0,void(k.in_case_statement=!0);switch(e?(we(),"}"!==k.last_text||D.one_true_brace<1||Y&&D.preserve_newlines&&!D.one_true_brace?xe(!0):X=te):Y&&xe(t),I){case"loop":k.loop_block=1;break;case"while":case"for":k.loop_block=2;break;case"if":k.if_block=!0;break;case"try":k.try_block=!0}}k.last_word=I}else!Y||k.mode!==C.Statement||k.is_expression||$e(null!==(e=ae.previous_token)&&void 0!==e?e:E,ae)?Y&&D.preserve_newlines?xe(!0):["TK_COMMA","TK_START_EXPR","TK_EQUALS","TK_OPERATOR"].includes(q)&&(Le()||Ce()):xe(t),!J&&ae.symbol&&k.mode===C.BlockStatement&&(Ke(C.Statement),J=!0),k.last_word="_";Ee()}function We(){var e;xe(),Ee();let t=null===(e=ae.data)||void 0===e?void 0:e.content;t?Ee("TK_HOTLINE"===j?t:" "+t):X=te}function $e(e,t,n){switch(t.type){case"TK_DOT":case"TK_COMMA":case"TK_EQUALS":return!0;case"TK_OPERATOR":return""===e.type||!t.content.match(/^(!|~|not|%|\+\+|--)$/i)&&(!n||!t.content.match(/^\w/)||n.kind!==s.SymbolKind.Class);case"TK_END_BLOCK":case"TK_END_EXPR":return!1;case"TK_STRING":if(t.ignore)return!0;default:switch(e.type){case"TK_COMMA":case"TK_EQUALS":case"":return!0;case"TK_OPERATOR":return!e.ignore&&!e.content.match(/^(\+\+|--|%)$/);default:return!1}}}function Ue(){return Y&&(k.parent.mode===C.BlockStatement&&["TK_END_EXPR","TK_START_BLOCK","TK_END_BLOCK","TK_WORD","TK_STRING"].includes(q)||"TK_OPERATOR"===q&&F.match(/^(\+\+|--|%)$/)||"TK_RESERVED"===q&&F.match(/^(break|continue|goto|global|local|loop|return|static|throw)$/))}this.document=e,e.uri&&(this.scriptpath=(de=c.URI.parse(this.uri=e.uri.toLowerCase()).fsPath).replace(/\\[^\\]+$/,""),this.initlibdirs(n)),this.get_token=function(e,t=!1){let n,i,o=z;if(void 0!==e){z=e,i=se;do{n=je()}while(t&&n.type.endsWith("COMMENT"));z=o,se=i}else do{n=je()}while(t&&n.type.endsWith("COMMENT"));return n},this.find_token=function(e,t=!1){var n,i,o;let s,a=e,c=r.charAt(e),l=ce.tokens,d={type:"TK_EOF",content:"",offset:ne,length:0,next_token_offset:-1,topofline:1};if(!c)return d;if(T.includes(c)){for(;T.includes(c=r.charAt(++a)||"\0");)continue;if(s=l[a])return s;if("\0"===c)return(s=l[ce.strcommpos[ce.strcommpos.length-1].start])&&a===s.offset+s.length?s:d}else{if(s=l[a])return s;if(v(c.charCodeAt(0)))for(;v(r.charCodeAt(--a));)continue;else for(;!T.includes(c=r.charAt(--a))&&!v(c.charCodeAt(0)););if(s=null!==(n=l[++a])&&void 0!==n?n:l[a-1]){if(e>=s.offset&&e<s.offset+s.length)return s;for(;(s=l[s.next_token_offset])&&!(s.offset>e);)if(e<s.offset+s.length)return s}}return t?d:null!==(o=l[null===(i=ce.strcommpos.find((t=>e>=t.start&&t.end>=e)))||void 0===i?void 0:i.start])&&void 0!==o?o:d},this.beautify=function(e,t){var n,i,o;let s,a;for(ce.isparsed||ce.parseScript(),D=Object.assign({break_chained_methods:!1,ignore_comment:!1,indent_string:"\t",keep_array_indentation:!0,max_preserve_newlines:3,preserve_newlines:!0,space_before_conditional:!0,space_in_empty_paren:!1,space_in_other:!0,space_in_paren:!1,wrap_line_length:0},e),isNaN(D.one_true_brace=Number(D.one_true_brace))&&delete D.one_true_brace,q=W=F="",Z=!0,se=E,oe=-1,a=ne,ae=ce.get_token(0),re=r.substring(r.lastIndexOf("\n",z=ae.offset)+1,z),J=X=!1,he=!0,$=null!==(n=D.indent_string)&&void 0!==n?n:"\t",te=null===(i=D.space_in_other)||void 0===i||i,_=[{text:[],indent:0}],L=[],k=null,Ke(C.BlockStatement),t&&(a=ce.document.offsetAt(t.end),ae=ce.find_token(ce.document.offsetAt(t.start)),t.start=ce.document.positionAt(z=ae.offset),re=r.substring(r.lastIndexOf("\n",z)+1,z).replace(/\S.*$/,""));;){if(j=(ae=je()).type,I=(M=ae.content).toLowerCase(),ae.offset>=a){if(t){let e=ae.previous_token,n=z;if("TK_RESERVED"===q&&["try","else","finally"].includes(F)&&De(),k.declaration_statement&&Se()||xe(),e){if(k.had_comment)for(;(ae=ce.find_token(e.offset+e.length)).offset<a;)e=ae;for(n=e.offset+e.length;" \t".includes(r.charAt(n)||"\0");n++);for(T.includes(r.charAt(n))||(n=e.offset+e.length);Se();)_.pop()}t.end=ce.document.positionAt(n),t.indent_string=re+$.repeat(k.indentation_level)}for(;k.mode===C.Statement;)Ae();break}if(J&&!(J=ie?!c(ae):"TK_START_BLOCK"!==j||ae.data))Ae(),q="TK_END_EXPR",k.last_text=")",Y=ie>0;else if(Y=ie>0)if(ee){xe();for(let e=1;e<ie;e++)_.push({text:[],indent:0})}else if(!J&&!k.in_expression&&(ae.type.endsWith("COMMENT")||!$e(k.mode===C.Statement?null!==(o=ae.previous_token)&&void 0!==o?o:E:{},ae))&&("TK_RESERVED"!==q||!["catch","else","finally","until"].includes(F))){D.max_preserve_newlines&&ie>D.max_preserve_newlines&&(ie=D.max_preserve_newlines),Se()||_.push({text:[],indent:0});for(let e=1;e<ie;e++)_.push({text:[],indent:0})}ge[j](),j.endsWith("COMMENT")||(!J&&"TK_RESERVED"===j&&["if","for","while","loop","catch","switch"].includes(I)&&(J=!0,Ke(C.Conditional),"switch"!==I&&De()),W=k.last_text,k.last_text=I,k.had_comment=0,q=j,F=I)}return s=_.map((e=>e.text.join(""))).join("\n"),_=[],he=!1,s;function c(e){if(![C.Conditional,C.Statement].includes(k.mode)||k.parent.mode===C.ObjectLiteral)return!1;switch(e.type){case"TK_DOT":case"TK_COMMA":case"TK_EQUALS":case"TK_COMMENT":case"TK_INLINE_COMMENT":case"TK_BLOCK_COMMENT":return!1;case"TK_OPERATOR":return Boolean(e.content.match(/^(!|~|not|%|\+\+|--)$/i));case"TK_STRING":return!e.ignore;default:let t=e.previous_token;switch(t.type){case"TK_COMMA":case"TK_EQUALS":return!1;case"TK_OPERATOR":return Boolean(t.content.match(/^(\+\+|--|%)$/))}}return!0}},o||e.uri.match(/\.d\.(ahk2?|ah2)(?=(\?|$))/i)?(this.d=o||1,this.parseScript=function(){var e,t,n,i,o,a,c,l,d;r=this.document.getText(),ne=r.length,V=this.scriptpath,se=E,Z=!0,z=0,oe=-1;let f,m,v="",b=0,_=0,k=0,T=!1;this.clear(),this.reflat=!0,G={region:[],bracket:[]};let R,w=0,S=[],C=[],x=[s.DocumentSymbol.create("",void 0,s.SymbolKind.Namespace,R=ke(0,0),R,this.children)];for(N=this.include,x[0].declaration=this.declaration,fe={};je().length;)continue;for(S=Object.values(this.tokens),k=S.length;b<k;)switch((f=S[b]).type){case"TK_WORD":if(_=b+1,_<k)if(w&&((m=S[_]).topofline||"=>"===m.content||"["===m.content)){let o=y.create(f.content,s.SymbolKind.Property,R=ke(f.offset,f.length));f.symbol=o,f.semantic={type:p.property,modifier:1<<h.definition|1<<h.readonly|(T?1<<h.static:0)},null===(e=x[w].children)||void 0===e||e.push(o),o.static=T,o.full=`(${C.join(".")}) `+o.name,T&&w?x[w].staticdeclaration[o.name.toLowerCase()]=o:x[w].declaration[o.name.toLowerCase()]=o,S[b-(T?2:1)].type.endsWith("COMMENT")&&(o.detail=_e(S[b-(T?2:1)].content));let r=[];if("["===m.content){for(;"]"!==(m=S[++_]).content;)if("TK_WORD"===m.type){let e=y.create(m.content,s.SymbolKind.Variable,R=ke(m.offset,m.length));r.push(e),m.semantic={type:p.parameter,modifier:1<<h.definition};let t=S[_+1];"?"===t.content?(e.defaultVal=null,_++):":="===t.content?e.defaultVal=S[_+=2].content:"*"===t.content&&(e.arr=!0,_++)}m=S[++_]}if(o.full=`(${C.join(".")}) `+o.name,"{"===m.content)for(o.children=[];"}"!==(f=S[++_]).content;)if("=>"===f.content){let e,i=g.create(m.content,s.SymbolKind.Function,R=ke(m.offset,m.length),R,r,void 0,T);for(m.symbol=i,m=S[++_],"TK_START_EXPR"===m.type&&(m=S[++_]),e=[],"TK_WORD"===m.type?e.push("#"+m.content.toLowerCase()):"TK_NUMBER"===m.type&&e.push(m.content);"|"===S[_+1].content;)"TK_WORD"===(m=S[_+=2]).type?(e.push("#"+m.content),m.semantic={type:p.class}):"TK_NUMBER"===m.type?e.push(m.content):_--;"TK_END_EXPR"===S[_+1].type&&(m=S[++_]),i.range.end=this.document.positionAt(m.offset+m.length),i.returntypes={[e.length>1?`[${e.join(",")}]`:null!==(t=e.pop())&&void 0!==t?t:"#any"]:!0},null===(n=o.children)||void 0===n||n.push(i)}else m=f;else{let e=[];if("=>"===m.content){for(m=S[++_],"TK_START_EXPR"===m.type&&(m=S[++_]),e=[],"TK_WORD"===m.type&&e.push("#"+m.content.toLowerCase());"|"===S[_+1].content;)"TK_WORD"===(m=S[_+=2]).type?(e.push("#"+m.content),m.semantic={type:p.class}):_--;"TK_END_EXPR"===S[_+1].type&&(m=S[++_])}o.returntypes={[e.length>1?`[${e.join(",")}]`:null!==(i=e.pop())&&void 0!==i?i:"#any"]:!0}}}else if("("===S[_].content){let e=[],t=!1,n=0;for(;")"!==(m=S[++_]).content;){let i;switch(m.type){case"TK_WORD":i=y.create(m.content,s.SymbolKind.Variable,R=ke(m.offset,m.length)),i.ref=t,t=!1,e.push(i),m.semantic={type:p.parameter,modifier:1<<h.definition},":="===(m=S[_+1]).content?(_+=2,"+"===(m=S[_]).content||"-"===m.content?i.defaultVal=m.content+S[++_].content:i.defaultVal=m.content):"?"===m.content?(i.defaultVal=null,_++):(n&&(i.defaultVal=!1),"*"===m.content?(i.arr=!0,_++):"["===m.content?(n++,_++):"]"===m.content&&(n--,_++));break;case"TK_STRING":e.push(i=y.create(m.content,s.SymbolKind.String,R=ke(m.offset,m.length))),n&&(i.defaultVal=!1);break;default:t=!1,"&"===m.content?t=!0:"*"===m.content?(e.push(y.create(m.content,s.SymbolKind.Variable,R=ke(m.offset,m.length))),m.semantic={type:p.parameter,modifier:1<<h.definition}):"["===m.content?n++:"]"===m.content&&n--}}let i,r="",c="";if(m=S[_],_<k-2&&"=>"===S[_+1].content){i=[],"TK_START_EXPR"===S[_+2].type&&_++;do{for(_+=1,r="",c="";(m=S[_+1])&&("TK_WORD"===m.type||"TK_DOT"===m.type)&&!m.topofline&&c!==m.type;)r+=m.content,_++,c=m.type,m.semantic={type:p.class};r&&i.push(r.replace(/(?<=(^|\.))([^.$@#]+)$/,"@$2").replace("$",""))}while("|"===(null===(o=S[_+1])||void 0===o?void 0:o.content));"TK_END_EXPR"!==(null==m?void 0:m.type)&&(m=S[_])}let l=g.create(f.content,w?s.SymbolKind.Method:s.SymbolKind.Function,ke(f.offset,m.offset+m.length-f.offset),ke(f.offset,f.length),e,[],T);if(f.symbol=l,l.full=this.document.getText(l.range),l.static=T,l.declaration={},f.semantic={type:w?p.method:p.function,modifier:1<<h.definition|1<<h.readonly|(T?1<<h.static:0)},w&&(l.full=`(${C.join(".")}) `+l.full),i){let e={};i.map((t=>e[t.toLowerCase()]=!0)),l.returntypes=e}(b-=T?2:1)>=0&&S[b].type.endsWith("COMMENT")&&(l.detail=_e(S[b].content)),null===(a=x[w].children)||void 0===a||a.push(l),T&&w?x[w].staticdeclaration[l.name.toLowerCase()]=l:x[w].declaration[l.name.toLowerCase()]=l}b=_+1,T=!1;break;case"TK_RESERVED":if(T=!1,"static"===(v=f.content.toLowerCase()))T=!0,b++;else if(b<k-1&&"class"===v){let e="",t=s.DocumentSymbol.create((f=S[++b]).content.replace("_","#"),S[b-2].type.endsWith("COMMENT")?_e(S[b-2].content):void 0,s.SymbolKind.Class,ke(S[b-1].offset,0),ke(f.offset,f.length),[]),n=t;if(n.declaration={},n.staticdeclaration={},_=b+1,C.push(t.name),n.full=C.join("."),n.returntypes={[n.full.replace(/([^.]+)$/,"@$1").toLowerCase()]:!0},f.semantic={type:p.class,modifier:1<<h.definition|1<<h.readonly},f.symbol=t,n.funccall=[],n.extends="",n.declaration={},n.staticdeclaration={},null===(c=x[w].children)||void 0===c||c.push(t),0===w?x[0].declaration[t.name.toLowerCase()]=t:x[w].staticdeclaration[t.name.toLowerCase()]=t,"extends"===(null===(l=m=S[_])||void 0===l?void 0:l.content.toLowerCase())){for(;++_<k&&"{"!==(m=S[_]).content;)e+=m.content;n.extends=e}w++,x.push(t),b=_+1}else f.type="TK_WORD";break;case"TK_END_BLOCK":if(w){w--,C.pop();let e=x.pop();e.range.end=this.document.positionAt(f.offset+f.length),this.addFoldingRangePos(e.range.start,e.range.end)}default:b++,T=!1}if(!(this.d<0)){if(2&this.d){let e,t=this.uri.endsWith("/ahk2_h.d.ahk")?1:0;this.children.map((n=>{var i;switch(n.kind){case s.SymbolKind.Function:case s.SymbolKind.Class:n.overwrite=t,n.uri=this.uri,(!(e=u.ahkvars[v=n.name.toLowerCase()])||t>=(null!==(i=e.overwrite)&&void 0!==i?i:0))&&(u.ahkvars[v]=n)}}));let n=this.declaration.struct;n&&n.kind===s.SymbolKind.Class&&(n.def=!1),n=null===(d=u.ahkvars.class)||void 0===d?void 0:d.staticdeclaration.call,n&&(n.def=!1)}B({},this.children,this.diagnostics),this.diags=this.diagnostics.length,this.isparsed=!0,G.region.map((e=>this.addFoldingRange(e,z-1,"region")))}}):this.parseScript=function(){r=this.document.getText(),ne=r.length,V=this.scriptpath,H="",Z=!0,se=E,z=0,oe=-1,G={region:[],bracket:[]},ee=!1,le=u.isahk2_h,this.clear(),this.reflat=!0,N=this.include,fe={};try{let e=(0,u.getRCDATA)("#2");e&&(N[e.uri]=e.path),this.children.push(...ve())}catch(e){if(!(e instanceof K))throw e;this.addDiagnostic(e.message,e.token.offset,e.token.length,s.DiagnosticSeverity.Warning)}B(this.declaration,this.children,this.diagnostics),this.diags=this.diagnostics.length,this.isparsed=!0,G.region.map((e=>this.addFoldingRange(e,z-1,"region")))}}clear(){this.texts={},this.declaration={},this.include={},this.tokens={},this.linepos={},this.labels={},this.object={method:{},property:{},userdef:{}},this.funccall.length=this.diagnostics.length=this.foldingranges.length=0,this.children.length=this.dllpaths.length=this.strcommpos.length=this.anonymous.length=0,this.includedir=new Map,this.dlldir=new Map}searchNode(e,t,n){var i,o;let r,a,c=this.uri;if(e=e.toLowerCase(),n===s.SymbolKind.Variable||n===s.SymbolKind.Class||n===s.SymbolKind.Function){let n,l,d=!0,u=!1;if(e.startsWith("$"))return(r=this.anonymous[parseInt(e.substring(1))])?{node:r,uri:c}:null;if(t&&(n=this.searchScopedNode(t),n)){if(n.kind===s.SymbolKind.Function&&n.static&&(u=!0),n.kind===s.SymbolKind.Class&&n.extends){let e=this.tokens,o=e[e[this.document.offsetAt(n.selectionRange.start)].next_token_offset];(null!==(i=o.pos)&&void 0!==i?i:o.pos=this.document.positionAt(o.offset)).line===t.line&&(n=void 0)}l=n}if(n){for(;n;){let t=n.declaration,i=n.local,d=n.global;if(i&&(a=i[e])&&(!u||a.static))return a.selectionRange.start.character!==a.selectionRange.end.character&&{node:a,uri:c,scope:n};if(d&&d[e])return{node:this.declaration[e]||d[e],uri:c,scope:n};if(n.assume===f.GLOBAL)return(r=this.declaration[e])?{node:r,uri:c,scope:n}:void 0;if(t&&n.kind!==s.SymbolKind.Class&&(a=t[e]))if(u){if(a.static)return{node:a,uri:c,scope:n};l!==n&&null!==a.static||(r=a)}else{if(n.kind===s.SymbolKind.Method||!n.parent)return{node:a,uri:c,scope:n};r=a}else if(u&&l===n&&(r=null===(o=n.children)||void 0===o?void 0:o.find((t=>t.name.toLowerCase()===e)),r&&r.static))return{node:r,uri:c,scope:n};n=n.parent}if(r)return u&&(a=r.def?r:this.declaration[e])?{node:a,uri:c,scope:n}:{node:r,uri:c,fn_is_static:u,scope:n};if(["this","super"].includes(e)){for(n=l;n&&n.kind!==s.SymbolKind.Class;)n.kind===s.SymbolKind.Method&&n.static&&(d=!1),n=n.parent;if(n){if("this"===e)return{node:n,uri:c,ref:d,scope:n};if(n.extends){let e=q(this,n.extends.toLowerCase(),s.Position.create(0,0),s.SymbolKind.Class);if(e)return{node:e[0].node,uri:e[0].uri,ref:d,scope:n}}return}}if(!n&&this.declaration[e])return{node:this.declaration[e],uri:c}}else if(r=this.declaration[e])return{node:r,uri:c,scope:n}}else if(n===s.SymbolKind.Field){let n=t?this.searchScopedNode(t):void 0,i=(n||this).labels;if(i){":"===e.slice(-1)&&(e=e.slice(0,-1));let t=i[e];if(t&&t[0].def)return{node:t[0],uri:c,scope:n}}if(n)return null}}buildContext(e,t=!0,n=!1){var i;let o=s.SymbolKind.Null,r=this.document,a=this.tokens,{line:c,character:l}=e,d=r.getText(s.Range.create(c,0,c+1,0)).trimRight(),u="",f="",h=l;for(;--h>=0&&v(d.charCodeAt(h)););if(!n)for(;v(d.charCodeAt(l));)l++;let m=d.substring(++h,l),g=s.Range.create(c,h,c,l),y=r.offsetAt(g.start),b=a[y];if(t){let e=b?b.previous_token:a[y-1];if("."===(null==e?void 0:e.content)&&"TK_OPERATOR"!==e.type){let t="",n=e.offset,i=e,o=e.previous_token,s={")":0,"]":0,"}":0};for(;o;)switch(o.type){case"TK_DOT":i=o,o=o.previous_token;break;case"TK_WORD":i=o,(o=o.previous_token)&&"TK_DOT"!==o.type&&(o=void 0);break;case"TK_START_BLOCK":i=o,o=--s["}"]<0?void 0:o.previous_token;break;case"TK_START_EXPR":i=o,--s["["===o.content?"]":")"]<0?o=void 0:(o=o.previous_token)&&("TK_WORD"===o.type&&o.offset+o.length===i.offset||(o=void 0));break;case"TK_END_EXPR":case"TK_END_BLOCK":i=o,s[o.content]++,(o=a[o.previous_pair_pos])&&("}"!==o.content||o.data)?o.next_pair_pos=i.offset:(i=E,o=void 0);break;case"TK_OPERATOR":if(i=o,"%"===o.content){(o=a[o.previous_pair_pos])?o.next_pair_pos=i.offset:i=E;break}default:o=void 0}if((s[")"]>0||s["]"]>0||s["}"]>0)&&(i=E),"TK_WORD"===i.type||i.type.startsWith("TK_START_")||"%"===i.content&&i.next_pair_pos){let e=i;for(t=i.content,i=a[i.next_token_offset];i.offset<n;)switch(i.type){case"TK_DOT":t+=".",i=a[i.next_token_offset];break;case"TK_STRING":t+='""',i=a[i.next_token_offset];break;case"TK_START_BLOCK":t+=" {}",i=a[i.next_pair_pos];break;case"TK_START_EXPR":if(!i.prefix_is_whitespace){t+="["===i.content?"[]":"()",i=a[i.next_pair_pos],i=a[i.next_token_offset];break}default:t+=(i.prefix_is_whitespace?" ":"")+i.content,i=a[i.next_token_offset]}g.start=r.positionAt(e.offset)}else t="#any";m=t+"."+m}}if(b||"#"!==d.charAt(h-1)||(b=a[--y]),g.start.character>0&&(u=this.document.getText(s.Range.create(g.start.line,0,g.start.line,g.start.character)).trimLeft()),f=this.document.getText(s.Range.create(g.end.line,g.end.character,g.end.line+1,0)).trimRight(),b)if("TK_WORD"===b.type){let e,t=b.semantic,n=b.symbol;if(n)o=n.kind,o===s.SymbolKind.Class?m=n.full:o!==s.SymbolKind.Property&&o!==s.SymbolKind.Method||(m=(e=n).full.replace(/^\((\S+)\).*$/i,((...t)=>`${e.static?t[1]:t[1].replace(/([^.]+)$/,"@$1")}.${e.name}`)));else if(t)switch(t.type){case p.function:o=s.SymbolKind.Function;break;case p.method:o=s.SymbolKind.Method;break;case p.class:o=s.SymbolKind.Class;break;case p.property:o=s.SymbolKind.Property;break;case p.parameter:case p.variable:o=s.SymbolKind.Variable}else o="TK_DOT"===(null===(i=b.previous_token)||void 0===i?void 0:i.type)?s.SymbolKind.Property:s.SymbolKind.Variable}else"TK_LABEL"===b.type&&(o=s.SymbolKind.Field);return{text:m,range:g,kind:o,pre:u,suf:f,linetext:d,token:b}}getNodeAtPosition(e){let t=this.buildContext(e);if(t){let e=this.searchNode(t.text.toLowerCase(),t.range.end,t.kind);if(e)return e.node}}searchScopedNode(e,t){let n,i,{line:o,character:r}=e;t||(t=this.children);for(const a of t)if(!(o>a.range.end.line||o<a.selectionRange.start.line||o===a.selectionRange.start.line&&r<a.selectionRange.start.character||o===a.range.end.line&&r>a.range.end.character)){if(a.kind!==s.SymbolKind.Variable&&(n=a.children)){if(i=this.searchScopedNode(e,n))return i;if(e.line>a.selectionRange.start.line||e.character>a.selectionRange.end.character)return a}return}}getScopeChildren(e){let t,n=[],i={},o="";if(e){let r=e,a=r.kind===s.SymbolKind.Function&&r.static;for(const e in r.local)i[e]=r.local[e];for(const e in r.global)i[e]=null;for(const e in r.declaration)void 0===i[e]&&(i[e]=r.declaration[e]);if(t=r.parent,t&&t.kind===s.SymbolKind.Class&&r.kind===s.SymbolKind.Function)e=t;else{for(;t&&t.children&&(t.kind===s.SymbolKind.Function||t.kind===s.SymbolKind.Method||t.kind===s.SymbolKind.Property);){if(a){let e;for(const n in t.declaration)!(e=t.declaration[n])||!e.static&&null!==e.static||i[n]&&null!==i[n].static||(i[n]=e)}else{for(const e in t.local)void 0===i[e]&&(i[e]=t.local[e]);for(const e in t.global)void 0===i[e]&&(i[e]=null);for(const e in t.declaration)void 0===i[e]&&(i[e]=t.declaration[e])}e=t,t=t.parent}void 0===i[o=e.name.toLowerCase()]&&e.kind!==s.SymbolKind.Method&&e.kind!==s.SymbolKind.Property&&(i[o]=e)}return(e.kind===s.SymbolKind.Method||e.kind===s.SymbolKind.Property&&e.children)&&(e.parent?e=e.parent:n.push(s.DocumentSymbol.create("this",d.completionitem._this(),s.SymbolKind.Variable,s.Range.create(0,0,0,0),s.Range.create(0,0,0,0)))),(null==e?void 0:e.kind)===s.SymbolKind.Class&&(n.push(s.DocumentSymbol.create("this",d.completionitem._this(),s.SymbolKind.Variable,s.Range.create(0,0,0,0),s.Range.create(0,0,0,0))),e.extends&&n.push(s.DocumentSymbol.create("super",d.completionitem._super(),s.SymbolKind.Variable,s.Range.create(0,0,0,0),s.Range.create(0,0,0,0)))),n.concat(Object.values(i).filter((e=>!!e)))}for(const e of this.children)if(e.kind!==s.SymbolKind.Event){if(e.kind===s.SymbolKind.Variable||e.kind===s.SymbolKind.Class){if(i[o=e.name.toLowerCase()])continue;i[o]=!0}n.push(e)}return n}update_relevance(){var e;let t=this.uri,{list:n,main:i}=W(t),o=(null!==(e=u.lexers[i.toLowerCase()])&&void 0!==e?e:this).scriptdir;this.relevance=n,o!==this.scriptdir&&(this.initlibdirs(o),this.parseScript());for(let e in{...this.relevance,...this.include}){let n=u.lexers[e];!n||n.relevance&&n.relevance[t]||(n.relevance=W(e).list,n.scriptdir!==o&&(n.initlibdirs(o),n.parseScript()))}}initlibdirs(e){if(u.inBrowser)return;const t=(0,o.resolve)().toLowerCase();e?this.scriptdir=e:t!==this.scriptpath&&t!==r.argv0.toLowerCase()&&this.scriptpath.startsWith(t)&&!this.scriptpath.endsWith("\\lib")?(0,i.existsSync)(this.scriptpath+"\\lib")&&(0,i.statSync)(this.scriptpath+"\\lib").isDirectory()?this.scriptdir=this.scriptpath:this.scriptdir=t.replace(/\\lib$/,""):this.scriptdir=this.scriptpath.replace(/\\lib$/,""),this.libdirs=[this.scriptdir+"\\lib"];for(const e of u.libdirs)this.libdirs[0]!==e&&this.libdirs.push(e)}instrorcomm(e){var t;let n=this.document.offsetAt(e);return null===(t=this.strcommpos.find((e=>n>=e.start&&e.end>=n)))||void 0===t?void 0:t.type}colors(){let e=this.strcommpos,t=this.document,n=t.getText(),i=[];for(let o of e)if(2===o.type){let e,r=o.start,a=o.end,c=_.exec(n.substring(r,a)),l="";if(!c||!c[1]&&a-r+1!==c[2].length+2)continue;e=s.Range.create(t.positionAt(r+=c.index+(c[1]?c[1].length:0)),t.positionAt(r+c[2].length)),l=c[5]?k[c[5].toLowerCase()]:void 0===c[3]?c[2]:c[2].substring(2);let d={red:0,green:0,blue:0,alpha:1},u=["red","green","blue"];void 0!==c[4]&&u.unshift("alpha");for(const e of u)d[e]=parseInt("0x"+l.substring(0,2))/255,l=l.slice(2);i.push({range:e,color:d})}return i}addDiagnostic(e,t,n,i=s.DiagnosticSeverity.Error,o){let r=this.document.positionAt(t),a=r;void 0!==n&&(a=this.document.positionAt(t+n)),(o||this.diagnostics).push({range:s.Range.create(r,a),message:e,severity:i})}addFoldingRange(e,t,n="block"){let i=this.document.positionAt(e).line,o=this.document.positionAt(t).line-("block"===n?1:0);i<o&&this.foldingranges.push(s.FoldingRange.create(i,o,void 0,void 0,n))}addFoldingRangePos(e,t,n="block"){let i=e.line,o=t.line-("block"===n?1:0);i<o&&this.foldingranges.push(s.FoldingRange.create(i,o,void 0,void 0,n))}addSymbolFolding(e,t){let n=u.extsettings.SymbolFoldingFromOpenBrace?this.document.positionAt(t).line:e.range.start.line,i=e.range.end.line-1;n<i&&this.foldingranges.push(s.FoldingRange.create(n,i,void 0,void 0,"block"))}}function A(e,t,n=""){let r,s="";if(!e.startsWith("<")||!e.endsWith(">")){for(;r=e.match(/%a_(\w+)%/i);){let t=r[1];if(!u.pathenv[t])return;e=e.replace(r[0],u.pathenv[t])}return e.indexOf(":")<0&&(e=(0,o.resolve)(n,e)),s=c.URI.file(e).toString().toLowerCase(),{uri:s,path:e}}{if(!(e=e.slice(1,-1)))return;let n=[e+".ahk"];(r=e.match(/^((\w|[^\x00-\x7f])+)_.*/))&&n.push(r[1]+".ahk");for(const o of t)for(const t of n)if((0,i.existsSync)(e=o+"\\"+t))return s=c.URI.file(e).toString().toLowerCase(),{uri:s,path:e}}}function L(e,t,n=!0){if(t.kind!==s.SymbolKind.Class)return{};let i,o,r={},a=t.name.toLowerCase(),c=t,l={},d="object"===a||"comobjarray"===a||!t.extends&&"any"!==a;if(function e(t,n,i){var o,f,p,h;let m,g=n.uri;if(!l[m=`${g},${n.full}`.toLowerCase()]){if(l[m]=!0,i){if(!r.__new){let e=n.declaration.__new;e&&(r.__new=e,e.uri=g)}for(let e of Object.values(n.staticdeclaration))r[a=e.name.toLowerCase()]&&(e.kind!==s.SymbolKind.Class&&e.kind!==s.SymbolKind.Method||r[a].kind!==s.SymbolKind.Property)?"call"===a&&!1===r.call.def&&(r[a]=e,e.uri=g):(r[a]=e,e.uri=g);(null===(o=r.__new)||void 0===o?void 0:o.static)&&delete r.__new}else for(let e of Object.values(n.declaration))(!r[a=e.name.toLowerCase()]||!1===r[a].def&&!1!==e.def)&&(r[a]=e,e.uri=g);if((a=null===(f=n.extends)||void 0===f?void 0:f.toLowerCase())&&a!==(m=n.full.toLowerCase())){let n,o,l,f=a.split("."),g=m.split("."),y=-1;for(d||"object"!==a&&"comobjarray"!==a||(d=!0);f[y+1]===g[y+1];)y++;if(f.length>g.length&&y===g.length-1?y+1<f.length&&r[f[++y]]&&(n=[{node:r[f[y]],uri:r[f[y]].uri}],f.splice(0,y)):n=q(t,f[0],s.Position.create(0,0),s.SymbolKind.Class),n&&n.length&&(o=n[0].node).kind===s.SymbolKind.Class)for(null!==(p=c.checkmember)&&void 0!==p||(c.checkmember=o.checkmember),l=null!==(h=u.lexers[n[0].uri])&&void 0!==h?h:t,n[0].uri&&void 0===o.uri&&(o.uri=n[0].uri);o;){if(1===f.length){e(l,o,i);break}{let t=r;r={},e(l,o,!0),f.splice(0,1),(o=r[f[0]])&&o.kind!==s.SymbolKind.Class&&(o=void 0),r=t}}}else a||d||"any"===n.name.toLowerCase()||(d=!0)}}(e,t,n),n&&(d&&!r.call&&r.__new&&(o=Object.assign({},r.__new),o.name="Call",o.def=!1,r.call=o),(i=u.ahkvars.class)&&i!==t))for(a in i.staticdeclaration)r[a]||(r[a]=i.staticdeclaration[a],r[a].uri=i.uri);let f=["object","any"];d||n||(f.splice(0,1),t===u.ahkvars.comobject&&(f=[]));for(let e of f)if(i=u.ahkvars[e])for(a in i.declaration)r[a]&&!1!==r[a].def||(r[a]=i.declaration[a],r[a].uri=i.uri);return r}function N(e,t,n,i){let o=new P(a.TextDocument.create("","ahk2",-10,"_:="+t));D={},o.parseScript();let r=o.children.shift(),c=Object.keys((null==r?void 0:r.returntypes)||{}).pop();c&&j(e,c,n,o.document.getText(s.Range.create(r.selectionRange.end,r.range.end))).map((e=>{var t;return i[e]=null!==(t=D[e])&&void 0!==t&&t}))}function M(e,t,n){var i,o,r,a,c,d,f,p,h,m;let g=t.node.name.toLowerCase(),y=[],v={};if(g.match(/^[$@#]([\w.]|[^\x00-\x7f])+$/))return[g];if(g.startsWith("a_")){if("a_args"===g)return["#array"];if(l.builtin_variable.includes(g)||u.isahk2_h&&l.builtin_variable_h.includes(g))return["#string"]}if(t.scope){let e=t.scope;if(t.node.kind===s.SymbolKind.TypeParameter){let t=e;(null===(i=e=e.parent)||void 0===i?void 0:i.kind)===s.SymbolKind.Property&&(null===(o=e.parent)||void 0===o?void 0:o.kind)===s.SymbolKind.Class&&(t=e);let n=V(null!==(c=null===(a=null===(r=t.detail)||void 0===r?void 0:r.match(new RegExp(`^@(param|arg)\\s+{(.*?)}\\s+${g}\\b`,"mi")))||void 0===a?void 0:a[2])&&void 0!==c?c:"");if(n&&(n.map((e=>v[e]=!0)),!v["@object"]))return n}else y.push(t.node)}else{y.push(t.node);for(const t in e.relevance){let e=null===(f=null===(d=u.lexers[t])||void 0===d?void 0:d.declaration)||void 0===f?void 0:f[g];e&&y.push(e)}}for(let e of y){let t=I(e);if(t){if(t.map((e=>v[e]=!0)),v["@object"])break;return t}}let b=n?e.searchScopedNode(n):void 0,_=y[0];for(;b;)if(b.kind===s.SymbolKind.Class)b=b.parent;else{if(null===(p=b.declaration)||void 0===p?void 0:p[g])break;b=b.parent}!b&&n&&n!==t.node.selectionRange.end&&(b=e);for(const e of null!==(h=null==b?void 0:b.children)&&void 0!==h?h:[])if(g===e.name.toLowerCase()){if(e.kind!==s.SymbolKind.Variable&&e.kind!==s.SymbolKind.TypeParameter)return[g];if(n&&(e.selectionRange.end.line>n.line||e.selectionRange.end.line===n.line&&e.selectionRange.start.character>n.character))break;(e.ref||e.returntypes)&&(_=e)}if(_){if(_.ref){let t=F(e,_.selectionRange.start);if(t){let n=q(e,t.name,_.selectionRange.end,s.SymbolKind.Variable);if(n){let e=n[0].node;if(e===u.ahkvars.regexmatch){if(t.index=2)return["#regexmatchinfo"]}else if(u.ahkvars[t.name]===e)return["#number"]}}return[]}{let t=e.document.getText(s.Range.create(_.selectionRange.end,_.range.end));for(let n in _.returntypes)j(e,n.toLowerCase(),_.range.end,t).map((e=>v[e]=!0));if(!0===v["#object"]){let e=_.property;(null==e?void 0:e.length)&&(null!==(m=O["##object"])&&void 0!==m?m:O["##object"]=[]).push(...e)}}}return v["#any"]?[]:Object.keys(v)}function I(e,t=!1){var n,i,o;if(e.detail)return V(null!==(o=null===(i=null!==(n=e.detail.match(new RegExp(`^\\s*@${t?"prop(erty)?":"(var)"}\\s+{(.*?)}\\s+${e.name}\\b`,"mi")))&&void 0!==n?n:e.detail.match(/^\s*@(type)\s+{(.*?)}(?=\s|$)/im))||void 0===i?void 0:i[2])&&void 0!==o?o:"")}function j(e,t,n,i){if(t.includes("=>"))return[t.trim()];let o=`${t.trim()},${e.uri},${n.line},${n.character}`;return void 0!==O[o]?O[o]||[]:(O[o]=!1,O[o]=function e(t,n,i,o=0,a){var c,l,d;let f,p=[];for(n=n.replace(/#any(\(\)|\.(\w|[^\x00-\x7f])+)+/g,"#any").replace(/\b(true|false)\b/gi,"#number");(f=n.replace(/\(((\(\)|[^\(\)])+)\)/g,((...n)=>{let r=e(t,n[1],i,o+1);return r.length>1?`[${r.join(",")}]`:r.pop()||"#any"})))!==n;)n=f;for(;(f=n.replace(/\s(([$@#\w.]|[^\x00-\x7f]|\(\))+|\[[^\[\]]+\])\s*([+\-*/&|^]|\/\/|<<|>>|\*\*)\s*(([$@#\w.]|[^\x00-\x7f]|\(\))+|\[[^\[\]]+\])\s*/g," #number "))!==n;)n=f;for(;(f=n.replace(/\s[+-]?(([$@#\w.]|[^\x00-\x7f]|\(\))+|\[[^\[\]]+\])\s+(\.\s+)?[+-]?(([$@#\w.]|[^\x00-\x7f]|\(\))+|\[[^\[\]]+\])\s*/g," #string "))!==n;)n=f;for(;(f=n.replace(/\s(([$@#\w.]|[^\x00-\x7f]|\(\))+|\[[^\[\]]+\])\s*(~=|<|>|[<>]=|!?=?=|\b(is|in|contains)\b)\s*(([$@#\w.]|[^\x00-\x7f]|\(\))+|\[[^\[\]]+\])\s*/gi," #number "))!==n;)n=f;for(;(f=n.replace(/(not|!|~|\+|-)\s*(([$@#\w.]|[^\x00-\x7f]|\(\))+|\[[^\[\]]+\])/g," #number "))!==n;)n=f;for(;(f=n.replace(/(([$@#\w.]|[^\x00-\x7f]|\(\))+|\[[^\[\]]+\])\s*(\sand\s|\sor\s|&&|\|\||\?\?)\s*(([$@#\w.]|[^\x00-\x7f]|\(\))+|\[[^\[\]]+\])/gi,((...e)=>{let t,n={};for(let i=1;i<5;i+=3)(t=e[i].match(/^\[([^\[\]]+)\]$/))?t[1].split(",").map((e=>n[e]=!0)):n[e[i]]=!0;return n["#any"]?"#any":(n=Object.keys(n),n.length>1?`[${n.join(",")}]`:n.pop()||"#void")})))!==n;)n=f;for(;(f=n.replace(/(([$@#\w.]|[^\x00-\x7f]|\(\))+|\[[^\[\]]+\])\s*\?\s*(([$@#\w.]|[^\x00-\x7f]|\(\))+|\[[^\[\]]+\])\s*:\s*(([$@#\w.]|[^\x00-\x7f]|\(\))+|\[[^\[\]]+\])/,((...e)=>{let t,n={};for(let i=3;i<6;i+=2)(t=e[i].match(/^\[([^\[\]]+)\]$/))?t[1].split(",").map((e=>n[e]=!0)):n[e[i]]=!0;return n["#any"]?"#any":(n=Object.keys(n),n.length>1?`[${n.join(",")}]`:n.pop()||"#void")})))!==n;)n=f;if(0===o)for(;n!==(f=n.replace(/((\w|[$@#.]|[^\x00-\x7f])+)\(\)/,((...o)=>{let c,l=q(t,o[1],n.trim()===o[0]?{line:i.line,character:i.character-n.length}:i,s.SymbolKind.Variable),d="",f={};return l?(l.map((n=>{var o,l,p,h,m,g;let y=n.node,v=n.uri;e:switch(y.kind){case s.SymbolKind.Method:if(c=y.full.toLowerCase().match(/\(([^()]+)\)\s*([^()]+)/),c&&"gui"===c[1]){if("add"===c[2]){let e={dropdownlist:"ddl",tab2:"tab",tab3:"tab",picture:"pic"};(c=null==a?void 0:a.toLowerCase().match(/\.add\(\s*(('|")(\w+)\2)?/))&&(c[3]?f["gui.@"+(e[c[3]]||c[3])]=!0:f["gui.@tab"]=f["gui.@listview"]=f["gui.@treeview"]=f["gui.@statusbar"]=!0)}else for(const e in y.returntypes)f[e]=!0;break}case s.SymbolKind.Function:if(y===u.ahkvars.objbindmethod&&(c=null==a?void 0:a.toLowerCase().match(/objbindmethod\(\s*(([\w.]|[^\x00-\x7f])+)\s*,\s*('|")([^'"]+)\3\s*[,)]/)))f[c[1]+"."+c[4]]=!0;else if((v=y.uri||v)&&u.lexers[v]){let e=V(null!==(p=null===(l=null===(o=y.detail)||void 0===o?void 0:o.match(/^@returns?\s+{(.+?)}/im))||void 0===l?void 0:l[1])&&void 0!==p?p:""),t={};e&&(e.map((e=>t[e]=!0)),y.returntypes=t);for(const e in y.returntypes)j(u.lexers[v],e.toLowerCase(),s.Position.is(y.returntypes[e])?y.returntypes[e]:i).map((e=>{f[e]=!0}))}break;case s.SymbolKind.Variable:u.lexers[v]&&M(u.lexers[v],n,v===t.uri?i:n.node.selectionRange.end).map((t=>{var o,a;if(t.includes("=>")&&(null!==(o=D[t])&&void 0!==o||(D[t]=r(t,v,n.node,n.scope))),(y=null===(a=D[t])||void 0===a?void 0:a.node)&&(y.kind===s.SymbolKind.Class||y.kind===s.SymbolKind.Function||y.kind===s.SymbolKind.Method))for(const t in y.returntypes)e(u.lexers[v],t.toLowerCase(),s.Position.is(y.returntypes[t])?y.returntypes[t]:i).map((e=>{f[e]=!0}))}));break;case s.SymbolKind.Property:{let t={};if(null===(h=I(y,!0))||void 0===h?void 0:h.map((e=>t[e]=!0)));else if(u.lexers[v])for(d in y.returntypes)N(u.lexers[v],d,y.range.end,t);if(t["#any"])return"#any";for(const o in t)if(o.includes("=>")&&(null!==(m=D[o])&&void 0!==m||(D[o]=r(o,v,y,n.scope))),(y=null===(g=D[o])||void 0===g?void 0:g.node)&&(y.kind===s.SymbolKind.Class||y.kind===s.SymbolKind.Function||y.kind===s.SymbolKind.Method))for(const t in y.returntypes)e(u.lexers[v],t.toLowerCase(),s.Position.is(y.returntypes[t])?y.returntypes[t]:i).map((e=>f[e]=!0));break}case s.SymbolKind.Class:if((v=y.uri||v)&&u.lexers[v])for(const t of Object.values(L(u.lexers[v],y,!0)))if(!1!==t.def&&"call"===t.name.toLowerCase()){let n=t;for(const t in n.returntypes)e(u.lexers[v],t.toLowerCase(),s.Position.is(n.returntypes[t])?n.returntypes[t]:i).map((e=>{f[e]=!0}));if(n.returntypes)break e;break}(d=Object.keys(y.returntypes||{}).pop()||"")&&(f[d]=!0)}})),f["gui.@control"]?"[gui.@tab,gui.@listview,gui.@treeview,gui.@statusbar]":(f=Object.keys(f),f.length>1?`[${f.join(",")}]`:f.pop()||"#void")):"#void"})));)n=f;let h=n.trim(),m=[],g={};if(f=h.match(/^\[([^\[\]]+)\]$/)){let e={};f[1].split(",").map((t=>e[t]=!0)),p.map((t=>e[t]=!0)),m=Object.keys(e)}else m=[h];if(o)return m;n=n.trim();for(let o of m)if(f=o.match(/^([@#]?)(\$|\w|[^\x00-\x7f])+(\.[@#]?(\$|\w|[^\x00-\x7f])+)*$/)){let a,p="";if(f[1]&&!f[3]||D[o])g[o]=!0;else for(const f of q(t,o,o===n?{line:i.line,character:i.character-o.length}:i,s.SymbolKind.Variable)||[])switch(f.node.kind){case s.SymbolKind.TypeParameter:case s.SymbolKind.Variable:M(u.lexers[f.uri],f,f.uri===t.uri?i:f.node.selectionRange.end).map((e=>{var t;return e.includes("=>")&&(null!==(t=D[e])&&void 0!==t||(D[e]=r(e,f.uri,f.node,f.scope))),g[e]=!0}));break;case s.SymbolKind.Property:if(a=I(f.node,!0))a.map((e=>{var t;return e.includes("=>")&&(null!==(t=D[e])&&void 0!==t||(D[e]=r(e,f.uri,f.node,f.scope))),g[e]=!0}));else if(f.node.returntypes)for(let n in f.node.returntypes)if(" #object"===n){g["#object"]=!0;let e=f.node.property;(null==e?void 0:e.length)&&(null!==(c=O["##object"])&&void 0!==c?c:O["##object"]=[]).push(...e)}else n&&e(null!==(l=u.lexers[f.uri])&&void 0!==l?l:t,n,f.node.range.end).map((e=>{var t;return e.includes("=>")&&(null!==(t=D[e])&&void 0!==t||(D[e]=r(e,f.uri,f.node,f.scope))),g[e]=!0}));else if(f.node.children)for(const n of f.node.children){let o=n.returntypes;if("get"===n.name.toLowerCase()&&n.kind===s.SymbolKind.Function){for(const n in o)e(null!==(d=u.lexers[f.uri])&&void 0!==d?d:t,n.toLowerCase(),s.Position.is(o[n])?o[n]:i).map((e=>{var t;return e.includes("=>")&&(null!==(t=D[e])&&void 0!==t||(D[e]=r(e,f.uri,f.node,f.scope))),g[e]=!0}));break}}break;case s.SymbolKind.Object:o.endsWith(".prototype")?g["@"+o.slice(0,-10)]=!0:(g["#object"]=!0,D[o]=f);break;case s.SymbolKind.Function:g[p=o.startsWith("$")?o:f.node.name.toLowerCase()]=!0,D[p]=f;break;case s.SymbolKind.Method:a=f.node.full.match(/^\(([^()]+)\)/),p=((a?a[1]+".":"")+f.node.name).toLowerCase(),g[p]=!0,D[p]=f;break;case s.SymbolKind.Class:g[o=(f.ref?"@":"")+o]=!0,D[o]=f}}return g=Object.keys(g),g.length?g:["#any"]}(e,t,n,0,i));function r(e,t,n,i){var o,r,c;e.startsWith("((")&&(e=e.slice(1,-1));let l=e.match(/^\(([^)]*)\)=>(.*)$/);if(l){let e=new P(a.TextDocument.create("","ahk2",0,`${n.name}(${l[1]})=>${l[2].includes("=>")?"void":l[2]}`),void 0,-1);e.parseScript();let d=e.declaration[n.name.toLowerCase()];if((null==d?void 0:d.kind)===s.SymbolKind.Function){if(l[2].includes("=>")&&(d.returntypes={[l[2]]:!0}),n.kind===s.SymbolKind.TypeParameter&&i){let e=i.parent;(null===(o=null==e?void 0:e.parent)||void 0===o?void 0:o.kind)===s.SymbolKind.Property&&(null===(r=e.parent.parent)||void 0===r?void 0:r.kind)===s.SymbolKind.Class&&(i=e.parent),$(i)}else $(n);let e=null===(c=n.detail)||void 0===c?void 0:c.split("\n___\n").pop();return e&&(d.detail=e.trim()),{node:d,uri:t}}}}}function q(e,t,n,o,r=!0){var a,l,d,f,p;let h,m,y,v=e.uri;if(o===s.SymbolKind.Method||o===s.SymbolKind.Property||t.includes(".")){let i=t.split("."),c=q(e,i[0],n,s.SymbolKind.Class),f=0,p=0;if(!c||i.length<2)return;let{node:m,uri:b}=c[0];if(v=b||v,c[0].ref&&i[0].match(/^[^@#]/)&&(i[0]="@"+i[0]),m.kind===s.SymbolKind.Variable){let r=M(u.lexers[v],c[0],e.uri===b?n:m.selectionRange.end),s=[];for(const e of r)null===(a=q(u.lexers[v],t.replace(new RegExp("^"+i[0]),e),e.match(/^[@#]/)?void 0:n,o))||void 0===a||a.map((e=>{s.map((e=>e.node)).includes(e.node)||s.push(e)}));return s.length?s:void 0}if(p=i.length-1){let t,n;for(;f<p;){if(h=void 0,f++,m.kind===s.SymbolKind.Function||m.kind===s.SymbolKind.Method){if(n=m,f<=i.length&&"call"===i[f]){h=m;continue}u.ahkvars.func&&(m=u.ahkvars.func,i[f-1]="@"+i[f-1].replace(/^[@#]/,""))}else if(m.kind===s.SymbolKind.Property||m.kind===s.SymbolKind.Variable){if(y=m.returntypes){let e={},t=Object.keys(y).pop(),n=[];if(t){N(u.lexers[m.uri||v],t,s.Position.is(y[t])?y[t]:m.selectionRange.end,e);let r=i.slice(f).join(".");for(const t in e)null===(l=q(u.lexers[v],t+"."+r,void 0,o))||void 0===l||l.map((e=>{n.map((e=>e.node)).includes(e.node)||n.push(e)}));return n.length?n:void 0}}}else m.kind===s.SymbolKind.Object&&m.static&&"prototype"===m.name.toLowerCase()&&(i[f-1]="@prototype",t&&(m=t));if(m.kind===s.SymbolKind.Class){t=m,b&&!m.uri&&(m.uri=b);let o,a=r&&f>0&&!i[f-1].match(/^[@#]/),c=i[f].replace(/[@#]/,""),l=L(e,m,a);if(f===p?((o=l[c])&&(h=o,v=o.uri||"","prototype"===c&&(h=Object.assign({},o),h.kind=s.SymbolKind.Object)),!h&&"clone"!==c&&(o=l.__call)&&(h=o,v=o.uri||"")):(o=l[c])&&(h=o,v=o.uri||""),"clone"===c){let e=null===(d=h)||void 0===d?void 0:d.full.toLowerCase().match(/^\(([^()]+)\)\s+/),t=m.full.toLowerCase();if(!e||e[1]!==t&&u.ahkvars[e[1]]){let e=s.Range.create(0,0,0,0);v="",h=g.create("Clone",s.SymbolKind.Method,e,e,[],[],!0),h.returntypes={[a?t:t.replace(/([^.]+)$/,"@$1")]:!0}}}else if(h&&"bind"===c&&n&&h.full.match(/\(func\)\s+bind\(/i)){let e=Object.assign({},h),t=n.full.match(/^\s*\(([^()]+)\)/);e.returntypes={[((t?t[1]+".":"")+n.name).toLowerCase()]:!0},h=e}n=void 0}if(!h)break;m=h}}return h?[{node:h,uri:v}]:void 0}if(!(m=e.searchNode(t=t.replace(/^@/,""),n,o))){if(null===m)return;if(!1===m)return null;m=b(null!==(f=e.relevance)&&void 0!==f?f:{},t)}if(m){if(m.node.kind===s.SymbolKind.Variable&&m.node===e.declaration[t]){let n=b(null!==(p=e.relevance)&&void 0!==p?p:{},t);n&&(n.node.kind!==s.SymbolKind.Variable||n.node.def)&&(m=n)}if(m.fn_is_static){let n=m.node,i=m.uri;for(const o in e.relevance)if(y=u.lexers[o].declaration[t]){if(y.kind!==s.SymbolKind.Variable)return[{node:y,uri:o}];n.def||(n=y,i=o)}m.node=n,m.uri=i}}return o===s.SymbolKind.Field||m&&(m.node.kind!==s.SymbolKind.Variable||m.node.def)||!(y=u.ahkvars[t.replace(/^[@#]/,"")])?m?[m]:void 0:[{uri:y.uri,node:y}];function b(e,t){let n;for(const r in e){let e=u.lexers[r];if(!e){let t=c.URI.parse(r).fsPath;if(!(0,i.existsSync)(t))continue;{let n=(0,u.openFile)(t);if(!n)continue;e=u.lexers[r]=new P(n),e.parseScript()}}let a=e.searchNode(t,void 0,o);if(a){if(a.node.kind!==s.SymbolKind.Variable)return a;n&&!a.node.def||(n=a)}}return n}}function F(e,t){var n,i;let o,r,a,c=e.document.offsetAt(t),l={start:0,end:0},d={line:0,character:0},u=e.searchScopedNode(t),f="",p="",h="",m=-1,g=0,y=c,v=0;if(u){for(;u&&!u.funccall;)u=u.parent;r=null!==(i=null===(n=u)||void 0===n?void 0:n.funccall)&&void 0!==i?i:e.funccall}else r=e.funccall;for(const n of r){const i=e.document.offsetAt(n.range.start),r=e.document.offsetAt(n.range.end);if(i+n.name.length<c){if(c>r){if(n.range.end.line!==t.line||e.document.getText({start:n.range.end,end:t}).trim())continue}else if(c===r&&")"===e.document.getText(s.Range.create({line:t.line,character:t.character-1},t)))continue;(!o||l.start<=i&&r<=l.end)&&(o=n,l={start:i,end:r},d=n.range.start)}}if(o&&o.paraminfo){if(m=c>l.start+o.name.length?0:-1,-1!==m)for(let e of o.paraminfo.comma){if(!(c>e))break;++m}return{name:o.name.toLowerCase(),pos:d,index:m,full:f}}if(!o||-1!==e.document.getText(o.range).indexOf(")(")){let n=e.document.getText(s.Range.create(t.line,0,t.line+1,0));for(;a=n.match(/('|").*?(?<!`)\1/);)n=n.replace(a[0],"".repeat(a[0].length));let i=n.match(/^(.*\(\s*(([\w.]|[^\x00-\x7f])+)\s*\))\((.*)\)/);if(i&&(c=t.character-i[1].length)>0){let e=0,n=0,o=0,r=0;e:for(const t of i[4].split(""))switch(r++,t){case"(":e++;break;case")":if(--e<0)break e;break;case"[":n++;break;case"]":n--;break;case"{":o++;break;case"}":o--}0===n&&0===o&&e<=0&&t.character<i[1].length+r+(0===e?2:1)&&(d.line=t.line,d.character=c,p=i[2]+"("+i[4].substring(0,r)+(0===e?")":""),h=f=i[2].toLowerCase(),g=p.length-h.length,c+=h.length,h=h.split(".").pop()||"",h===f&&(f=""))}}if(h);else{if(!o)return;p=e.document.getText(o.range),h=o.name.toLowerCase(),f="",c=y-l.start,m=-1,g=l.end-l.start-h.length,v=e.document.offsetAt(o.range.start)}for(;-1!==(a=p.search(/['"]/));){let t;if(!(t=e.tokens[v+a])||"TK_STRING"!==t.type)break;p=p.substring(0,a)+"_".repeat(t.length)+p.substring(a+t.length)}for(const e of[["\\{","\\}"],["\\[","\\]"],["\\(","\\)"]]){const t=new RegExp(e[0]+"[^"+e[0]+"]*?"+e[1]);for(;(a=t.exec(p))&&!(a[0].length>=g);)p=p.replace(a[0],"_".repeat(a[0].length))}c>h.length&&(m+=1);for(let e=h.length+1;e<c;e++)if(","===p.charAt(e))m++;else if(")"===p.charAt(e)&&e>=p.length-1){m=-1;break}return{name:h,pos:d,index:m,full:f}}function W(e){var t,n,i;let o,r={},s=0,a=!1,l={list:r,count:s,main:""};for(const t in u.lexers)r={},s=0,a=t===e,d(u.lexers[t].include,t),a&&s>l.count&&(l={list:r,count:s,main:t});return l.count&&(delete l.list[e],l.main&&l.main!==e&&(null!==(t=(n=l.list)[i=l.main])&&void 0!==t||(n[i]=c.URI.parse(l.main).fsPath))),l;function d(t,n){for(const i in t)e===i&&(a=!0,r[n]||(r[n]=c.URI.parse(n).fsPath,s++)),!r[i]&&(o=u.lexers[i])&&(r[i]=t[i],s++,n!==i&&d(o.include,i))}}function $(e,t,n){var i,o,r;let s,a,c={},l=[],d="",u=e.detail,f=null!=n?n:[],p=0;return u?(u.split(/\r?\n/).map((n=>{if(n.startsWith("@"))if(d="",p&&(2===p&&l.push("```"),p=0),s=n.match(/^@(\S+)(.*)$/))switch(s[1].toLowerCase()){case"param":case"arg":s[2].replace(/^\s*({(.*?)}\s+)?(\[.*?\]|\S+)(.*)$/,((...e)=>{var n,i;let o=e[4].replace(/^\s*[-]\s*|\s*$/g,"");return e[3].startsWith("[")&&(e[3]=e[3].substring(1).replace(/\W.*$/,"")),a=`\`${e[3]}\`${e[2]?`: *${e[2]}*`:""}`+(o?"  "+o:""),null!=t||l.push(`\n*@param* ${a}`),(null!==(n=c[i=d=e[3].toLowerCase()])&&void 0!==n?n:c[i]=[]).push(a),c[d].types=e[2],""}));break;case"overload":f.push("_"+s[2].trim());break;case"example":if(a=s[2].replace(/\s*<caption>(.*?)<\/caption>\s*/,((...e)=>(l.push("\n*@example* "+e[1]),""))),p=1,a===s[2]&&(a=s[2].replace(/\s*<caption>(.*)/,((...e)=>(l.push("\n*@example* "+e[1]),""))),a!==s[2]))break;l.push("```ahk2"+(a?"\n"+a:"")),p=2;break;case"var":case"prop":case"property":a=s[2].replace(/^\s*({(.*?)}\s+)?(\S+)(\s*[-])?\s*/,((...e)=>e[2]?`\`${e[3]}\`: *${e[2]}*  `:e[3]+"  ")).replace(/\s*\s*$/,""),l.push(`\n*@${s[1].toLowerCase()}* ${a}`);break;case"return":case"returns":s[2].replace(/^\s*{(.+?)}/,((...t)=>{let n={},i=V(t[1]);return i&&(i.map((e=>n[e]=!0)),e.returntypes=n),""}));default:a=s[2].replace(/^\s*({(.*?)}(?=\s|$))?(\s*[-])?\s*/,"*$2*  ").replace(/\*\*(?=  )|\s*\s*$/g,""),l.push(`\n*@${s[1].toLowerCase()}* ${a}`)}else l.push(n);else d?(c[d].push(n),null!=t||l.push(n)):1===p&&(a=n.indexOf("</caption>"))>-1?(l.push(n.substring(0,a),"```ahk2"+((a=n.substring(a+10).trimLeft())?"\n"+a:"")),p=2):l.push(n)})),2===p&&l.push("```"),null===(i=e.params)||void 0===i||i.map((e=>{var t;let n=c[e.name.toLowerCase()];if(n){n.length&&(n[0]="*@param* "+n[0],e.detail=n.join("\n").replace(/  ?/,"\n___\n").replace(/(?<!\\)\\@/g,"\n@"));let i={},o=V(null!==(t=n.types)&&void 0!==t?t:"");o&&(e.returntypes=i,o.map((e=>i[e]=!0)))}})),void 0!==t?(a=null!==(r=null===(o=c[t.toLowerCase()])||void 0===o?void 0:o.join("\n"))&&void 0!==r?r:"",u=a+"\n\n"+l.join("\n")):u=!n&&f.length?"*@overload*\n```ahk2\n"+f.join("\n")+"\n```\n"+(l.length?"___\n"+l.join("\n"):""):l.join("\n"),u):""}function U(e,t){if(e.kind===t.kind)return e.kind===s.SymbolKind.Class?d.diagnostic.conflictserr("class","Class",e.name):e.kind===s.SymbolKind.Function?d.diagnostic.conflictserr("function","Func",e.name):d.diagnostic.dupdeclaration();switch(t.kind){case s.SymbolKind.Variable:return d.diagnostic.assignerr(e.kind===s.SymbolKind.Function?"Func":"Class",e.name);case s.SymbolKind.Function:return e.kind===s.SymbolKind.Variable?d.diagnostic.funcassignerr():d.diagnostic.conflictserr("function","Class",e.name);case s.SymbolKind.Class:return e.kind===s.SymbolKind.Function?d.diagnostic.conflictserr("class","Func",e.name):e.kind===s.SymbolKind.Property||e.kind===s.SymbolKind.Method?d.diagnostic.dupdeclaration():d.diagnostic.assignerr("Class",e.name);case s.SymbolKind.Property:case s.SymbolKind.Method:return d.diagnostic.dupdeclaration()}return""}function B(e,t,n){let i="";for(const o of t)if(o.name)switch(o.kind){case s.SymbolKind.Class:case s.SymbolKind.Function:case s.SymbolKind.Variable:if(e[i=o.name.toLowerCase()])if(e[i].infunc){if(o.kind===s.SymbolKind.Variable){if(o.def&&e[i].kind!==s.SymbolKind.Variable){n.push({message:d.diagnostic.assignerr(e[i].kind===s.SymbolKind.Function?"Func":"Class",o.name),range:o.selectionRange,severity:s.DiagnosticSeverity.Error});continue}}else if(e[i].def)n.push({message:d.diagnostic.assignerr(o.kind===s.SymbolKind.Function?"Func":"Class",o.name),range:e[i].selectionRange,severity:s.DiagnosticSeverity.Error});else if(e[i].kind===s.SymbolKind.Function){n.push({message:U(e[i],o),range:o.selectionRange,severity:s.DiagnosticSeverity.Error});continue}e[i]=o}else o.kind===s.SymbolKind.Variable?e[i].kind===s.SymbolKind.Variable?o.def&&!e[i].def&&(e[i]=o):o.def&&(delete o.def,n.push({message:U(e[i],o),range:o.selectionRange,severity:s.DiagnosticSeverity.Error})):e[i].kind===s.SymbolKind.Variable?(e[i].def&&(delete e[i].def,n.push({message:U(o,e[i]),range:e[i].selectionRange,severity:s.DiagnosticSeverity.Error})),e[i]=o):!1!==e[i].def&&n.push({message:U(e[i],o),range:o.selectionRange,severity:s.DiagnosticSeverity.Error});else e[i]=o}}function V(e){if(e=e.replace(/\s/g,"")){let t,n={};for(;(t=e.replace(/\(([^)]*)\)(?!\s*=>)/g,"$1"))!==e;)e=t;e.toLowerCase().split(/(?<!=>\s*[^)]*)\|/).map((e=>n["void"===e?"#void":e.includes("=>")?e:e.replace(/(?<=(^|\.))([^.$@#]+)$/,"@$2").replace("$","")]=!0)),delete n[""];let i=Object.keys(n);if(i.length)return i}}t.Lexer=P,t.pathanalyze=A,t.parseinclude=function e(t,n){for(const o in t){let r=t[o];if(!u.lexers[o]&&(0,i.existsSync)(r)){let t=(0,u.openFile)(r);if(!t)continue;let i=new P(t,n);u.lexers[o]=i,i.parseScript(),e(i.include,n),i.relevance=W(o).list}}},t.getClassMembers=L,t.cleardetectcache=function(){O={}},t.getcacheproperty=function(){var e;return null!==(e=O["##object"])&&void 0!==e?e:[]},t.detectExpType=N,t.detectVariableType=M,t.detectExp=j,t.searchNode=q,t.getFuncCallInfo=F,t.getincludetable=W,t.formatMarkdowndetail=$,t.samenameerr=U,t.checksamenameerr=B,t.update_commentTags=function(e){try{b=new RegExp(e,"i")}catch(e){throw b=new RegExp("^;;\\s*(?<tag>.*)"),e}}},701:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.searchAndOpenPEFile=t.getFileVersion=t.PEFile=t.RESOURCE_TYPE=t.DIRECTORY_ENTRY=void 0;const i=n(7147);var o,r;!function(e){e[e.IMAGE_DIRECTORY_ENTRY_EXPORT=0]="IMAGE_DIRECTORY_ENTRY_EXPORT",e[e.IMAGE_DIRECTORY_ENTRY_IMPORT=1]="IMAGE_DIRECTORY_ENTRY_IMPORT",e[e.IMAGE_DIRECTORY_ENTRY_RESOURCE=2]="IMAGE_DIRECTORY_ENTRY_RESOURCE",e[e.IMAGE_DIRECTORY_ENTRY_EXCEPTION=3]="IMAGE_DIRECTORY_ENTRY_EXCEPTION",e[e.IMAGE_DIRECTORY_ENTRY_SECURITY=4]="IMAGE_DIRECTORY_ENTRY_SECURITY",e[e.IMAGE_DIRECTORY_ENTRY_BASERELOC=5]="IMAGE_DIRECTORY_ENTRY_BASERELOC",e[e.IMAGE_DIRECTORY_ENTRY_DEBUG=6]="IMAGE_DIRECTORY_ENTRY_DEBUG",e[e.IMAGE_DIRECTORY_ENTRY_COPYRIGHT=7]="IMAGE_DIRECTORY_ENTRY_COPYRIGHT",e[e.IMAGE_DIRECTORY_ENTRY_GLOBALPTR=8]="IMAGE_DIRECTORY_ENTRY_GLOBALPTR",e[e.IMAGE_DIRECTORY_ENTRY_TLS=9]="IMAGE_DIRECTORY_ENTRY_TLS",e[e.IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG=10]="IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG",e[e.IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT=11]="IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT",e[e.IMAGE_DIRECTORY_ENTRY_IAT=12]="IMAGE_DIRECTORY_ENTRY_IAT",e[e.IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT=13]="IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT",e[e.IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR=14]="IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR",e[e.IMAGE_DIRECTORY_ENTRY_RESERVED=15]="IMAGE_DIRECTORY_ENTRY_RESERVED"}(o=t.DIRECTORY_ENTRY||(t.DIRECTORY_ENTRY={})),function(e){e[e.CURSOR=1]="CURSOR",e[e.BITMAP=2]="BITMAP",e[e.ICON=3]="ICON",e[e.MENU=4]="MENU",e[e.DIALOG=5]="DIALOG",e[e.STRING=6]="STRING",e[e.FONTDIR=7]="FONTDIR",e[e.FONT=8]="FONT",e[e.ACCELERATOR=9]="ACCELERATOR",e[e.RCDATA=10]="RCDATA",e[e.MESSAGETABLE=11]="MESSAGETABLE",e[e.GROUP_CURSOR=12]="GROUP_CURSOR",e[e.GROUP_ICON=14]="GROUP_ICON",e[e.VERSION=16]="VERSION",e[e.DLGINCLUDE=17]="DLGINCLUDE",e[e.PLUGPLAY=19]="PLUGPLAY",e[e.VXD=20]="VXD",e[e.ANICURSOR=21]="ANICURSOR",e[e.ANIICON=22]="ANIICON",e[e.HTML=23]="HTML",e[e.MANIFEST=24]="MANIFEST"}(r=t.RESOURCE_TYPE||(t.RESOURCE_TYPE={}));class s{constructor(e){this.isBit64=!1,this.resource={},this.directoryEntry=[];let t=Buffer.alloc(8),n=(0,i.openSync)(e,"r"),o=h(60);if(23117!==p())throw(0,i.closeSync)(n),Error("no MS-DOS stub");if(17744!==h(o))throw(0,i.closeSync)(n),Error("no PE file");let r=p(o+20),s=o+24;this.isBit64=523===function(e=0){return(0,i.readSync)(n,t,0,2,e),t.readInt16LE(0)}(s);let a=h(s+(this.isBit64?108:92)),c=p(o+6),l=h(s+56),d=s+(this.isBit64?112:96),u=0,f=Buffer.alloc(40*c);(0,i.readSync)(n,f,0,f.length,s+r),this.imageData=Buffer.alloc(l);for(let e=0;e<c;e++){let e=f.readUInt32LE(u+12),t=f.readUInt32LE(u+16),o=f.readUInt32LE(u+20);(0,i.readSync)(n,this.imageData,e,t,o),u+=40}for(let e=0;e<a;e++)(0,i.readSync)(n,t,0,8,d+8*e),this.directoryEntry.push({addr:t.readUInt32LE(0),size:t.readUInt32LE(4)});function p(e=0){return(0,i.readSync)(n,t,0,2,e),t.readUInt16LE(0)}function h(e=0){return(0,i.readSync)(n,t,0,4,e),t.readUInt32LE(0)}(0,i.closeSync)(n)}getAscii(e){return this.imageData.slice(e,this.imageData.indexOf(Buffer.alloc(1),e)).toString("ascii")}getExport(){const e=this.imageData,t=this.directoryEntry[o.IMAGE_DIRECTORY_ENTRY_EXPORT];if(!(null==t?void 0:t.addr))return;if(t.data)return t.data;const n=t.addr,i=n+t.size;let r=e.readUInt32LE(n+12),s=e.readUInt32LE(n+16),a=e.readUInt32LE(n+20),c=e.readUInt32LE(n+24),l=e.readUInt32LE(n+28),d=e.readUInt32LE(n+32),u=e.readUInt32LE(n+36);const f={Module:this.getAscii(r),Functions:[],OrdinalBase:s},p={};for(let t=0;t<c;t++){let t=e.readUInt32LE(d),o=e.readUInt16LE(u),r=e.readUInt32LE(l+4*o);d+=4,u+=2,p[o]=!0;let a=r>n&&r<i?this.getAscii(r):"0x"+(r+4294967296).toString(16).substring(1);f.Functions.push({Name:this.getAscii(t),EntryPoint:a,Ordinal:s+o})}for(let t=0;c<a;t++,c++){for(;p[t];)t++;let o=e.readUInt32LE(l+4*t),r=o>n&&o<i?this.getAscii(o):"0x"+(o+4294967296).toString(16).substring(1);p[t]=!0,f.Functions.splice(t,0,{Name:"",EntryPoint:r,Ordinal:s+t})}return t.data=f}getImport(){const e=this.imageData,t=this.directoryEntry[o.IMAGE_DIRECTORY_ENTRY_IMPORT];if(!(null==t?void 0:t.addr))return;if(t.data)return t.data;const n=t.addr;let i,r,s,a=e.readInt32LE(n+12),c=e.readInt32LE(n+16),l=4,d=n;this.isBit64?(l=8,r=BigInt(65535),s=BigInt("0x8000000000000000"),i=e.readBigUInt64LE.bind(e)):(r=65535,s=2147483648,i=e.readUInt32LE.bind(e));const u={};for(;c;){let t,n=u[this.getAscii(a)]=[];for(let e=0;t=i(c+e*l);e++)n.push(t&s?"Ordinal#"+(t&r):this.getAscii(Number(t)+2));d+=20,a=e.readUInt32LE(d+12),c=e.readUInt32LE(d+16)}return t.data=u}getResource(...e){var t;const n=this.imageData,i=this.directoryEntry[o.IMAGE_DIRECTORY_ENTRY_RESOURCE];if(!(null==i?void 0:i.addr))return;if(1===e.length&&this.resource[e[0]])return this.resource[e[0]];const s=i.addr,a=[s],c={};return e.map((e=>{var t,n;return null!==(t=(n=this.resource)[e])&&void 0!==t?t:n[e]=c[e]=[]})),c[t=r.RCDATA]&&(c[t]=this.resource[r.RCDATA]={}),function e(t,i=0){var o,d,u,f,p,h,m,g,y;const v={NumberOfNamedEntries:n.readUInt16LE(t+12),NumberOfIdEntries:n.readUInt16LE(t+14)},b=[],_=v.NumberOfIdEntries+v.NumberOfNamedEntries;t+=16;for(let v=0;v<_;v++,t+=8){let v=n.readUInt32LE(t);if(0===i&&!c[65535&v])continue;let _,T,R=n.readUInt32LE(t+4),w={name:v,id:65535&v,pad:4294901760&v,nameOffset:2147483647&v,offsetToData:R,dataIsDirectory:Boolean((2147483648&R)>>31),offsetToDirectory:2147483647&R};if((2147483648&v)>>31){const e=s+w.nameOffset,t=n.readUInt16LE(e);_=n.slice(e+2,2*t+e+2).toString("utf16le")}else T=v;if(w.dataIsDirectory){if(a.includes(s+w.offsetToDirectory))break;a.push(s+w.offsetToDirectory);let t=e(s+w.offsetToDirectory,i+1);if(void 0===t)break;b.push({struct:w,id:T,name:_,directory:t})}else{let e=s+w.offsetToDirectory,t={struct:{offsetToData:n.readUInt32LE(e),size:n.readUInt32LE(e+4),codePage:n.readUInt32LE(e+8),reserved:n.readUInt32LE(e+12)},lang:1023&w.name,subLang:w.name>>10};b.push({struct:w,id:T,name:_,data:t})}if(0===i){const e=b[b.length-1];if(w.id===r.VERSION){const t=null!==(u=null===(d=null===(o=e.directory)||void 0===o?void 0:o.entries[0].directory)||void 0===d?void 0:d.entries)&&void 0!==u?u:[];for(const e of t){const t=null===(f=e.data)||void 0===f?void 0:f.struct;t&&l(c[16],t)}}else if(w.id===r.MANIFEST){const t=null!==(m=null===(h=null===(p=e.directory)||void 0===p?void 0:p.entries[0].directory)||void 0===h?void 0:h.entries)&&void 0!==m?m:[];for(const e of t){const t=null===(g=e.data)||void 0===g?void 0:g.struct;(null==t?void 0:t.size)&&c[24].push((k=t,n.slice(k.offsetToData,k.offsetToData+k.size).toString()))}}else if(w.id===r.RCDATA){c[10]instanceof Array&&(c[10]={});let t=c[10];null===(y=e.directory)||void 0===y||y.entries.map((e=>{var i,o,r,s,a;const c=null!==(i=e.name)&&void 0!==i?i:`#${e.id}`,l=null===(a=null===(s=null===(r=null===(o=e.directory)||void 0===o?void 0:o.entries)||void 0===r?void 0:r.pop())||void 0===s?void 0:s.data)||void 0===a?void 0:a.struct;l&&(t[c.toLowerCase()]=n.slice(l.offsetToData,l.offsetToData+l.size))}))}}}var k;return{struct:v,entries:b}}(s),e.map((e=>{var t;return null!==(t=c[e])&&void 0!==t?t:c[e]=this.resource[e]})),1===e.length?c[e[0]]:c;function l(e,t){let i=0,o=0,r=t.offsetToData;const s=n.slice(r,r+t.size);f(o),o=d(2+i,r),s.readUInt32LE(o),s.readUInt32LE(o+4);const a=s.readUInt32LE(o+8),c=s.readUInt32LE(o+12),l=(s.readUInt32LE(o+16),s.readUInt32LE(o+20),s.readUInt32LE(o+24),s.readUInt32LE(o+28),s.readUInt32LE(o+32),s.readUInt32LE(o+36),s.readUInt32LE(o+40),s.readUInt32LE(o+44),s.readUInt32LE(o+48),{StringTable:[],Version:[a>>16,65535&a,c>>16,65535&c].join(".")});e.push(l),o=d(o+52,r);let u=f(o);if("StringFileInfo"===u.Key&&[0,1].includes(u.Type)&&0===u.ValueLength){let e=d(2+i,r);for(;;){const t=f(e),n={};for(l.StringTable.push(n),o=d(2+i,r);o<e+t.Length;){let s=o,a=f(o);o=d(2+i,r);let c=f(o,!1);o=0===a.Length?e+t.Length:d(s+a.Length,r),n[a.Key]=c.Key}if(o=d(t.Length+e,r),o===e||o>=u.Length)break;e=o}}function f(e,t=!0){let n={};return t&&(n={Length:s.readUInt16LE(e),ValueLength:s.readUInt16LE(e+2),Type:s.readUInt16LE(e+4)},e+=6),i=2*(s.indexOf(Buffer.alloc(2),e)+1>>1),{...n,Key:s.slice(e,i).toString("utf16le")}}}function d(e,t){return(e+t+3&4294967292)-(4294967292&t)}}}t.PEFile=s,t.getFileVersion=function(e){return new s(e).getResource(r.VERSION)},t.searchAndOpenPEFile=function(e,t){var n;let o,r,a="",c=[""];for(;;)try{if(o=new s(e),a&&"boolean"==typeof t&&o.isBit64!==t)throw Error();return o}catch(o){if(o instanceof Error||-4058===o.errno){if(!r){if(e.includes(":")||!(r=null===(n=process.env.Path)||void 0===n?void 0:n.split(";")))return;!1===t&&r.unshift("C:\\Windows\\SysWOW64\\"),a=e,a.toLowerCase().endsWith(".dll")||c.push(".dll")}let o;e:for(;void 0!==(o=r.pop());)for(let t of c)if(o&&(0,i.existsSync)(e=(o.endsWith("/")||o.endsWith("\\")?o:o+"\\")+a+t))break e;if(!o)return}}}},6487:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.codeActionProvider=void 0;const i=n(7147),o=n(2374),r=n(7994),s=n(3939);t.codeActionProvider=async function(e){let t,n=s.lexers[e.textDocument.uri.toLowerCase()],a=n.diagnostics,c=new RegExp(r.diagnostic.filenotexist().replace("{0}","(.+?)\\*(\\.\\w+)")),l="";for(const d of a)if(t=c.exec(d.message)){l=n.document.getText(d.range);let a=(0,s.restorePath)(t[1]),c=new RegExp(t[2]+"$","i"),u=[],f=Object.assign({},d.range);f.start=Object.assign({},f.start),f.start.character=0;for(const e of(0,i.readdirSync)(a))try{c.test(e)&&u.push(`#Include '${a}${e}'`)}catch{}let p={range:f,newText:u.join("\n")},h={title:r.codeaction.include(a+"*"+t[2]),edit:{changes:{}},kind:o.CodeActionKind.QuickFix};return h.edit.changes[e.textDocument.uri]=[p],[h]}}},4104:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.colorProvider=t.colorPresentation=void 0;const i=n(3939);t.colorPresentation=async function(e){let t,n="RGB: ",o={range:e.range,newText:""},r=e.color,s=i.lexers[e.textDocument.uri.toLowerCase()].document.getText(e.range),a="";for(const e of[r.alpha,r.red,r.green,r.blue])a+=("00"+Math.round(255*e).toString(16)).slice(-2);return(t=s.match(/^(0x)?([\da-f]{6}([\da-f]{2})?)/i))?o.newText=(t[1]||"")+a.slice(-t[2].length):o.newText=a.substring(2),n+=o.newText,[{label:n,textEdit:o}]},t.colorProvider=async function(e){return i.lexers[e.textDocument.uri.toLowerCase()].colors()}},6129:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateAuthor=t.generateComment=t.fixinclude=t.insertSnippet=t.executeCommands=t.noparammoveright=void 0;const i=n(1017),o=n(2374),r=n(6169),s=n(3939);async function a(e){return s.connection.sendRequest("ahk2.executeCommands",[e])}function c(e,t){s.connection.sendRequest("ahk2.insertSnippet",[e,t])}t.noparammoveright=!1,t.executeCommands=a,t.insertSnippet=c,t.fixinclude=async function(e,t){let n=s.lexers[t],r="",l=-1,d="";for(const t of n.libdirs.slice(1))if(e.startsWith(t+"\\")){r=".ahk"===(0,i.extname)(e)?`#Include <${(0,i.relative)(t,(0,s.restorePath)(e)).slice(0,-4)}>`:s.pathenv.mydocuments&&e.startsWith(s.pathenv.mydocuments+"\\autohotkey\\lib")?`#Include '%A_MyDocuments%\\AutoHotkey\\Lib\\${(0,i.basename)((0,s.restorePath)(e))}'`:`#Include '${(0,s.restorePath)(e)}'`;for(const e of n.includedir)l=e[0]+1}if(""===r){for(const t of n.includedir)e.startsWith(t[1]+"\\")?t[1].length>d.length&&(l=t[0]+1,d=t[1]):!d&&e.startsWith((0,i.resolve)(t[1],"..")+"\\")&&(l=t[0]+1,d=t[1]);d=d||n.scriptpath,r=d.charAt(0)!==e.charAt(0)?`#Include '${(0,s.restorePath)(e)}'`:`#Include '${(0,i.relative)(d,(0,s.restorePath)(e))}'`}if(-1===l)l=n.document.lineCount,r="\n\n"+r;else{let e=n.document.getText({start:{line:l-1,character:0},end:{line:l,character:0}}).match(/^\s+/);r=(e?e[0]:"")+r,l<n.document.lineCount&&(r+="\n")}let{pos:u}=await s.connection.sendRequest("ahk2.getpos"),f=n.document.getText(o.Range.create(u.line,u.character-1,u.line,u.character));u.line<l&&(r="\n"+r),await s.connection.workspace.applyEdit({changes:{[n.document.uri]:[o.TextEdit.insert({line:l,character:0},r)]}}),"("===f?a([{command:"editor.action.triggerParameterHints"}]):(l<=u.line&&u.line++,c("$0",o.Range.create(u,u)),"."===f&&a([{command:"editor.action.triggerSuggest"}]))},t.generateComment=async function(e){var t;0===e.length&&await a([{command:"undo",wait:!0},{command:"undo",wait:!0}]);let{uri:n,pos:i}=await s.connection.sendRequest("ahk2.getpos"),l=s.lexers[n=n.toLowerCase()],d=l.searchScopedNode(i),u=(null==d?void 0:d.children)||l.children;for(const e of u)if((e.kind===o.SymbolKind.Function||e.kind===o.SymbolKind.Method)&&e.selectionRange.start.line===i.line&&e.selectionRange.start.character<=i.character&&i.character<=e.selectionRange.end.character){d=e;break}if(d&&(d.kind===o.SymbolKind.Function||d.kind===o.SymbolKind.Method)){let e,n=d.range.start.line;if(e=l.document.getText({start:{line:n,character:0},end:{line:n+1,character:0}}).match(/^(\s*)((static|macro)\s*)?\S+\(/i)){let s,a,u,p=d,h=["/**"],m=0,g=e[1].length,y=null===(t=d.detail)||void 0===t?void 0:t.split("\n"),v={},b=[],_=[];if(y){let e=!1,t={line:-1,character:0},i={line:-1,character:0};for(let o=n-1;o>=0;o--){let n=l.document.getText({start:{line:o,character:0},end:{line:o+1,character:0}});if(e){if(u=n.match(/^\s*\/\*/)){t.line=o,t.character=u[0].length-2;break}}else{if(u=n.match(/^\s*;/)){t.line=i.line=o,t.character=u[0].length-1,i.character=n.length;break}if(!(u=n.match(/\*\/((\s+.*)?)$/)))break;i.line=o,i.character=n.length-u[1].length,e=!0}}i.line>=t.line&&t.line>-1&&(s={start:t,end:i}),y.map((e=>{(u=e.match(/^@(param|arg)\s+(({.+?}\s)?\s*(\S+).*)$/i))?a=v[u[4].toLowerCase()]=[u[2].trim()]:(u=e.match(/^@(returns?)([\s|:]\s*(.*))?$/i))?(a=b,b.push(u[3])):a&&!e.startsWith("@")?a.push(e):(a=void 0,_.push(e))}))}if(_.length?_.map((e=>h.push(" * "+e))):(h.push(" * $1"),m++),p.params.map((e=>{if(a=v[e.name.toLowerCase()])h.push(` * @param ${a.shift()}`),a.map((e=>h.push(" * "+e)));else{let t,n=[],s={};for(const n in e.returntypes)(0,r.cleardetectcache)(),(0,r.detectExp)(l,n,o.Position.is(t=e.returntypes[n])?t:i).map((e=>s[f(e)]=!0));n=s.any?["any"]:Object.keys(s),n.length||(n=["any"]),h.push(` * @param \${${(++m).toString()+`:{${n.join("|")}\\}`}} ${e.name} $${(++m).toString()}`)}})),b.length)h.push(` * @returns ${b.shift()}`),b.map((e=>h.push(" * "+e)));else{let e,t=[],n={};for(const t in p.returntypes)(0,r.cleardetectcache)(),(0,r.detectExp)(l,t,o.Position.is(e=p.returntypes[t])?e:i).map((e=>n[f(e)]=!0));t=n.any?["any"]:Object.keys(n),t.length&&h.push(` * @returns \${${(++m).toString()+":"+(t.length?"{"+t.join("|")+"\\}":"")}}`)}if(0===m)return;h.push(" */"),s||(s=o.Range.create(n,g,n,g),h.push("")),c(h.join("\n"),s)}}function f(e){return e.trim().replace(/([^.]+)$/,"\\$$$1").replace(/\\\$[@#]/,"")}},t.generateAuthor=async function(){let e=["/************************************************************************"," * @description ${1:}"," * @file $TM_FILENAME"," * @author ${2:}"," * @date ${3:$CURRENT_YEAR/$CURRENT_MONTH/$CURRENT_DATE}"," * @version ${4:0.0.0}"," ***********************************************************************/","$0"];await a([{command:"undo",wait:!0},{command:"undo",wait:!0}]);let{uri:t,pos:n}=await s.connection.sendRequest("ahk2.getpos"),i=s.lexers[t=t.toLowerCase()],r=i.get_token(0),l=o.Range.create(0,0,0,0);r.type.endsWith("COMMENT")&&"TK_BLOCK_COMMENT"===r.type&&r.content.match(/@(version|)\b/i)||(0===i.document.positionAt(r.offset).line&&e.push(""),c(e.join("\n"),l))}},3939:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.sleep=t.set_Workfolder=t.set_locale=t.set_dirname=t.set_ahkpath=t.set_ahk_h=t.clearLibfuns=t.parseWorkspaceFolders=t.inWorkspaceFolders=t.getallahkfiles=t.loadahk2=t.initahk2cache=t.sendDiagnostics=t.getwebfile=t.getlocalefile=t.getlocalefilepath=t.restorePath=t.openFile=t.set_Connection=t.LibIncludeType=t.locale=t.getRCDATA=t.getDllExport=t.winapis=t.chinese_punctuations=t.extsettings=t.dllcalltpe=t.completionItemCache=t.pathenv=t.lexers=t.libdirs=t.hoverCache=t.symbolcache=t.libfuncs=t.ahkvars=t.inBrowser=t.isahk2_h=t.dirname=t.workspaceFolders=t.ahkpath_cur=t.connection=void 0;const r=n(6288),s=n(2880),a=n(6630),c=n(7147),l=n(1017),d=n(6169),u=n(7994);o(n(6169),t),o(n(6487),t),o(n(4104),t),o(n(6129),t),o(n(6810),t),o(n(3113),t),o(n(2793),t),o(n(9541),t),o(n(7994),t),o(n(6658),t),o(n(5932),t),o(n(9770),t),o(n(6001),t),o(n(5373),t),o(n(5116),t);const f=n(7994);function p(e,n=!0){if(t.inBrowser){let t=g(e);return t?r.TextDocument.create(t.url,"ahk2",-10,t.text):void 0}{let i;if(i=(0,c.readFileSync)(e),255===i[0]&&254===i[1])i=i.toString("utf16le");else if(239===i[0]&&187===i[1]&&191===i[2])i=i.toString("utf8").substring(1);else try{i=new TextDecoder("utf8",{fatal:!0}).decode(i)}catch{return void(n&&t.connection.window.showErrorMessage(f.diagnostic.invalidencoding(e)))}return e===e.toLowerCase()&&(e=h(e)),r.TextDocument.create(a.URI.file(e).toString(),"ahk2",-10,i)}}function h(e){if(!(0,c.existsSync)(e))return e;let t=e.toUpperCase().split("\\"),n=1,i=t[0];for(;n<t.length;){for(const e of(0,c.readdirSync)(i+"\\"))if(e.toUpperCase()===t[n]){i+="\\"+e;break}n++}return i.toLowerCase()===e?i:e}function m(e){let n,i=e.match(/<>./);if(i){if((0,c.existsSync)(n=e.replace("<>",t.locale)))return n;if("zh-tw"===t.locale.toLowerCase()&&(0,c.existsSync)(n=e.replace("<>","zh-cn")))return n;if((0,c.existsSync)(n=e.replace(i[0],"")))return n}else if((0,c.existsSync)(e))return e}function g(e){let n,i=e.match(/<>./),o=[],r=new XMLHttpRequest;if(i?(o.push(e.replace("<>",t.locale)),"zh-tw"===t.locale.toLowerCase()&&o.unshift(e.replace("<>","zh-cn")),o.unshift(e.replace(i[0],""))):o.push(e),n=o.pop())return function e(t){return r.open("GET",t,!1),r.send(),200===r.status?{url:t,text:r.responseText}:(n=o.pop())?e(n):void 0}(n)}function y(e){const n={title:"Trigger Parameter Hints",command:"editor.action.triggerParameterHints"};let i,o,r="",a=s.Range.create(0,0,0,0);for(const n in e)if("snippet"===n)for(o of e.snippet){const e=s.CompletionItem.create(o.prefix);e.kind=s.CompletionItemKind.Snippet,e.insertText=l(o.body),e.detail=o.description,e.insertTextFormat=s.InsertTextFormat.Snippet,t.completionItemCache.snippet.push(e)}else if("keys"===n)for(o of e.keys){const e=s.CompletionItem.create(o.prefix);e.kind=s.CompletionItemKind.Keyword,e.insertText=o.body,e.detail=o.description,t.completionItemCache.key.push(e)}else{let t=e[n];switch(n){case"keywords":i=s.CompletionItemKind.Keyword;break;case"functions":i=s.CompletionItemKind.Function;break;case"variables":i=s.CompletionItemKind.Variable;break;case"constants":i=s.CompletionItemKind.Constant;break;default:i=s.CompletionItemKind.Text}for(o of t)c()}function c(){var e;const c=s.CompletionItem.create(o.prefix.replace(".","")),u={contents:[]},f=o.prefix.toLowerCase();if(c.kind=i,c.insertTextFormat=s.InsertTextFormat.Snippet,i===s.CompletionItemKind.Constant?(c.insertText="${1:"+o.prefix+" := }"+o.body+"$0",c.detail=null!==(e=o.description)&&void 0!==e?e:o.body,r="constant"):o.prefix.startsWith("#")?(r="sharp",o.body=l(o.body),c.insertText=o.body.replace(/^#/,""),c.detail=o.description):(r="other",i===s.CompletionItemKind.Function&&-1===o.body.indexOf("|}")&&-1!==o.body.indexOf("(")?(c.insertText=o.prefix+"($0)",c.command=n,c.detail=o.description):(c.insertText=o.body.replace(/\$\{\d:\s*\[,[^\]\}]+\]\}/,(()=>(c.command=n,""))),c.detail=o.description)),o.body=o.body.replace(/\$\{\d+((\|)|:)([^}]*)\2\}|\$\d/g,((...e)=>e[2]?e[3].replace(/,/g,"|"):e[3]||"")),c.documentation={kind:s.MarkupKind.Markdown,value:"```ahk2\n"+o.body+"\n```"},i!==s.CompletionItemKind.Function&&t.completionItemCache[r].push(c),i===s.CompletionItemKind.Constant||i===s.CompletionItemKind.Text)return;u.contents={kind:s.MarkupKind.Markdown,value:"```ahk2\n"+o.body+"\n```\n\n"+o.description};let p=i===s.CompletionItemKind.Function?0:1;if(t.hoverCache[p][f]||(t.hoverCache[p][f]=[]),!p){let e=d.FuncNode.create(o.prefix,s.SymbolKind.Function,a,a,o.body.replace(/^\w+[(\s]?|\)/g,"").split(",").map((e=>s.DocumentSymbol.create(e.replace(/[\[\]\s]/g,""),void 0,s.SymbolKind.Variable,a,a))));e.full=e.full.replace(/(['\w]*\|['\w]*)(\|['\w]*)+/,((...e)=>(o.body=o.body.replace(e[0],e[1]+"|..."),e[1]+"|..."))),e.detail=o.description,t.ahkvars[f]=e}o.description&&t.hoverCache[p][f].push(u)}function l(e){return"object"==typeof e?e.join("\n"):e}}function v(e,t=3){let n=[];return(0,c.existsSync)(e)&&(0,c.statSync)(e).isDirectory()&&function e(i,o){(0,c.readdirSync)(i).map((r=>{let s=(0,l.resolve)(i,r);(0,c.statSync)(s).isDirectory()?o<t&&e(s,o+1):r.match(/\.(ahk2?|ah2)$/i)&&n.push(s.toLowerCase())}))}(e,0),n}async function b(e){return new Promise((t=>setTimeout(t,e)))}var _;t.ahkpath_cur="",t.workspaceFolders=[],t.dirname="",t.isahk2_h=!1,t.inBrowser=!1,t.ahkvars={},t.libfuncs={},t.symbolcache={},t.hoverCache=[{},{}],t.libdirs=[],t.lexers={},t.pathenv={},t.completionItemCache={sharp:[],method:[],key:[],other:[],constant:[],snippet:[]},t.dllcalltpe=[],t.extsettings={InterpreterPath:"C:\\Program Files\\AutoHotkey\\AutoHotkey32.exe",AutoLibInclude:0,CommentTags:"^;;\\s*(.*)",CompleteFunctionParens:!1,SymbolFoldingFromOpenBrace:!1,DisableV1Script:!0,Diagnostics:{ParamsCheck:!0,ClassStaticMemberCheck:!0},FormatOptions:{}},t.chinese_punctuations={"":",","":".","":";","":"'","":"'","":"[","":"]","":"<","":">","":"?","":":","":'"',"":'"',"":"(","":")","":"!"},t.winapis=[],t.getDllExport=(e,t=!1)=>[],t.getRCDATA=e=>{},t.locale="en-us",(_=t.LibIncludeType||(t.LibIncludeType={}))[_.Disabled=0]="Disabled",_[_.Local=1]="Local",_[_["User and Standard"]=2]="User and Standard",_[_.All=3]="All",t.set_Connection=function(e,n,i,o){t.connection=e,t.inBrowser=n,i&&(t.getDllExport=i),o&&(t.getRCDATA=o)},t.openFile=p,t.restorePath=h,t.getlocalefilepath=m,t.getlocalefile=function(e,t){let n=m(e);if(n)return(0,c.readFileSync)(n,t?{encoding:t}:void 0)},t.getwebfile=g,t.sendDiagnostics=function(){let e;for(const n in t.lexers)e=t.lexers[n],t.connection.sendDiagnostics({uri:e.document.uri,diagnostics:e.actived||e.relevance&&Object.keys(e.relevance).length?e.diagnostics:[]})},t.initahk2cache=function(){t.ahkvars={},t.dllcalltpe=["str","astr","wstr","int64","int","uint","short","ushort","char","uchar","float","double","ptr","uptr","HRESULT"],t.completionItemCache={sharp:[],method:[],key:[],other:[],constant:[],snippet:!t.inBrowser&&process.env.AHK2_LS_CONFIG?[]:[{label:"zs-Comment",detail:u.completionitem.comment(),kind:s.CompletionItemKind.Snippet,command:{title:"ahk2.generate.comment",command:"ahk2.generate.comment",arguments:[]}},{label:"zs-Author",detail:u.completionitem.author(),kind:s.CompletionItemKind.Snippet,command:{title:"ahk2.generate.author",command:"ahk2.generate.author"}}]}},t.loadahk2=async function(e="ahk2"){let n;if(t.inBrowser){const n=t.dirname+`/syntaxes/<>/${e}`;let i,o=p(n+".d.ahk");if(o){let e=new d.Lexer(o,void 0,3);e.parseScript(),t.lexers[e.uri]=e}"ahk2"===e&&(i=g(t.dirname+"/syntaxes/ahk2_common.json"))&&y(JSON.parse(i.text)),(i=g(n+".json"))&&y(JSON.parse(i.text))}else{const i=(0,l.resolve)(__dirname,`../../syntaxes/<>/${e}`);let o;if((n=m(i+".d.ahk"))&&(o=p(n))){let e=new d.Lexer(o,void 0,3);e.parseScript(),t.lexers[e.uri]=e}if(!(n=m(i+".json")))return;"ahk2"===e&&y(JSON.parse((0,c.readFileSync)((0,l.resolve)(__dirname,"../../syntaxes/ahk2_common.json"),{encoding:"utf8"}))),y(JSON.parse((0,c.readFileSync)(n,{encoding:"utf8"})))}},t.getallahkfiles=v,t.inWorkspaceFolders=function(e){e=e.toLowerCase();for(let n of t.workspaceFolders)if(e.startsWith(n))return n;return""},t.parseWorkspaceFolders=async function(){let e;if(t.inBrowser){let n=await t.connection.sendRequest("ahk2.getWorkspaceFiles",[])||[];for(let i of n)if(!t.lexers[e=i.toLowerCase()]){let n=await t.connection.sendRequest("ahk2.getWorkspaceFileContent",[i]);if(n){let o=new d.Lexer(r.TextDocument.create(i,"ahk2",-10,n));o.parseScript(),t.lexers[e]=o,await b(100)}}}else for(let n of t.workspaceFolders){let i,o=a.URI.parse(n).fsPath;for(let n of v(o))if(e=a.URI.file(n).toString().toLowerCase(),!t.lexers[e]&&(i=p(n,!1))){let n=new d.Lexer(i);n.parseScript(),t.lexers[e]=n,await b(100)}}},t.clearLibfuns=function(){t.libfuncs={}},t.set_ahk_h=function(e){t.isahk2_h=e},t.set_ahkpath=function(e){t.ahkpath_cur=e},t.set_dirname=function(e){t.dirname=e.replace(/[/\\]$/,"")},t.set_locale=function(e){e&&(t.locale=e.toLowerCase())},t.set_Workfolder=function(e){t.workspaceFolders=e||[]},t.sleep=b},6810:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.completionProvider=void 0;const i=n(7147),o=n(1017),r=n(2374),s=n(6630),a=n(6169),c=n(7994),l=n(3939);function d(e){let t=r.CompletionItem.create(e.name);switch(e.kind){case r.SymbolKind.Function:case r.SymbolKind.Method:t.kind=e.kind===r.SymbolKind.Method?r.CompletionItemKind.Method:r.CompletionItemKind.Function,l.extsettings.CompleteFunctionParens?e.params.length?(t.command={title:"Trigger Parameter Hints",command:"editor.action.triggerParameterHints"},e.params[0].name.includes("|")?(t.insertText=t.label+"(${1|"+e.params[0].name.replace(/\|/g,",")+"|})",t.insertTextFormat=r.InsertTextFormat.Snippet):(t.insertText=t.label+"($0)",t.insertTextFormat=r.InsertTextFormat.Snippet)):t.insertText=t.label+"()":t.commitCharacters=["\t","("],t.detail=e.full,t.documentation=e.detail;break;case r.SymbolKind.Variable:case r.SymbolKind.TypeParameter:t.kind=r.CompletionItemKind.Variable,t.detail=e.detail;break;case r.SymbolKind.Class:t.kind=r.CompletionItemKind.Class,t.commitCharacters=[".","("],t.detail="class "+t.label,t.documentation=e.detail;break;case r.SymbolKind.Event:t.kind=r.CompletionItemKind.Event;break;case r.SymbolKind.Field:t.kind=r.CompletionItemKind.Field,t.label=t.insertText=t.label.replace(/:$/,"");break;case r.SymbolKind.Property:if(t.kind=r.CompletionItemKind.Property,t.detail=e.full||t.label,t.documentation=e.detail||"",e.children)for(const n of e.children)if(n.kind===r.SymbolKind.Function&&"get"===n.name.toLowerCase()&&n.params.length){t.insertTextFormat=r.InsertTextFormat.Snippet,t.insertText=t.label+"[$0]";break}break;default:t.kind=r.CompletionItemKind.Text}return t}t.completionProvider=async function(e,t){var n,u,f,p,h,m,g,y,v,b,_,k,T,R;if(t.isCancellationRequested||null===(null===(n=e.context)||void 0===n?void 0:n.triggerCharacter))return;const{position:w,textDocument:S}=e,C=[],x={},E={};let D,O,K,P=!0,A=null===(u=e.context)||void 0===u?void 0:u.triggerKind,L=S.uri.toLowerCase(),N=l.lexers[L],M=N.buildContext(w,!1,!0),I="",j="",q="",F=!1,W=M.linetext,$=W.charAt(M.range.start.character-1),U=N.relevance,B={label:""},{line:V,character:H}=w,z=new RegExp(M.text.match(/[^\w]/)?M.text.replace(/(.)/g,"$1.*"):"("+M.text.replace(/(.)/g,"$1.*")+"|[^\\w])","i"),G=N.document.offsetAt({line:V,character:H-1}),Y=N.find_token(G),X="TK_STRING"===Y.type;if(X){if(2===A)return;$=""}else if(Y.type.endsWith("COMMENT"))F=!0,"TK_COMMENT"===Y.type&&(W=W.replace(/^\s*;@include\b/i,"#include"));else if(M.pre.startsWith("#"))for(let e=0;e<w.character;e++)if(j=W.charAt(e),I===j){if("`"===W.charAt(e-1))continue;I="",F=!1}else"%"===j?F=!F:""!==I||'"'!==j&&"'"!==j||0!==e&&!W.charAt(e-1).match(/[([%,\s]/)||(I=j);else if(!Y.topofline)for(;(Y=Y.previous_token)&&Y.type;){if("%"===Y.content){Y.next_pair_pos&&(F=!0);break}if(Y.topofline)break}if(!F&&"."===$&&M.pre.match(/^#(include|dllload)/i)&&($="###"),O=W.match(/^\s*((class\s+(\w|[^\x00-\x7f])+\s+)?(extends)|class)\s/i)){if("."===$)return O[3]&&(null===(f=(0,a.searchNode)(N,N.buildContext(w,!0,!0).text.replace(/\.[^.]*$/,"").toLowerCase(),w,r.SymbolKind.Class))||void 0===f||f.map((e=>{Object.values((0,a.getClassMembers)(N,e.node,!0)).map((e=>{e.kind===r.SymbolKind.Class&&!x[q=e.name.toLowerCase()]&&z.test(q)&&(C.push(d(e)),x[q]=!0)}))}))),C;if(!O[3]&&!O[2])return[{label:"extends",kind:r.CompletionItemKind.Keyword}];let e=[N.declaration];for(const t in U)l.lexers[t]&&e.push(l.lexers[t].declaration);e.map((e=>{for(const t in e)e[t].kind===r.SymbolKind.Class&&!x[t]&&z.test(t)&&(C.push(d(e[t])),x[t]=!0)}));for(const e in l.ahkvars)l.ahkvars[e].kind===r.SymbolKind.Class&&!x[e]&&z.test(e)&&(C.push(d(l.ahkvars[e])),x[e]=!0);return C}switch($){case"#":return C.push(...l.completionItemCache.sharp),C.push(...l.completionItemCache.snippet),C;case".":if(M=N.buildContext(w,!0,!0),M.text.match(/^\d+(\.\d*)*\.$/))return;let e=!0,t=!0,n=!1,u=!1,f=!1,S={},I=[],j={},$=M.text.replace(/\.\w*$/,"").toLowerCase();if((0,a.cleardetectcache)(),(0,a.detectExpType)(N,$,w,j),void 0===j["#any"])for(const n in j)if(e=!1,t=!n.match(/[@#][^.]+$/),j[n]){let e=j[n].node.kind;if(e===r.SymbolKind.Function||e===r.SymbolKind.Method){u||(u=!0,l.ahkvars.func&&(I.push(l.ahkvars.func),t=!1));continue}I.push(j[n].node)}else n.includes("=>")?!u&&(u=!0,l.ahkvars.func)&&(I.push(l.ahkvars.func),t=!1):null===(p=(0,a.searchNode)(N,n,w,r.SymbolKind.Variable))||void 0===p||p.map((e=>I.push(e.node)));void 0!==j["#object"]&&(0,a.getcacheproperty)().map((e=>{S[q=e.toLowerCase()]||(C.push(S[q]=r.CompletionItem.create(e)),S[q].kind=r.CompletionItemKind.Property)}));for(const e of I)switch(e.kind){case r.SymbolKind.Class:let n=(0,a.getClassMembers)(N,e,t);t&&!1===(null===(h=n.__new)||void 0===h?void 0:h.static)&&delete n.__new,Object.values(n).map((e=>{z.test(e.name)&&(e.kind===r.SymbolKind.Property||e.kind===r.SymbolKind.Class?S[q=e.name.toLowerCase()]?S[q].detail!==e.full&&(S[q].detail="(...) "+e.name,S[q].insertText=e.name):C.push(S[q]=d(e)):e.kind===r.SymbolKind.Method&&(S[q=e.name.toLowerCase()]?S[q].detail!==e.full&&(S[q].detail="(...) "+e.name+"()",S[q].documentation=""):C.push(S[q]=d(e))))}));break;case r.SymbolKind.Object:f=!0}if(!e&&(1!==A||M.text.match(/\..{0,2}$/)))return C;let V=[N.object];for(const e in U)V.push(l.lexers[e].object);for(const e of V){if(e===N.object){for(const t in e.property)if(z.test(t))if(S[t])S[t].detail=S[t].label;else{let n=e.property[t];Z(n)||C.push(S[t]=d(n))}}else for(const t in e.property)z.test(t)&&(S[t]?S[t].detail=S[t].label:C.push(S[t]=d(e.property[t])));for(const t in e.method)z.test(t)&&(S[t]?"object"==typeof S[t]&&(S[t].detail="(...) "+S[t].label):C.push(S[t]=d(e.method[t][0])))}for(const e in l.ahkvars){if(f&&"object"===e||u&&"func"===e||n&&"class"===e||"any"===e||!l.ahkvars[e].children)continue;let t=[];null===(m=l.ahkvars[e].children)||void 0===m||m.map((e=>{e.kind===r.SymbolKind.Class?t.push(...e.children):t.push(e)})),t.map((e=>{e.kind!==r.SymbolKind.Class&&z.test(q=e.name.toLowerCase())&&(S[q]?S[q].detail!==e.full&&(S[q].detail="(...) "+e.name,S[q].insertText=e.name,S[q].documentation=void 0):C.push(S[q]=d(e)))}))}return C;default:if(O=W.match(/^\s*#(include|(dllload))/i)){if(l.inBrowser)return;W=W.replace(/\s+;.*/,"").trimRight();let e,t=W.replace(/^\s*#(include(again)?|dllload)\s+/i,"").replace(/\*i\s+/i,""),n=[],a=!1,c="",d=W.substring(W.length-t.length,w.character),u="\\",f="",p=!!O[2];if(F)return l.completionItemCache.other.map((e=>{e.kind===r.CompletionItemKind.Variable&&z.test(e.label)&&C.push(e)})),C;if(!d)return;if(d.match(/^['"<]/)){if(d.substring(1).match(/[">]/))return;if("<"===(c=d[0])){if(p)return;a=!0,n=N.libdirs}else p||(n=(O=N.includedir.get(w.line))?[O]:[N.scriptpath]);d=d.substring(1),c="<"===c?">":c,-1!==W.substring(w.character).indexOf(c)&&(c="")}else p||(n=(O=N.includedir.get(w.line))?[O]:[N.scriptpath]);let h=p?new RegExp(/\.(dll|ocx|cpl)$/i):a?new RegExp(/\.ahk$/i):new RegExp(/\.(ahk2?|ah2)$/i),m="";for(d=d.replace(/[^\\/]*$/,(e=>(m=e,"")));e=d.match(/%a_(\w+)%/i);)if(l.pathenv[f=e[1].toLowerCase()])d=d.replace(e[0],l.pathenv[f]);else if("scriptdir"===f)d=d.replace(e[0],N.scriptdir);else{if("linefile"!==f)return;d=d.replace(e[0],s.URI.parse(N.uri).fsPath)}if(d.endsWith("/")&&(u="/"),m.startsWith("*")){if(l.inBrowser)return;for(let e in null!==(g=(0,l.getRCDATA)())&&void 0!==g?g:{})Q(e,r.CompletionItemKind.File);return C}m=m.replace(/`;/g,";");let y,v=new RegExp((m.match(/[^\w]/)?m.replace(/(.)/g,"$1.*"):"("+m.replace(/(.)/g,"$1.*")+"|[^\\w])").replace(/\.\./,"\\.."),"i");p&&(n=[(O=N.dlldir.get(w.line))?O:N.scriptpath,"C:\\Windows\\System32"]),m.match(/[^\w]/)&&(y=r.TextEdit.replace({start:{line:w.line,character:w.character-m.length},end:w},""));for(let e of n)if((0,i.existsSync)(e=(0,o.resolve)(e,d)+"\\")&&(0,i.statSync)(e).isDirectory()){for(let t of(0,i.readdirSync)(e))try{(0,i.statSync)(e+t).isDirectory()?v.test(t)&&(Q(t.replace(/;/g,"`;"),r.CompletionItemKind.Folder),B.command={title:"Trigger Suggest",command:"editor.action.triggerSuggest"},y?B.textEdit=Object.assign({},y,{newText:B.label+u}):B.insertText=B.label+u):h.test(t)&&v.test(a?t=t.replace(h,""):t)&&(Q(t.replace(/;/g,"`;"),r.CompletionItemKind.File),y?B.textEdit=Object.assign({},y,{newText:B.label+c}):B.insertText=B.label+c)}catch{}if(d.includes(":"))break}return C}if(O=W.match(/(?<!\.)\b(goto|continue|break)\b(?!\s*:)(\s+|\(\s*('|")?)/i)){let e=O[2].trim();if(D=N.searchScopedNode(w))null===(y=D.children)||void 0===y||y.map((e=>{e.kind===r.SymbolKind.Field&&z.test(e.name)&&C.push(d(e))}));else{N.children.map((e=>{e.kind===r.SymbolKind.Field&&z.test(e.name)&&C.push(d(e))}));for(const e in U)l.lexers[e].children.map((e=>{e.kind===r.SymbolKind.Field&&z.test(e.name)&&C.push(d(e))}))}if(""===e||O[3])return C;for(let e of C)e.insertText=`'${e.insertText}'`}else{if(X){let e=(0,a.getFuncCallInfo)(N,w);if(e){let t="."===W.charAt(e.pos.character-1);if(t)switch(e.name){case"add":if(0===e.index){let t=(0,a.searchNode)(N,N.buildContext(e.pos,!0).text.toLowerCase(),e.pos,r.SymbolKind.Method);if(t&&(null===(v=t[0].node.full)||void 0===v?void 0:v.match(/\(gui\)\s+add\(/i)))return["Text","Edit","UpDown","Picture","Button","Checkbox","Radio","DropDownList","ComboBox","ListBox","ListView","TreeView","Link","Hotkey","DateTime","MonthCal","Slider","Progress","GroupBox","Tab","Tab2","Tab3","StatusBar","ActiveX","Custom"].map(ee)}break;case"onevent":if(0===e.index){let t=null===(b=(0,a.searchNode)(N,N.buildContext(e.pos,!0).text.toLowerCase(),e.pos,r.SymbolKind.Method))||void 0===b?void 0:b[0].node;if(t){if(t.full.match(/\(gui\)\s+onevent\(/i))return["Close","ContextMenu","DropFiles","Escape","Size"].map(ee);if(t.full.match(/\(gui\.control\)\s+onevent\(/i))return["Change","Click","DoubleClick","ColClick","ContextMenu","Focus","LoseFocus","ItemCheck","ItemEdit","ItemExpand","ItemFocus","ItemSelect"].map(ee)}}break;case"bind":case"call":{let n=N.buildContext(e.pos,!0).text.toLowerCase(),i=null===(_=(0,a.searchNode)(N,n,e.pos,r.SymbolKind.Method))||void 0===_?void 0:_[0].node;i&&(null===(k=i.full)||void 0===k?void 0:k.match(/\(func\)\s+\w+\(/i))?(e.name=n.slice(0,-5),t=!1):i&&i.kind===r.SymbolKind.Function&&(e.name=i.name.toLowerCase(),t=!1);break}}if(!t&&J(e.name,e.pos))switch(e.name){case"dynacall":if(0!==e.index)break;case"dllcall":if(!J(e.name,e.pos))break;if(0===e.index){if(l.inBrowser)break;let t=N.tokens[N.document.offsetAt(e.pos)],n=N.document.offsetAt(w);if(!t)break;for(;(t=N.tokens[t.next_token_offset])&&"("===t.content;)continue;if(t&&"TK_STRING"===t.type&&n>t.offset&&n<=t.offset+t.length){let e=t.content.substring(1,n-t.offset),o=[N],s={};for(let e in U)o.push(l.lexers[e]);if(C.splice(0),e.match(/[\\/]/)){let t={},n=!0;return q=e.replace(/[\\/][^\\/]*$/,"").replace(/\\/g,"/").toLowerCase(),q.match(/\.\w+$/)||(q+=".dll"),q.includes(":")?(n=!1,t[q]=1):q.includes("/")?q.startsWith("/")?t[N.scriptpath+q]=1:t[N.scriptpath+"/"+q]=1:o.map((e=>{e.dllpaths.map((e=>{e.endsWith(q)&&(t[e]=1,n&&e.includes("/")&&(n=!1))})),n&&(t[q]=t[e.scriptpath+"/"+q]=1)})),(0,l.getDllExport)(Object.keys(t),!0).map((e=>Q(e,r.CompletionItemKind.Function))),C}return o.map((e=>e.dllpaths.map((e=>{e=e.replace(/^.*[\\/]/,"").replace(/\.dll$/i,""),s[q=e.toLowerCase()]||(s[q]=!0,Q(e+"\\",r.CompletionItemKind.File))})))),(0,i.readdirSync)("C:\\Windows\\System32").map((e=>{e.toLowerCase().endsWith(".dll")&&z.test(e=e.slice(0,-4))&&Q(e+"\\",r.CompletionItemKind.File)})),l.winapis.map((e=>{z.test(e)&&Q(e,r.CompletionItemKind.Function)})),C}}else if(e.index>0&&e.index%2==1){for(const e of["cdecl"].concat(l.dllcalltpe))Q(e,r.CompletionItemKind.TypeParameter),B.commitCharacters=["*"];return C}break;case"comcall":if(e.index>1&&e.index%2==0){for(const e of["cdecl"].concat(l.dllcalltpe))Q(e,r.CompletionItemKind.TypeParameter),B.commitCharacters=["*"];return C}break;case"numget":if(2===e.index||1===e.index){for(const e of l.dllcalltpe.filter((e=>!e.match(/str$/i))))Q(e,r.CompletionItemKind.TypeParameter);return C}break;case"numput":if(e.index%2==0){for(const e of l.dllcalltpe.filter((e=>!e.match(/str$/i))))Q(e,r.CompletionItemKind.TypeParameter);return C}break;case"objbindmethod":if(1===e.index){let e,t={};if(["new","delete","get","set","call"].map((e=>{t["__"+e]=!0})),O=M.pre.match(/objbindmethod\(\s*(([\w.]|[^\x00-\x7f])+)\s*,/i)){let n={};if((0,a.cleardetectcache)(),(0,a.detectExpType)(N,O[1],w,n),void 0===n["#any"])for(const i in n)!1===n[i]?e=(0,a.searchNode)(N,i,w,r.SymbolKind.Class):n[i]&&(e=[n[i]]),null==e||e.map((e=>{Object.values((0,a.getClassMembers)(N,e.node,!i.match(/[@#][^.]+$/))).map((e=>{e.kind===r.SymbolKind.Method&&!t[O=e.name.toLowerCase()]&&z.test(O)&&(t[O]=!0,Q(e.name,r.CompletionItemKind.Method))}))}))}if(!e){let e=[N.object.method];for(const t in U)e.push(l.lexers[t].object.method);for(const n of e)for(const e in n)!t[e]&&z.test(e)&&(t[e]=!0,Q(n[e][0].name,r.CompletionItemKind.Method))}return C}break;case"processsetpriority":if(0===e.index)return["Low","BelowNormal","Normal","AboveNormal","High","Realtime"].map(ee);break;case"thread":if(0===e.index)return["NoTimers","Priority","Interrupt"].map(ee);break;case"settitlematchmode":if(0===e.index)return["Fast","Slow","RegEx"].map(ee);break;case"setnumlockstate":case"setcapslockstate":case"setscrolllockstate":if(0===e.index)return["On","Off","AlwaysOn","AlwaysOff"].map(ee);break;case"sendmode":if(0===e.index)return["Event","Input","InputThenPlay","Play"].map(ee);break;case"blockinput":if(0===e.index)return["On","Off","Send","Mouse","SendAndMouse","Default","MouseMove","MouseMoveOff"].map(ee);break;case"coordmode":if(0===e.index)return["ToolTip","Pixel","Mouse","Caret","Menu"].map(ee);if(1===e.index)return["Screen","Window","Client"].map(ee)}}P&&l.completionItemCache.other.map((e=>{e.kind===r.CompletionItemKind.Text&&z.test(e.label)&&(x[e.label.toLowerCase()]=!0,C.push(e))}));for(const e in x)E[e]=!0;for(const e in N.texts)!E[e]&&z.test(e)&&(E[e]=!0,Q(N.texts[e],r.CompletionItemKind.Text));for(const e in U)for(const t in O=l.lexers[e].texts)!E[t]&&z.test(t)&&(E[t]=!0,Q(O[t],r.CompletionItemKind.Text));return C}if(F)P=!1;else if(!Y.content&&!W.includes("::"))return l.completionItemCache.other.filter((e=>e.kind===r.CompletionItemKind.Text))}let H=0===l.extsettings.FormatOptions.one_true_brace?"\n":" ";if(P)for(let[e,t]of[["switch",["switch ${1:[SwitchValue, CaseSense]}","{\n\tcase ${2:}:\n\t\t${3:}\n\tdefault:\n\t\t$0\n}"]],["trycatch",["try","{\n\t$1\n}","catch ${2:Error} as ${3:e}","{\n\t$0\n}"]],["class",["class $1","{\n\t$0\n}"]]])C.push({label:e,kind:r.CompletionItemKind.Keyword,insertTextFormat:r.InsertTextFormat.Snippet,insertText:t.join(H)});if(D=N.searchScopedNode(w))if(D.kind===r.SymbolKind.Class){let e=[],t=W.trim();for(let t of["__Call(${1:Name}, ${2:Params})","__Delete()","__Enum(${1:NumberOfVars})","__Get(${1:Key}, ${2:Params})","__Item[$1]","__New($1)","__Init()","__Set(${1:Key}, ${2:Params}, ${3:Value})"])e.push({label:t.replace(/[(\[].*$/,""),kind:r.CompletionItemKind.Method,insertTextFormat:r.InsertTextFormat.Snippet,insertText:t+H+"{\n\t$0\n}"});if(t.match(/^(\w|[^\x00-\x7f])*$/)){if(w.line===D.range.end.line&&w.character>D.range.end.character)return;return e.concat({label:"static",kind:r.CompletionItemKind.Keyword,insertText:"static "},C.pop())}if(t.match(/^(static\s+)?(\w|[^\x00-\x7f])+(\(|$)/i))return e}else if(D.kind===r.SymbolKind.Property&&D.children)return[{label:"get",kind:r.CompletionItemKind.Function},{label:"set",kind:r.CompletionItemKind.Function}];for(const e in l.ahkvars)z.test(e)&&(x[e]=d(l.ahkvars[e]));Object.values(N.declaration).map((e=>{!z.test(q=e.name.toLowerCase())||Z(e)||x[q]&&e.kind===r.SymbolKind.Variable||(x[q]=d(e))}));for(const e in U){K=U[e];for(const t in O=null===(T=l.lexers[e])||void 0===T?void 0:T.declaration)z.test(t)&&(!x[t]||x[t].kind===r.CompletionItemKind.Variable&&O[t].kind!==r.SymbolKind.Variable)&&(B=d(O[t]),B.detail=`${c.completionitem.include(K)}  `+(B.detail||""),x[t]=B)}D&&N.getScopeChildren(D).map((e=>{!z.test(q=e.name.toLowerCase())||x[q]&&e.kind===r.SymbolKind.Variable&&!e.returntypes||(x[q]=d(e))})),l.completionItemCache.other.map((e=>{z.test(e.label)&&(e.kind===r.CompletionItemKind.Variable?x[e.label.toLowerCase()]=e:e.kind===r.CompletionItemKind.Function?x[q=e.label.toLowerCase()]||(x[q]=e):P&&e.kind!==r.CompletionItemKind.Text&&C.push(e))})),D||F||(W.includes("::")?C.push(...l.completionItemCache.key):C.push(...l.completionItemCache.key.filter((e=>!e.label.toLowerCase().includes("alttab")))));let G=(0,l.inWorkspaceFolders)(N.document.uri)||N.scriptdir,te=0;if(l.extsettings.AutoLibInclude)for(const e in l.libfuncs)if((!U||!U[e])&&(K=s.URI.parse(e).fsPath,(l.extsettings.AutoLibInclude>1&&l.libfuncs[e].islib||1&l.extsettings.AutoLibInclude&&K.startsWith(G))&&(l.libfuncs[e].map((e=>{!x[q=e.name.toLowerCase()]&&z.test(q)&&(B=d(e),B.detail=`${c.completionitem.include(K)}  `+(B.detail||""),B.command={title:"ahk2.fix.include",command:"ahk2.fix.include",arguments:[K,L]},delete B.commitCharacters,x[q]=B,te++)})),te>300)))break;return null===(R=null==D?void 0:D.children)||void 0===R||R.map((e=>{x[q=e.name.toLowerCase()]||!z.test(q)||Z(e)||(x[q]=d(e))})),P&&function(){if(C.push(...l.completionItemCache.snippet),1===A&&M.text.length>2&&M.text.match(/^[a-z]+_/i)){const e=l.completionItemCache.constant;for(const t of e)z.test(t.label)&&C.push(t)}}(),C.concat(Object.values(x))}function J(e,t){var n;let i=null===(n=(0,a.searchNode)(N,e,t,r.SymbolKind.Variable))||void 0===n?void 0:n[0].node;return i&&i===l.ahkvars[e]}function Q(e,t){x[q=e.toLowerCase()]||(C.push(B=r.CompletionItem.create(e)),B.kind=t,x[q]=!0)}function Z(e){return e.range.end.line===V&&e.range.start.character<=H&&H<=e.range.end.character}function ee(e){const t=r.CompletionItem.create(e);return t.kind=r.CompletionItemKind.Text,t.command={title:"cursorRight",command:"cursorRight"},t}}},4780:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.builtin_ahkv1_commands=t.builtin_variable_h=t.builtin_variable=void 0,t.builtin_variable=["a_priorline","a_workfilename","true","false","unset","a_ahkpath","a_ahkversion","a_allowmainwindow","a_appdata","a_appdatacommon","a_args","a_clipboard","a_computername","a_comspec","a_controldelay","a_coordmodecaret","a_coordmodemenu","a_coordmodemouse","a_coordmodepixel","a_coordmodetooltip","a_cursor","a_dd","a_ddd","a_dddd","a_defaultmousespeed","a_desktop","a_desktopcommon","a_detecthiddentext","a_detecthiddenwindows","a_endchar","a_eventinfo","a_fileencoding","a_hotkeyinterval","a_hotkeymodifiertimeout","a_hour","a_iconfile","a_iconhidden","a_iconnumber","a_icontip","a_index","a_initialworkingdir","a_is64bitos","a_isadmin","a_iscompiled","a_iscritical","a_ispaused","a_issuspended","a_keydelay","a_keydelayplay","a_keyduration","a_keydurationplay","a_language","a_lasterror","a_linefile","a_linenumber","a_listlines","a_loopfield","a_loopfileattrib","a_loopfiledir","a_loopfileext","a_loopfilefullpath","a_loopfilename","a_loopfilepath","a_loopfileshortname","a_loopfileshortpath","a_loopfilesize","a_loopfilesizekb","a_loopfilesizemb","a_loopfiletimeaccessed","a_loopfiletimecreated","a_loopfiletimemodified","a_loopreadline","a_loopregkey","a_loopregname","a_loopregtimemodified","a_loopregtype","a_maxhotkeysperinterval","a_mday","a_menumaskkey","a_min","a_mm","a_mmm","a_mmmm","a_mon","a_mousedelay","a_mousedelayplay","a_msec","a_mydocuments","a_now","a_nowutc","a_osversion","a_priorhotkey","a_priorkey","a_programfiles","a_programs","a_programscommon","a_ptrsize","a_regview","a_screendpi","a_screenheight","a_screenwidth","a_scriptdir","a_scriptfullpath","a_scripthwnd","a_scriptname","a_sec","a_sendlevel","a_sendmode","a_space","a_startmenu","a_startmenucommon","a_startup","a_startupcommon","a_storecapslockmode","a_tab","a_temp","a_thisfunc","a_thishotkey","a_tickcount","a_timeidle","a_timeidlekeyboard","a_timeidlemouse","a_timeidlephysical","a_timesincepriorhotkey","a_timesincethishotkey","a_titlematchmode","a_titlematchmodespeed","a_traymenu","a_username","a_wday","a_windelay","a_windir","a_workingdir","a_yday","a_year","a_yweek","a_yyyy"],t.builtin_variable_h=["a_ahkdir","a_dlldir","a_dllpath","a_globalstruct","a_isdll","a_mainthreadid","a_memorymodule","a_modulehandle","a_scriptstruct","a_threadid","a_zipcompressionlevel"],t.builtin_ahkv1_commands=["autotrim","blockinput","click","clipwait","control","controlclick","controlfocus","controlget","controlgetfocus","controlgetpos","controlgettext","controlmove","controlsend","controlsendraw","controlsettext","coordmode","critical","detecthiddentext","detecthiddenwindows","drive","driveget","drivespacefree","envadd","envdiv","envget","envmult","envset","envsub","envupdate","exit","exitapp","fileappend","filecopy","filecopydir","filecreatedir","filecreateshortcut","filedelete","fileencoding","filegetattrib","filegetshortcut","filegetsize","filegettime","filegetversion","fileinstall","filemove","filemovedir","fileopen","fileread","filereadline","filerecycle","filerecycleempty","fileremovedir","fileselectfile","fileselectfolder","filesetattrib","filesettime","format","formattime","getkeystate","gosub","groupactivate","groupadd","groupclose","groupdeactivate","gui","guicontrol","guicontrolget","hotkey","ifequal","ifexist","ifgreater","ifgreaterorequal","ifless","iflessorequal","ifmsgbox","ifnotequal","ifnotexist","ifwinactive","ifwinexist","ifwinnotactive","ifwinnotexist","imagesearch","inidelete","iniread","iniwrite","input","inputbox","keywait","listlines","menu","mouseclick","mouseclickdrag","mousegetpos","mousemove","msgbox","onerror","onexit","outputdebug","pause","pixelgetcolor","pixelsearch","postmessage","process","progress","random","regdelete","regread","regwrite","run","runas","runwait","send","sendevent","sendinput","sendlevel","sendmessage","sendmode","sendplay","sendraw","setbatchlines","setcapslockstate","setcontroldelay","setdefaultmousespeed","setenv","setformat","setkeydelay","setmousedelay","setnumlockstate","setregview","setscrolllockstate","setstorecapslockmode","settimer","settitlematchmode","setwindelay","setworkingdir","shutdown","sleep","sort","soundbeep","soundget","soundgetwavevolume","soundplay","soundset","soundsetwavevolume","splashimage","splashtextoff","splashtexton","splitpath","statusbargettext","statusbarwait","stringcasesense","stringleft","stringlower","stringright","stringtrimleft","stringtrimright","stringupper","suspend","sysget","thread","tooltip","transform","traytip","urldownloadtofile","winactivate","winactivatebottom","winclose","winget","wingetactivestats","wingetactivetitle","wingetclass","wingetpos","wingettext","wingettitle","winhide","winkill","winmaximize","winmenuselectitem","winminimize","winminimizeall","winminimizeallundo","winmove","winrestore","winset","winsettitle","winshow","winwait","winwaitactive","winwaitclose","winwaitnotactive"]},3113:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defintionProvider=void 0;const i=n(2374),o=n(6169),r=n(3939),s=n(6630);t.defintionProvider=async function(e){var t,n,a;let c,l=e.textDocument.uri.toLowerCase(),d=r.lexers[l],u=d.buildContext(e.position),f=[];if(u){let l,p="",h=i.SymbolKind.Variable;if(u.pre.startsWith("#")&&!u.token){let o=e.position.line,a=u.linetext.indexOf("#");if(l=d.tokens[d.document.offsetAt({line:o,character:a})],l&&l.content.match(/^#include/i)){let e=l.data,c=null==e?void 0:e.data;if(c){a+=e.offset-l.offset;let d=i.Range.create(0,0,null!==(n=null===(t=r.lexers[c[1]])||void 0===t?void 0:t.document.lineCount)&&void 0!==n?n:0,0),u=a+e.content.replace(/\s+;.*$/,"").length,f=c[0]?s.URI.file((0,r.restorePath)(c[0])).toString():c[1];return[i.LocationLink.create(f,d,d,i.Range.create(o,a,o,u))]}}return}if(p=u.text.toLowerCase(),h=u.kind,!p||h===i.SymbolKind.Null)return;if(void 0!==(c=(0,o.searchNode)(d,p,u.range.end,h))||h!=i.SymbolKind.Property&&h!==i.SymbolKind.Method){if(null===c)return}else{let t={};if(c=[],(0,o.cleardetectcache)(),(0,o.detectExpType)(d,p.replace(/\.[^.]+$/,(e=>(p=e.match(/^\.[^.]+$/)?e:"",""))),e.position,t),p&&void 0===t["#any"])for(const e in t)null===(a=(0,o.searchNode)(d,e+p,u.range.end,h))||void 0===a||a.map((e=>{(null==c?void 0:c.map((e=>e.node)).includes(e.node))||null==c||c.push(e)}));if(!(null==c?void 0:c.length)&&h===i.SymbolKind.Method){c=[];let e=[d];p.replace(/\.([^.]+)$/,((...t)=>{var n;p=t[1];for(const t in d.relevance)e.push(r.lexers[t]);for(const t of e)(null===(n=t.object.method[p])||void 0===n?void 0:n.length)&&(null==c||c.push(...t.object.method[p].map((e=>({node:e,uri:t.uri})))));return""}))}}if(c){let e="";if(c.map((t=>{(e=t.node.uri||t.uri)&&f.push(i.Location.create(r.lexers[e].document.uri,t.node.selectionRange))})),f.length)return f}}}},2793:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.typeFormatting=t.rangeFormatting=t.documentFormatting=void 0;const i=n(2374),o=n(3939);t.documentFormatting=async function(e){var t;let n=o.lexers[e.textDocument.uri.toLowerCase()],r=i.Range.create(0,0,n.document.lineCount,0),s=Object.assign({},o.extsettings.FormatOptions);return null!==(t=s.indent_string)&&void 0!==t||(s.indent_string=e.options.insertSpaces?" ".repeat(e.options.tabSize):"\t"),[{range:r,newText:n.beautify(s)}]},t.rangeFormatting=async function(e){let t=o.lexers[e.textDocument.uri.toLowerCase()],n=e.range,i=Object.assign({},o.extsettings.FormatOptions);return i.indent_string=e.options.insertSpaces?" ".repeat(e.options.tabSize):"\t",[{range:n,newText:t.beautify(i,n).trim()}]},t.typeFormatting=async function(e){var t,n,r;let s,a,c,l,d=o.lexers[e.textDocument.uri.toLowerCase()],{ch:u,position:f}=e,p=Object.assign({},o.extsettings.FormatOptions);if("\n"===u){let i,{line:o,character:c}=f,u=d.document.getText({start:{line:o-1,character:0},end:{line:o+2,character:0}}).split(/\r?\n/),m=u[0].trimRight();if(p.indent_string=e.options.insertSpaces?" ".repeat(e.options.tabSize):"\t",u[1].trim()||(c=u[1].length),m.endsWith("{"))(s=h({line:o-1,character:m.length}))&&(i=null!==(t=s[0].range.indent_string)&&void 0!==t?t:"",u[1].substring(0,c)!==i&&s.push({newText:i,range:{start:{line:o,character:0},end:{line:o,character:c}}}),(m=(null!==(n=u[2])&&void 0!==n?n:u[2]="").trimLeft()).startsWith("}")&&!u[2].startsWith((i=i.replace(p.indent_string,""))+"}")&&s.push({newText:i,range:{start:{line:o+1,character:0},end:{line:o+1,character:u[2].length-m.length}}}));else if(void 0!==(l=d.linepos[o-1])){let e={start:d.document.positionAt(l),end:{line:o-1,character:m.length}};s=[{range:e,newText:d.beautify(p,e).trim()}],i=null!==(r=e.indent_string)&&void 0!==r?r:"",u[1].substring(0,c)!==i&&s.push({newText:i,range:{start:{line:o,character:0},end:{line:o,character:c}}})}else if(!m&&u[0]!==(u[1]=u[1].substring(0,c))){if(!u[0]){if(a=d.find_token(d.document.offsetAt(f)),"TK_STRING"===a.type||a.type.endsWith("COMMENT"))return;let e=["TK_START_EXPR","TK_START_BLOCK",""];for(;(a=a.previous_token)&&!e.includes(a.type););if(e.pop(),e.includes(null==a?void 0:a.type))return}s=[{newText:u[0],range:{start:{line:o,character:0},end:{line:o,character:c}}}]}return s}if("}"===u)return h(f);if(c=o.chinese_punctuations[u]){let e={line:f.line,character:f.character-1};if(a=d.find_token(d.document.offsetAt(e),!0),"TK_WORD"===a.type)return a.length>1&&(c=a.content.replace(/./g,(e=>{var t;return null!==(t=o.chinese_punctuations[e])&&void 0!==t?t:e})),e.character-=a.length-1),[i.TextEdit.replace({start:e,end:f},c)]}function h(e){var t;if(a=d.tokens[d.document.offsetAt({line:e.line,character:e.character-1})],l=null==a?void 0:a.previous_pair_pos,void 0!==l){for(;void 0!==(null===(t=a=d.tokens[l])||void 0===t?void 0:t.previous_pair_pos);)l=a.previous_pair_pos;let n={start:d.document.positionAt(l),end:e};return[{range:n,newText:d.beautify(p,n).trim()}]}}}},9541:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hoverProvider=void 0;const i=n(2374),o=n(6169),r=n(3939);t.hoverProvider=async function(e,t){var n,s;if(t.isCancellationRequested)return;let a,c=e.textDocument.uri.toLowerCase(),l=r.lexers[c],d=null==l?void 0:l.buildContext(e.position),u=[];if(d){let t,c=d.text.toLowerCase(),f=i.SymbolKind.Variable;if(!c||d.kind===i.SymbolKind.Null)return d.token&&(a=r.hoverCache[1])&&(a=a[d.token.content.toLowerCase()])?a[0]:void 0;if(void 0!==(t=(0,o.searchNode)(l,c,d.range.end,f=d.kind))||!c.includes(".")||f!=i.SymbolKind.Property&&f!==i.SymbolKind.Method){if(null===t)return}else{let i={};if(t=[],(0,o.cleardetectcache)(),(0,o.detectExpType)(l,c.replace(/\.[^.]+$/,(e=>(c=e.match(/^\.[^.]+$/)?e:"",""))),e.position,i),c&&void 0===i["#any"])for(const e in i)null===(n=(0,o.searchNode)(l,e+c,d.range.end,f))||void 0===n||n.map((e=>{(null==t?void 0:t.map((e=>e.node)).includes(e.node))||null==t||t.push(e)}));(null==t?void 0:t.length)||(t=void 0)}if(!t)if(f===i.SymbolKind.Method||f===i.SymbolKind.Property);else if(r.ahkvars[c])t=[{node:r.ahkvars[c],uri:""}];else if((a=r.hoverCache[f===i.SymbolKind.Function?0:1])&&(a=a[c]))return a[0];if(t){if(t.length>1)t.map((e=>{e.node.full&&u.push({kind:"ahk2",value:e.node.full})}));else{let{node:e,scope:n}=t[0];if(e.kind===i.SymbolKind.Function||e.kind===i.SymbolKind.Method||e.kind===i.SymbolKind.Property)e.full&&u.push({kind:"ahk2",value:e.full});else if(e.kind===i.SymbolKind.Class)u.push({kind:"ahk2",value:"class "+(e.full||e.name)});else if(n&&e.kind===i.SymbolKind.TypeParameter){let e=n.parent;(null==e?void 0:e.kind)===i.SymbolKind.Property&&(null===(s=e.parent)||void 0===s?void 0:s.kind)===i.SymbolKind.Class&&(n=e),(0,o.formatMarkdowndetail)(n)}if(e.detail){let t=(0,o.formatMarkdowndetail)(e);if(e.kind===i.SymbolKind.Variable){let i=/^/;t.startsWith("\n*@var* ")?(t=t.replace("  ","\n___\n"),i=/^\n\*@var\*\s/):t=t.startsWith("\n*@type* ")?t.replace("  ","\n___\n").replace(/^\n\*@type\*\s*/,`\`${e.name}\`: `):`\`${e.name}\`\n___\n${t}`,t=t.replace(i,n?e.static?"*@static* ":"*@local* ":"*@global* ")}u.push({kind:"markdown",value:(u.length?"___\n":"")+t})}}if(u.length)return{contents:{kind:"markdown",value:u.map((e=>"ahk2"===e.kind?"```ahk2\n"+e.value+"\n```":e.value)).join("\n\n")}}}}}},7994:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loadlocalize=t.setting=t.diagnostic=t.codeaction=t.completionitem=void 0;const i=n(1017),o=n(3939);let r={};function s(e,t){return(...n)=>n.length?function(e,...t){return e.replace(/\{(\d+)\}/g,((...e)=>{let n=parseInt(e[1]);return n<t.length?t[n]:" "}))}(a(e,t),...n):a(e,t)}function a(e,t){return r[e]||t}var c,l,d;(d=t.completionitem||(t.completionitem={})).author=s("completionitem.author","Add file infos about author, description, date, version."),d.comment=s("completionitem.generatecomment","Generate comment template of current function/method."),d.include=s("completionitem.include","Auto import from '{0}'"),d.prototype=s("completionitem.prototype","Retrieve or set the object on which all instances of the class are based."),d.thishotkey=s("completionitem.thishotkey","The hidden parameter to the hotkey function."),d.value=s("completionitem.value","Within the dynamic property 'set', 'Value' contains the value being assigned."),d._new=s("completionitem.new","export construct a new instance of the class."),d._this=s("completionitem.this","In the class, access other instance variables and methods of the class through 'this'."),d._super=s("completionitem.super","In the inherited class, 'super' can replace 'this' to access the superclass version of the method or property that is overridden in the derived class."),(t.codeaction||(t.codeaction={})).include=s("codeaction.include","Import '{0}'"),(l=t.diagnostic||(t.diagnostic={})).acceptparams=s("diagnostic.acceptparams","'{0}' accepts {1} parameter(s)"),l.assignerr=s("diagnostic.assignerr","This {0} '{1}' cannot be used as an output variable"),l.classinfuncerr=s("diagnostic.classinfuncerr","Functions cannot contain classes"),l.classuseerr=s("diagnostic.classuseerr","This class cannot be used as an output variable"),l.conflictserr=s("diagnostic.conflictserr","This {0} '{2}' declaration conflicts with an existing {1}"),l.declarationerr=s("diagnostic.declarationerr","Unexpected declaration"),l.defaultvalmissing=s("diagnostic.defaultvalmissing","Parameter default required. Specifically: '{0}'"),l.deprecated=s("diagnostic.deprecated","Using '{0}' instead of '{1}'"),l.dupdeclaration=s("diagnostic.dupdeclaration","Duplicate declaration"),l.duplabel=s("diagnostic.duplabel","Duplicate label"),l.filenotexist=s("diagnostic.filenotexist","'{0}' not exist"),l.funcassignerr=s("diagnostic.funcassignerr","This Func cannot be assigned a value"),l.funccallerr=s("diagnostic.funccallerr","Function calls require a space or '(',  use comma only between parameters"),l.globalconflicts=s("diagnostic.globalconflicts","This global declaration conflicts with an existing {0}"),l.hotdeferr=s("diagnostic.hotdeferr","Hotkeys/hotstrings cannot be defined in functions/classes"),l.hotmissbrace=s("diagnostic.hotmissbrace","Hotkey or hotstring is missing its opening brace"),l.invaliddefinition=s("diagnostic.invaliddefinition","Invalid {0} definition"),l.invalidhotdef=s("diagnostic.invalidhotdef","Invalid hotkey definition"),l.invalidparam=s("diagnostic.invalidparam","Invalid parameter definition"),l.invalidprop=s("diagnostic.invalidprop","Invalid dynamic property"),l.invalidpropname=s("diagnostic.invalidpropname","Invalid property name in object literal"),l.invalidsymbolname=s("diagnostic.invalidsymbolname","Invalid symbol naming '{0}'"),l.maybehavenotmember=s("diagnostic.maybehavenotmember","Class '{0}' maybe have not member '{1}'"),l.missing=s("diagnostic.missing","Missing '{0}'"),l.missingparam=s("diagnostic.missingparam","Missing a required parameter"),l.objectliteralerr=s("diagnostic.objectliteralerr","Error in object literal"),l.pathinvalid=s("diagnostic.pathinvalid","Invalid file path"),l.paramcounterr=s("diagnostic.paramcounterr","Expected {0} parameters, but got {1}"),l.propdeclaraerr=s("diagnostic.propdeclaraerr","Not a valid method, class or property definition"),l.propemptyparams=s("diagnostic.propemptyparams","Empty [] not permitted"),l.propnotinit=s("diagnostic.propnotinit","Property declaration is not initialized"),l.reservedworderr=s("diagnostic.reservedworderr","The following reserved word '{0}' must not be used as a variable name"),l.typemaybenot=s("diagnostic.typemaybenot","Type maybe not '{0}'"),l.resourcenotfound=s("diagnostic.resourcenotfound","No resource found or could not be resolved"),l.unexpected=s("diagnostic.unexpected","Unexpected '{0}'"),l.unknown=s("diagnostic.unknown","Unknown {0}"),l.invalidencoding=s("diagnostic.invalidencoding","'{0}' invalid file encoding"),l.unknownoperatoruse=s("diagnostic.unknownoperatoruse","Unknown operator use"),l.unknowntoken=s("diagnostic.unknowntoken","Unknown token '{0}'"),l.unsupportinclude=s("diagnostic.unsupportinclude","#Include in functions and classes cannot correctly deduce scope and code completion"),l.unterminated=s("diagnostic.unterminated","Unterminated string text"),(c=t.setting||(t.setting={})).ahkpatherr=s("setting.ahkpatherr","The AutoHotkey interpreter does not exist, re-specify in'Settings-AutoHotkey2.InterpreterPath'"),c.getenverr=s("setting.getenverr","Failed to get environment variables"),c.uialimit=s("setting.uialimit","The UIA executable does not allow redirection to stdin/stdout due to security restrictions, so some features that depend on this will not work"),c.versionerr=s("setting.versionerr","The current AutoHotkey.exe is not the v2 version, and cannot get the correct syntax analysis, completion and other functions"),t.loadlocalize=function(){if(o.inBrowser){let e=(0,o.getwebfile)(o.dirname+"/package.nls.<>.json");e&&(r=JSON.parse(e.text))}else{let e=(0,o.getlocalefile)((0,i.resolve)(__dirname,"../../package.nls.<>.json"),"utf8");r=e?JSON.parse(e):{}}}},6658:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.findAllVar=t.findAllFromDoc=t.getAllReferences=t.referenceProvider=void 0;const i=n(2374),o=n(6169),r=n(3939);function s(e,t){let n=t.text.toLowerCase(),s={};if(!t.text)return;let c=(0,o.searchNode)(e,n,t.range.end,t.kind);if(!c||c.length>1)return;let{node:l,uri:d}=c[0];if(!d||l===r.ahkvars[n]||n.match(/^(this|super)$/)&&l.kind===i.SymbolKind.Class&&!l.name.match(/^(this|super)$/i))return;let u=l===e.declaration[n]?void 0:e.searchScopedNode(l.selectionRange.start);switch(l.kind){case i.SymbolKind.Field:if(u){let e=u.labels;e&&e[n]&&(s[r.lexers[d].document.uri]=e[n].map((e=>e.selectionRange)))}else{let t=e.labels;t[n]&&(s[e.document.uri]=t[n].map((e=>e.selectionRange)));for(const i in e.relevance)t=r.lexers[i].labels,t[n]&&(s[r.lexers[i].document.uri]=t[n].map((e=>e.selectionRange)))}break;case i.SymbolKind.Function:case i.SymbolKind.Variable:case i.SymbolKind.TypeParameter:case i.SymbolKind.Class:if(l.kind!==i.SymbolKind.Class||!l.full.includes(".")){u&&(u.kind!==i.SymbolKind.Class&&u.kind!==i.SymbolKind.Function&&u.kind!==i.SymbolKind.Method&&u.kind!==i.SymbolKind.Event||u.global&&u.global[n]&&(u=void 0));let t=a(e=r.lexers[d],n,i.SymbolKind.Variable,u);if(t.length&&(s[e.document.uri]=t),!u)for(const t in e.relevance){let e=a(r.lexers[t],n,i.SymbolKind.Variable,void 0);e.length&&(s[r.lexers[t].document.uri]=e)}break}default:if(l.kind===i.SymbolKind.Class||l.static){let t=n.split("."),o=a(e,t[0],i.SymbolKind.Variable),c={};t.splice(0,1),o.length&&(c[e.document.uri]=o);for(const t in e.relevance){let e=a(r.lexers[t],n,i.SymbolKind.Variable,void 0);e.length&&(c[r.lexers[t].document.uri]=e)}for(const e in c){let n=c[e],i=r.lexers[e.toLowerCase()],o=[];for(let e of n){let n,r=0,s=i.document.offsetAt(e.end);for(;r<t.length&&(n=i.get_token(s,!0),"TK_DOT"===n.type&&"TK_WORD"===(n=i.find_token(n.offset+n.length)).type&&n.content.toLowerCase()===t[r]);)s=n.offset+n.length,r++;r===t.length&&n&&o.push({start:i.document.positionAt(n.offset),end:i.document.positionAt(n.offset+n.length)})}o.length&&(s[i.document.uri]=o)}let u=r.lexers[d].document.uri;s[u]?s[u].unshift(l.selectionRange):s[u]=[l.selectionRange];break}return}return Object.keys(s).length?s:void 0}function a(e,t,n,o){var r,s,a,l,d,u,f,p,h;let m=[];if(n===i.SymbolKind.Method||n===i.SymbolKind.Property);else{let n=null!=o?o:e,g=!o,y=g,v=!(null===(a=null===(s=null===(r=n)||void 0===r?void 0:r.local)||void 0===s?void 0:s[t])||void 0===a?void 0:a.static);if(v&&o&&null===(null===(u=null===(d=null===(l=n)||void 0===l?void 0:l.declaration)||void 0===d?void 0:d[t])||void 0===u?void 0:u.static)&&(v=!1),n.kind===i.SymbolKind.Property&&(null===(f=n.parent)||void 0===f?void 0:f.kind)===i.SymbolKind.Class)null===(p=n.children)||void 0===p||p.map((e=>{var n;e.kind===i.SymbolKind.Function&&(null===(n=e.children)||void 0===n||n.map((e=>{e.name.toLowerCase()===t&&m.push(e.selectionRange),e.children&&c(e,t,g,m,g,v)})))}));else{if(!y){let e=n.local,i=n.declaration;e&&e[t]||i&&i[t]||(y=void 0)}null===(h=n.children)||void 0===h||h.map((e=>{e.name.toLowerCase()===t&&m.push(e.selectionRange),e.children&&c(e,t,g,m,g||e.kind===i.SymbolKind.Function?y:void 0,v)}))}}return m}function c(e,t,n=!1,r,s,a){var l,d,u,f,p,h,m,g,y;let v,b=e.kind===i.SymbolKind.Function&&e.static,_=b||e.closure;if(!b||!a||n){if(e.assume===o.FuncScope.GLOBAL||(null===(l=e.global)||void 0===l?void 0:l[t])){if(!n)return;s=!0}else if(_&&e.local&&e.local[t]||!_&&(null===(d=e.declaration)||void 0===d?void 0:d[t])){if(!n)return;s=!1}else!b||!n||s||(v=null===(u=e.declaration)||void 0===u?void 0:u[t])&&(v.kind!==i.SymbolKind.Variable||v.def)?s&&(null===(f=e.declaration)||void 0===f?void 0:f[t])&&(s=!1):s=!0;a&&(a=!(null===(m=null===(h=null===(p=e)||void 0===p?void 0:p.local)||void 0===h?void 0:h[t])||void 0===m?void 0:m.static)),s===n?null===(g=e.children)||void 0===g||g.map((e=>{e.name.toLowerCase()===t&&e.kind!==i.SymbolKind.Property&&e.kind!==i.SymbolKind.Method&&e.kind!==i.SymbolKind.Class&&r.push(e.selectionRange),e.children&&c(e,t,n,r,e.kind===i.SymbolKind.Function?s:n||void 0,a)})):null===(y=e.children)||void 0===y||y.map((e=>{e.children&&c(e,t,n,r,!n&&void 0,a)}))}}t.referenceProvider=async function(e){let t=[],n=r.lexers[e.textDocument.uri.toLowerCase()],i=s(n,n.buildContext(e.position));for(const e in i)t.push(...i[e].map((t=>({uri:e,range:t}))));return t},t.getAllReferences=s,t.findAllFromDoc=a,t.findAllVar=c},5932:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.renameProvider=t.prepareRename=void 0;const i=n(6658),o=n(3939);let r;t.prepareRename=async function(e){let t=o.lexers[e.textDocument.uri.toLowerCase()],n=t.buildContext(e.position);if(r=(0,i.getAllReferences)(t,n))return{range:n.range,placeholder:n.text.split(".").pop()||""}},t.renameProvider=async function(e){let t={changes:{}},n=e.newName;for(const e in r)t.changes[e]=r[e].map((e=>({range:e,newText:n})));return t}},9770:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.runscript=void 0;const i=n(2081),o=n(3939),r=n(7147);t.runscript=function(e,t){var n;let s=o.ahkpath_cur||o.extsettings.InterpreterPath;if((0,r.existsSync)(s)){const o=(0,i.spawnSync)(`"${s}" /CP65001 /ErrorStdOut=utf-8 *`,[],{cwd:s.replace(/[\\/].+?$/,""),shell:!0,input:e});if(o)return t&&t((null!==(n=o.stdout)&&void 0!==n?n:"").toString()),!0}return!1}},6001:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.semanticTokensOnRange=t.semanticTokensOnDelta=t.semanticTokensOnFull=void 0;const i=n(2374),o=n(6169),r=n(3939),s=n(5116);let a,c=new Map;function l(e,t){var n,l,d,u;let f,p;if(p=e.semantic){let u=null!==(n=e.pos)&&void 0!==n?n:e.pos=t.document.positionAt(e.offset),f=p.type;if(f===o.SemanticTokenTypes.string)if(e.ignore){let n=u.line+1,i=e.data;for(let e=0;e<i.length;e++)t.STB.push(n++,0,i[e],f,0)}else t.STB.push(u.line,u.character,e.length,f,0);else(a&&(f===o.SemanticTokenTypes.method||f===o.SemanticTokenTypes.property)&&"TK_DOT"===(null===(l=e.previous_token)||void 0===l?void 0:l.type)||(a=void 0,f===o.SemanticTokenTypes.class))&&(f=function(e,t,n){var l;let d=t.semantic;switch(d.type){case o.SemanticTokenTypes.class:return a=s.globalsymbolcache[e],(null==a?void 0:a.kind)!==i.SymbolKind.Class&&(a=void 0),o.SemanticTokenTypes.class;case o.SemanticTokenTypes.method:case o.SemanticTokenTypes.property:if(a){let u,f=a.staticdeclaration[e],p=null==f?void 0:f.kind;if(!f||!1===f.def){let t=(null!==(l=c.get(a))&&void 0!==l?l:(c.set(a,u=(0,o.getClassMembers)(n,a,!0)),u))[e];t&&(f=t,p=t.kind)}switch(p){case i.SymbolKind.Method:return d.modifier=(d.modifier||0)|1<<o.SemanticTokenModifiers.readonly|1<<o.SemanticTokenModifiers.static,t.callinfo&&(0,s.checkParams)(n,f,t.callinfo),a=void 0,d.type=o.SemanticTokenTypes.method;case i.SymbolKind.Class:return d.modifier=(d.modifier||0)|1<<o.SemanticTokenModifiers.readonly,a=a.staticdeclaration[e],t.callinfo&&(0,s.checkParams)(n,a,t.callinfo),d.type=o.SemanticTokenTypes.class;case i.SymbolKind.Property:let c=f.children;return 1===(null==c?void 0:c.length)&&"get"===c[0].name&&(d.modifier=(d.modifier||0)|1<<o.SemanticTokenModifiers.readonly|1<<o.SemanticTokenModifiers.static),a=void 0,d.type=o.SemanticTokenTypes.property;case void 0:if(!1!==a.checkmember&&r.extsettings.Diagnostics.ClassStaticMemberCheck){let e=n.tokens[t.next_token_offset];e&&":="===e.content||n.addDiagnostic(r.diagnostic.maybehavenotmember(a.name,t.content),t.offset,t.length,2)}}}default:return a=void 0,d.type}}(e.content.toLowerCase(),e,t)),t.STB.push(u.line,u.character,e.length,f,null!==(d=p.modifier)&&void 0!==d?d:0)}else if(a&&"TK_DOT"!==e.type&&!e.type.endsWith("COMMENT"))a=void 0;else if("TK_WORD"===e.type&&["this","super"].includes(f=e.content.toLowerCase())&&"TK_DOT"!==(null===(u=e.previous_token)||void 0===u?void 0:u.type)){let n=t.searchNode(f,t.document.positionAt(e.offset),i.SymbolKind.Variable);n&&!1===n.ref&&(a=n.node)}}t.semanticTokensOnFull=async function(e){let t=r.lexers[e.textDocument.uri.toLowerCase()];return t.STB.previousResult(""),a=void 0,c.clear(),await(0,s.symbolProvider)({textDocument:e.textDocument}),Object.values(t.tokens).forEach((e=>l(e,t))),c.clear(),t.STB.build()},t.semanticTokensOnDelta=async function(e){let t=r.lexers[e.textDocument.uri.toLowerCase()];return t.STB.previousResult(""),a=void 0,c.clear(),await(0,s.symbolProvider)({textDocument:e.textDocument}),Object.values(t.tokens).forEach((e=>l(e,t))),c.clear(),t.STB.buildEdits()},t.semanticTokensOnRange=async function(e){let t=r.lexers[e.textDocument.uri.toLowerCase()],n=t.document.offsetAt(e.range.start),i=t.document.offsetAt(e.range.end);t.STB.previousResult(""),a=void 0,c.clear(),await(0,s.symbolProvider)({textDocument:e.textDocument});for(let e of Object.values(t.tokens))if(!(e.offset<n)){if(e.offset>i)break;l(e,t)}return c.clear(),t.STB.build()}},5373:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.signatureProvider=void 0;const i=n(2374),o=n(6169),r=n(3939),s=n(6288);t.signatureProvider=async function(e,t){var n,a,c;if(t.isCancellationRequested)return;let l,d,u,f,p,h=e.textDocument.uri.toLowerCase(),m=r.lexers[h],g=i.SymbolKind.Function,y={activeSignature:0,signatures:[],activeParameter:0};if(!(d=(0,o.getFuncCallInfo)(m,e.position))||d.index<0)return;u=d.name,f=d.pos,p=d.index,f.character>0&&"."===m.document.getText(i.Range.create({line:f.line,character:f.character-1},f))&&(g=i.SymbolKind.Method);let v,b={};if((0,o.cleardetectcache)(),g===i.SymbolKind.Method||d.full){let e=d.full;e||(e=m.buildContext(f).text.toLowerCase()),(0,o.detectExpType)(m,e,f,b)}else(0,o.detectExpType)(m,u,f,b);if(l=Object.values(b).filter((e=>null==e?void 0:e.node)),v=null!=l?l:[],l=[],v.map((e=>{var t;let n=e.node,s=n.kind;if(s===i.SymbolKind.Class){let i=(0,o.getClassMembers)(r.lexers[n.uri||e.uri]||m,n,!e.ref),s=e.ref?i.call:null!==(t=i.__new)&&void 0!==t?t:i.call;i.call&&!1!==i.call.def&&(s=i.call),s&&l.push({node:s,uri:""})}else s!==i.SymbolKind.Function&&s!==i.SymbolKind.Method||l.push(e)})),!l.length){if(g!==i.SymbolKind.Method)return;l=[];for(const e in r.ahkvars)null===(n=r.ahkvars[e].children)||void 0===n||n.map((e=>{e.kind!==i.SymbolKind.Method||e.name.toLowerCase()!==u||l.map((e=>e.node)).includes(e)||l.push({node:e,uri:""})}));null===(a=m.object.method[u])||void 0===a||a.map((e=>{null==l||l.push({node:e,uri:""})}));for(const e in m.relevance)null===(c=r.lexers[e].object.method[u])||void 0===c||c.map((e=>{null==l||l.push({node:e,uri:""})}));if(!(null==l?void 0:l.length))return}return l.map((e=>{var t,n;const i=e.node,r=[];let a,c;if((a=i.params)&&y.signatures.push({label:i.full,parameters:a.map((e=>({label:e.name.trim().replace(/(['\w]*\|['\w]*)(\|['\w]*)+/,"$1|...")}))),documentation:i.detail?{kind:"markdown",value:(0,o.formatMarkdowndetail)(i,c=null!==(n=null===(t=a[p])||void 0===t?void 0:t.name)&&void 0!==n?n:"",r)}:void 0}),r.length){let e=new o.Lexer(s.TextDocument.create("","ahk2",-10,r.join("\n")),void 0,-1),{label:t,documentation:n}=y.signatures[0],l=i;t=t.replace(new RegExp(`(?<=\\b${i.name})\\(.+$`),""),e.parseScript(),e.children.map((e=>{var i,r,s;(a=e.params)&&y.signatures.push({label:t+e.full.replace(/^[^(]+/,""),parameters:a.map((e=>({label:e.name.trim().replace(/(['\w]*\|['\w]*)(\|['\w]*)+/,"$1|...")}))),documentation:c===(null===(i=a[p])||void 0===i?void 0:i.name)?n:{kind:"markdown",value:(0,o.formatMarkdowndetail)(l,null!==(s=null===(r=a[p])||void 0===r?void 0:r.name)&&void 0!==s?s:"",[])}})}))}})),y.activeParameter=p,y}},5116:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.workspaceSymbolProvider=t.checkParams=t.symbolProvider=t.globalsymbolcache=void 0;const i=n(2374),o=n(6169),r=n(7994),s=n(3939),a=n(6630),c=n(6288);async function l(e){var n;let a=e.textDocument.uri.toLowerCase(),c=s.lexers[a];if(!c||!c.reflat&&s.symbolcache[a])return s.symbolcache[a];let l={},u=c.declaration;for(const e in s.ahkvars)l[e]=s.ahkvars[e];let f=c.relevance;for(const e in f){const t=null===(n=s.lexers[e])||void 0===n?void 0:n.declaration;for(let n in t)l[n]&&t[n].kind===i.SymbolKind.Variable||(l[n]=t[n],t[n].uri=e)}for(const e in u)l[e]&&l[e].kind!==i.SymbolKind.Variable&&(l[e]!==s.ahkvars[e]||u[e].kind===i.SymbolKind.Variable||l[e].kind!==i.SymbolKind.Function&&!1!==l[e].def)||(l[e]=u[e],u[e].uri=a);c.reflat=!1,t.globalsymbolcache=l;let p=c.document.uri;return s.symbolcache[a]=function e(t,n={},r=!1){var a,u;const f=[],p=[];let m;return n.isset=s.ahkvars.isset,null===(a=t.children)||void 0===a||a.map((e=>{var t;if(e.children&&p.push(e),e.name)if(e.kind===i.SymbolKind.Function||e.kind===i.SymbolKind.Variable||e.kind===i.SymbolKind.Class){let o=e.name.toLowerCase();n[o]?e.kind===i.SymbolKind.Variable?e!==n[o]&&(n[o].kind!==i.SymbolKind.TypeParameter||n[o].selectionRange.start.character!==n[o].selectionRange.end.character?h(e,n[o]===s.ahkvars[o],n[o].kind):(m=c.tokens[c.document.offsetAt(e.selectionRange.start)])&&m.semantic&&delete m.semantic):e!==n[o]?(f.push(e),n[o]=e,h(e,e===s.ahkvars[o])):e===l[o]&&(f.push(e),h(e,e===s.ahkvars[o])):e.kind===i.SymbolKind.Variable&&!e.def&&l[o]?(n[o]=l[o],e===l[o]&&f.push(e),h(e,l[o]===s.ahkvars[o],l[o].kind)):(n[o]=e,f.push(e),e.kind===i.SymbolKind.Class&&e.parent||h(e,s.ahkvars[o]&&l[o]===s.ahkvars[o],(null===(t=l[o])||void 0===t?void 0:t.kind)||e.kind))}else e.kind!==i.SymbolKind.TypeParameter&&(f.push(e),e.kind!==i.SymbolKind.Method&&e.kind!==i.SymbolKind.Property||!e.name.match(/^__(new|init|enum|get|call|set|delete)$/i)||(m=c.tokens[c.document.offsetAt(e.selectionRange.start)])&&m.semantic&&delete m.semantic)})),null===(u=t.funccall)||void 0===u||u.map((e=>{e.kind===i.SymbolKind.Function&&d(c,n[e.name.toLowerCase()],e)})),p.map((t=>{var s,a,c;if(t.children){let d={},u=!1;if(t.kind===i.SymbolKind.Function||t.kind===i.SymbolKind.Method||t.kind===i.SymbolKind.Event){let e=t,p={},m="",g=t.kind===i.SymbolKind.Function&&t.static;for(const t in e.global)d[t]=e.global[t];null===(s=t.params)||void 0===s||s.map((e=>{d[m=e.name.toLowerCase()]=e,p[m]=!0,h(e,!1,i.SymbolKind.TypeParameter)}));for(const t in e.local)if(t&&!p[t]){let n=e.local[t];f.push(n),h(n),d[t]=n}if(e.assume===o.FuncScope.GLOBAL||r)u=!0;else{u=!1;let o=t.parent,r=e.declaration;if(o){if(o.kind===i.SymbolKind.Property&&(null===(a=o.children)||void 0===a?void 0:a.length)&&(null===(c=o.parent)||void 0===c?void 0:c.kind)===i.SymbolKind.Class&&(o=o.parent),o.kind===i.SymbolKind.Class){let e=i.Range.create(0,0,0,0);d.this=i.DocumentSymbol.create("this",void 0,i.SymbolKind.TypeParameter,e,e),o.extends&&(d.super=i.DocumentSymbol.create("super",void 0,i.SymbolKind.TypeParameter,e,e))}if(o.kind===i.SymbolKind.Function||o.kind===i.SymbolKind.Method||o.kind===i.SymbolKind.Event)if(g)for(const e in n)d[e]||!n[e].static&&n[e]!==l[e]||(d[e]=n[e]);else for(const e in n)d[e]||(d[e]=n[e])}for(const e in r)e&&(d[e]?r[e]!==d[e]?r[e].kind!==i.SymbolKind.Variable||d[e]===l[e]&&r[e].def?(d[e]=r[e],f.push(r[e]),h(r[e])):h(r[e],!1,d[e].kind):p[e]||h(r[e]):(d[e]=r[e],f.push(d[e]),h(r[e])))}}else if(t.kind===i.SymbolKind.Class){let e=i.Range.create(0,0,0,0);d.this=i.DocumentSymbol.create("this",void 0,i.SymbolKind.TypeParameter,e,e),t.extends&&(d.super=i.DocumentSymbol.create("super",void 0,i.SymbolKind.TypeParameter,e,e))}f.push(...e(t,d,u))}})),f}(c).map((e=>i.SymbolInformation.create(e.name,e.kind,e.children?e.range:e.selectionRange,p,e.kind===i.SymbolKind.Class&&e.extends?e.extends:void 0))),c.actived&&(function(e){var t;let n,a={},c={};if(e.d)return;Object.keys(e.labels).map((e=>c[e]=!0));for(const e in s.ahkvars){let t=s.ahkvars[e];a[e]=t,t.kind!==i.SymbolKind.Function&&"struct"!==t.name.toLowerCase()||(t.def=!1)}for(const t in e.relevance)if(n=s.lexers[t]){n.diagnostics.splice(n.diags),(0,o.checksamenameerr)(a,Object.values(n.declaration).filter((e=>e.kind!==i.SymbolKind.Variable)),n.diagnostics);for(const e in n.labels)n.labels[e][0].def&&(c[e]?n.diagnostics.push({message:r.diagnostic.duplabel(),range:n.labels[e][0].selectionRange,severity:1}):c[e]=!0)}let l=Object.values(e.declaration);(0,o.checksamenameerr)(a,l,e.diagnostics);for(const t in e.relevance)(n=s.lexers[t])&&(0,o.checksamenameerr)(a,Object.values(n.declaration).filter((e=>e.kind===i.SymbolKind.Variable)),n.diagnostics);l.map((t=>{var n;if(t.kind===i.SymbolKind.Class){let i=null===(n=t.extends)||void 0===n?void 0:n.toLowerCase();i===t.name.toLowerCase()?u(e,t,!1):i&&!d(i)&&u(e,t)}}));for(const o in e.relevance)if(n=s.lexers[o])for(const e of Object.values(n.declaration))if(e.kind===i.SymbolKind.Class){let i=null===(t=e.extends)||void 0===t?void 0:t.toLowerCase();i===e.name.toLowerCase()?u(n,e,!1):i&&!d(i)&&u(n,e)}function d(e){let t,n=e.toLowerCase().split("."),o=n.length;for(let e=0;e<o;e++)if(t=t?t.staticdeclaration[n[e]]:a[n[e]],!t||t.kind!==i.SymbolKind.Class||!1===t.def)return!1;return!0}function u(e,t,n=!0){let o,s=e.document.offsetAt(t.selectionRange.start),a=e.tokens;o=a[a[s].next_token_offset],o=a[o.next_token_offset],s=o.offset;let c={start:e.document.positionAt(s),end:e.document.positionAt(s+t.extends.length)};e.diagnostics.push({message:n?r.diagnostic.unknown("class '"+t.extends)+"'":r.diagnostic.unexpected(t.extends),range:c,severity:i.DiagnosticSeverity.Warning})}}(c),setTimeout(s.sendDiagnostics,200)),s.symbolcache[a];function h(e,t=!1,n){let r,s,a,l;switch(n||e.kind){case i.SymbolKind.TypeParameter:if(0===e.range.start.line&&0===e.range.start.character)return;a=o.SemanticTokenTypes.parameter;break;case i.SymbolKind.Variable:a=o.SemanticTokenTypes.variable;break;case i.SymbolKind.Class:a=o.SemanticTokenTypes.class;break;case i.SymbolKind.Function:a=o.SemanticTokenTypes.function}void 0!==a&&(r=c.tokens[l=c.document.offsetAt(e.selectionRange.start)])&&(void 0===(s=r.semantic)?(r.semantic=s={type:a},e.kind!==i.SymbolKind.Variable||!e.def||n!==i.SymbolKind.Class&&n!==i.SymbolKind.Function||c.addDiagnostic((0,o.samenameerr)(e,{kind:n}),l,e.name.length)):void 0!==n&&(s.type=a),a<3&&(s.modifier=(s.modifier||0)|1<<o.SemanticTokenModifiers.readonly|(t?1<<o.SemanticTokenModifiers.defaultLibrary:0)))}}function d(e,t,n){var a,c,l;let d=n.paraminfo;if(s.extsettings.Diagnostics.ParamsCheck&&d){if(t&&t.kind===i.SymbolKind.Class){let n=t;if(!(t=null!==(a=n.staticdeclaration.call)&&void 0!==a?a:n.declaration.__new)&&n.extends){let i=(0,o.getClassMembers)(e,n,!0);t=i.call&&!1!==i.call.def?i.call:null!==(c=i.__new)&&void 0!==c?c:i.call}}if(t&&(t.kind===i.SymbolKind.Function||t.kind===i.SymbolKind.Method)){let i=t.params.length,o=!1,s=d.count,a={};if(o=t.full.includes("*")){for(i>0&&t.params[i-1].arr&&i--;i>0&&void 0!==t.params[i-1].defaultVal;)--i;for(let e=0;e<i;++e)!1===t.params[e].defaultVal&&--i;s<i&&!d.unknown&&e.diagnostics.push({message:r.diagnostic.paramcounterr(i+"+",s),range:n.range,severity:1}),d.miss.map((o=>{var s;a[o]=!0,o<i&&void 0===t.params[o].defaultVal&&e.addDiagnostic(r.diagnostic.missingparam(),null!==(s=d.comma[o])&&void 0!==s?s:e.document.offsetAt(n.range.end),1)}))}else{let o=i,c=d.miss.length,u=0;for(;i>0&&void 0!==t.params[i-1].defaultVal;)--i;for(let e=0;e<i;++e)!1===t.params[e].defaultVal&&--i;for(;c>0;)(u=d.miss[c-1])>=o?u+1===s&&--s:void 0===t.params[u].defaultVal&&e.addDiagnostic(r.diagnostic.missingparam(),null!==(l=d.comma[u])&&void 0!==l?l:e.document.offsetAt(n.range.end),1),a[u]=!0,--c;(s<i&&!d.unknown||s>o)&&e.diagnostics.push({message:r.diagnostic.paramcounterr(i===o?o:i+"-"+o,s),range:n.range,severity:1})}t.hasref&&t.params.map(((t,i)=>{if(i<s&&t.ref&&!a[i]){let t,o;t=0===i?n.offset+n.name.length+1:d.comma[i-1]+1,"&"!==(o=e.find_token(t)).content&&e.addDiagnostic(r.diagnostic.typemaybenot("VarRef"),o.offset,o.length,2)}}))}}}t.globalsymbolcache={},t.symbolProvider=l,t.checkParams=d,t.workspaceSymbolProvider=async function(e){let t=[],n=0,i=e.query;if(!i||!i.match(/^(\w|[^\x00-\x7f])+$/))return t;let r=new RegExp(i.replace(/(?<=[^A-Z])([A-Z])/g,".*$1"),"i");for(let e in s.lexers)if(await d(e))return t;if(s.inBrowser){let e=await s.connection.sendRequest("ahk2.getWorkspaceFiles",[])||[];for(let n of e){let e,i=n.toLowerCase();if(!s.lexers[i]){let r=await s.connection.sendRequest("ahk2.getWorkspaceFileContent",[n]);if(e=new o.Lexer(c.TextDocument.create(n,"ahk2",-10,r)),e.parseScript(),s.lexers[i]=e,await d(i))return t}}}else{let e,n,i;for(let r of s.workspaceFolders){r=a.URI.parse(r).fsPath;for(let c of(0,s.getallahkfiles)(r))if(e=a.URI.file(c).toString().toLowerCase(),!s.lexers[e]&&(i=(0,s.openFile)(c))&&(n=new o.Lexer(i),n.parseScript(),s.lexers[e]=n,await d(e)))return t}}return t;async function d(e){for(let i of await l({textDocument:{uri:e}}))if(r.test(i.name)&&(t.push(i),++n>=1e3))return!0;return!1}}},5748:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.Trace=t.ProgressType=t.createMessageConnection=t.NullLogger=t.ConnectionOptions=t.ConnectionStrategy=t.WriteableStreamMessageWriter=t.AbstractMessageWriter=t.MessageWriter=t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=t.CancellationToken=t.CancellationTokenSource=t.Emitter=t.Event=t.Disposable=t.ParameterStructures=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=t.NotificationType2=t.NotificationType1=t.NotificationType0=t.NotificationType=t.ErrorCodes=t.ResponseError=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType0=t.RequestType=t.RAL=void 0,t.CancellationStrategy=void 0;const i=n(5285);Object.defineProperty(t,"RequestType",{enumerable:!0,get:function(){return i.RequestType}}),Object.defineProperty(t,"RequestType0",{enumerable:!0,get:function(){return i.RequestType0}}),Object.defineProperty(t,"RequestType1",{enumerable:!0,get:function(){return i.RequestType1}}),Object.defineProperty(t,"RequestType2",{enumerable:!0,get:function(){return i.RequestType2}}),Object.defineProperty(t,"RequestType3",{enumerable:!0,get:function(){return i.RequestType3}}),Object.defineProperty(t,"RequestType4",{enumerable:!0,get:function(){return i.RequestType4}}),Object.defineProperty(t,"RequestType5",{enumerable:!0,get:function(){return i.RequestType5}}),Object.defineProperty(t,"RequestType6",{enumerable:!0,get:function(){return i.RequestType6}}),Object.defineProperty(t,"RequestType7",{enumerable:!0,get:function(){return i.RequestType7}}),Object.defineProperty(t,"RequestType8",{enumerable:!0,get:function(){return i.RequestType8}}),Object.defineProperty(t,"RequestType9",{enumerable:!0,get:function(){return i.RequestType9}}),Object.defineProperty(t,"ResponseError",{enumerable:!0,get:function(){return i.ResponseError}}),Object.defineProperty(t,"ErrorCodes",{enumerable:!0,get:function(){return i.ErrorCodes}}),Object.defineProperty(t,"NotificationType",{enumerable:!0,get:function(){return i.NotificationType}}),Object.defineProperty(t,"NotificationType0",{enumerable:!0,get:function(){return i.NotificationType0}}),Object.defineProperty(t,"NotificationType1",{enumerable:!0,get:function(){return i.NotificationType1}}),Object.defineProperty(t,"NotificationType2",{enumerable:!0,get:function(){return i.NotificationType2}}),Object.defineProperty(t,"NotificationType3",{enumerable:!0,get:function(){return i.NotificationType3}}),Object.defineProperty(t,"NotificationType4",{enumerable:!0,get:function(){return i.NotificationType4}}),Object.defineProperty(t,"NotificationType5",{enumerable:!0,get:function(){return i.NotificationType5}}),Object.defineProperty(t,"NotificationType6",{enumerable:!0,get:function(){return i.NotificationType6}}),Object.defineProperty(t,"NotificationType7",{enumerable:!0,get:function(){return i.NotificationType7}}),Object.defineProperty(t,"NotificationType8",{enumerable:!0,get:function(){return i.NotificationType8}}),Object.defineProperty(t,"NotificationType9",{enumerable:!0,get:function(){return i.NotificationType9}}),Object.defineProperty(t,"ParameterStructures",{enumerable:!0,get:function(){return i.ParameterStructures}});const o=n(8159);Object.defineProperty(t,"Disposable",{enumerable:!0,get:function(){return o.Disposable}});const r=n(345);Object.defineProperty(t,"Event",{enumerable:!0,get:function(){return r.Event}}),Object.defineProperty(t,"Emitter",{enumerable:!0,get:function(){return r.Emitter}});const s=n(7770);Object.defineProperty(t,"CancellationTokenSource",{enumerable:!0,get:function(){return s.CancellationTokenSource}}),Object.defineProperty(t,"CancellationToken",{enumerable:!0,get:function(){return s.CancellationToken}});const a=n(4806);Object.defineProperty(t,"MessageReader",{enumerable:!0,get:function(){return a.MessageReader}}),Object.defineProperty(t,"AbstractMessageReader",{enumerable:!0,get:function(){return a.AbstractMessageReader}}),Object.defineProperty(t,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return a.ReadableStreamMessageReader}});const c=n(9248);Object.defineProperty(t,"MessageWriter",{enumerable:!0,get:function(){return c.MessageWriter}}),Object.defineProperty(t,"AbstractMessageWriter",{enumerable:!0,get:function(){return c.AbstractMessageWriter}}),Object.defineProperty(t,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return c.WriteableStreamMessageWriter}});const l=n(6336);Object.defineProperty(t,"ConnectionStrategy",{enumerable:!0,get:function(){return l.ConnectionStrategy}}),Object.defineProperty(t,"ConnectionOptions",{enumerable:!0,get:function(){return l.ConnectionOptions}}),Object.defineProperty(t,"NullLogger",{enumerable:!0,get:function(){return l.NullLogger}}),Object.defineProperty(t,"createMessageConnection",{enumerable:!0,get:function(){return l.createMessageConnection}}),Object.defineProperty(t,"ProgressType",{enumerable:!0,get:function(){return l.ProgressType}}),Object.defineProperty(t,"Trace",{enumerable:!0,get:function(){return l.Trace}}),Object.defineProperty(t,"TraceFormat",{enumerable:!0,get:function(){return l.TraceFormat}}),Object.defineProperty(t,"SetTraceNotification",{enumerable:!0,get:function(){return l.SetTraceNotification}}),Object.defineProperty(t,"LogTraceNotification",{enumerable:!0,get:function(){return l.LogTraceNotification}}),Object.defineProperty(t,"ConnectionErrors",{enumerable:!0,get:function(){return l.ConnectionErrors}}),Object.defineProperty(t,"ConnectionError",{enumerable:!0,get:function(){return l.ConnectionError}}),Object.defineProperty(t,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return l.CancellationReceiverStrategy}}),Object.defineProperty(t,"CancellationSenderStrategy",{enumerable:!0,get:function(){return l.CancellationSenderStrategy}}),Object.defineProperty(t,"CancellationStrategy",{enumerable:!0,get:function(){return l.CancellationStrategy}});const d=n(8094);t.RAL=d.default},7770:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CancellationTokenSource=t.CancellationToken=void 0;const i=n(8094),o=n(8472),r=n(345);var s;!function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:r.Event.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:r.Event.None}),e.is=function(t){const n=t;return n&&(n===e.None||n===e.Cancelled||o.boolean(n.isCancellationRequested)&&!!n.onCancellationRequested)}}(s=t.CancellationToken||(t.CancellationToken={}));const a=Object.freeze((function(e,t){const n=i.default().timer.setTimeout(e.bind(t),0);return{dispose(){i.default().timer.clearTimeout(n)}}}));class c{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?a:(this._emitter||(this._emitter=new r.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}t.CancellationTokenSource=class{get token(){return this._token||(this._token=new c),this._token}cancel(){this._token?this._token.cancel():this._token=s.Cancelled}dispose(){this._token?this._token instanceof c&&this._token.dispose():this._token=s.None}}},6336:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageConnection=t.ConnectionOptions=t.CancellationStrategy=t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.ConnectionStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.Trace=t.NullLogger=t.ProgressType=void 0;const i=n(8094),o=n(8472),r=n(5285),s=n(5164),a=n(345),c=n(7770);var l,d,u,f,p,h,m,g,y,v,b,_,k;!function(e){e.type=new r.NotificationType("$/cancelRequest")}(l||(l={})),function(e){e.type=new r.NotificationType("$/progress")}(d||(d={})),t.ProgressType=class{constructor(){}},function(e){e.is=function(e){return o.func(e)}}(u||(u={})),t.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}}),function(e){e[e.Off=0]="Off",e[e.Messages=1]="Messages",e[e.Verbose=2]="Verbose"}(f=t.Trace||(t.Trace={})),function(e){e.fromString=function(t){if(!o.string(t))return e.Off;switch(t=t.toLowerCase()){default:return e.Off;case"messages":return e.Messages;case"verbose":return e.Verbose}},e.toString=function(t){switch(t){case e.Off:return"off";case e.Messages:return"messages";case e.Verbose:return"verbose";default:return"off"}}}(f=t.Trace||(t.Trace={})),function(e){e.Text="text",e.JSON="json"}(t.TraceFormat||(t.TraceFormat={})),function(e){e.fromString=function(t){return"json"===(t=t.toLowerCase())?e.JSON:e.Text}}(p=t.TraceFormat||(t.TraceFormat={})),function(e){e.type=new r.NotificationType("$/setTrace")}(h=t.SetTraceNotification||(t.SetTraceNotification={})),function(e){e.type=new r.NotificationType("$/logTrace")}(m=t.LogTraceNotification||(t.LogTraceNotification={})),function(e){e[e.Closed=1]="Closed",e[e.Disposed=2]="Disposed",e[e.AlreadyListening=3]="AlreadyListening"}(g=t.ConnectionErrors||(t.ConnectionErrors={}));class T extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,T.prototype)}}t.ConnectionError=T,function(e){e.is=function(e){const t=e;return t&&o.func(t.cancelUndispatched)}}(y=t.ConnectionStrategy||(t.ConnectionStrategy={})),function(e){e.Message=Object.freeze({createCancellationTokenSource:e=>new c.CancellationTokenSource}),e.is=function(e){const t=e;return t&&o.func(t.createCancellationTokenSource)}}(v=t.CancellationReceiverStrategy||(t.CancellationReceiverStrategy={})),function(e){e.Message=Object.freeze({sendCancellation(e,t){e.sendNotification(l.type,{id:t})},cleanup(e){}}),e.is=function(e){const t=e;return t&&o.func(t.sendCancellation)&&o.func(t.cleanup)}}(b=t.CancellationSenderStrategy||(t.CancellationSenderStrategy={})),function(e){e.Message=Object.freeze({receiver:v.Message,sender:b.Message}),e.is=function(e){const t=e;return t&&v.is(t.receiver)&&b.is(t.sender)}}(_=t.CancellationStrategy||(t.CancellationStrategy={})),(t.ConnectionOptions||(t.ConnectionOptions={})).is=function(e){const t=e;return t&&(_.is(t.cancellationStrategy)||y.is(t.connectionStrategy))},function(e){e[e.New=1]="New",e[e.Listening=2]="Listening",e[e.Closed=3]="Closed",e[e.Disposed=4]="Disposed"}(k||(k={})),t.createMessageConnection=function(e,n,y,v){const b=void 0!==y?y:t.NullLogger;let R=0,w=0,S=0;const C="2.0";let x;const E=Object.create(null);let D;const O=Object.create(null),K=new Map;let P,A,L=new s.LinkedMap,N=Object.create(null),M=Object.create(null),I=f.Off,j=p.Text,q=k.New;const F=new a.Emitter,W=new a.Emitter,$=new a.Emitter,U=new a.Emitter,B=new a.Emitter,V=v&&v.cancellationStrategy?v.cancellationStrategy:_.Message;function H(e){if(null===e)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+e.toString()}function z(e){}function G(){return q===k.Listening}function Y(){return q===k.Closed}function X(){return q===k.Disposed}function J(){q!==k.New&&q!==k.Listening||(q=k.Closed,W.fire(void 0))}function Q(){P||0===L.size||(P=i.default().timer.setImmediate((()=>{P=void 0,function(){if(0===L.size)return;const e=L.shift();try{r.isRequestMessage(e)?function(e){if(X())return;function t(t,i,o){const s={jsonrpc:C,id:e.id};t instanceof r.ResponseError?s.error=t.toJson():s.result=void 0===t?null:t,ee(s,i,o),n.write(s)}function i(t,i,o){const r={jsonrpc:C,id:e.id,error:t.toJson()};ee(r,i,o),n.write(r)}!function(e){if(I!==f.Off&&A)if(j===p.Text){let t;I===f.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),A.log(`Received request '${e.method} - (${e.id})'.`,t)}else te("receive-request",e)}(e);const s=E[e.method];let a,c;s&&(a=s.type,c=s.handler);const l=Date.now();if(c||x){const s=String(e.id),d=V.receiver.createCancellationTokenSource(s);M[s]=d;try{let u;if(c)if(void 0===e.params){if(void 0!==a&&0!==a.numberOfParams)return void i(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${e.method} defines ${a.numberOfParams} params but recevied none.`),e.method,l);u=c(d.token)}else if(Array.isArray(e.params)){if(void 0!==a&&a.parameterStructures===r.ParameterStructures.byName)return void i(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by name but received parameters by position`),e.method,l);u=c(...e.params,d.token)}else{if(void 0!==a&&a.parameterStructures===r.ParameterStructures.byPosition)return void i(new r.ResponseError(r.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by position but received parameters by name`),e.method,l);u=c(e.params,d.token)}else x&&(u=x(e.method,e.params,d.token));const f=u;u?f.then?f.then((n=>{delete M[s],t(n,e.method,l)}),(t=>{delete M[s],t instanceof r.ResponseError?i(t,e.method,l):t&&o.string(t.message)?i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,l):i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,l)})):(delete M[s],t(u,e.method,l)):(delete M[s],function(t,i,o){void 0===t&&(t=null);const r={jsonrpc:C,id:e.id,result:t};ee(r,i,o),n.write(r)}(u,e.method,l))}catch(n){delete M[s],n instanceof r.ResponseError?t(n,e.method,l):n&&o.string(n.message)?i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${n.message}`),e.method,l):i(new r.ResponseError(r.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,l)}}else i(new r.ResponseError(r.ErrorCodes.MethodNotFound,`Unhandled method ${e.method}`),e.method,l)}(e):r.isNotificationMessage(e)?function(e){if(X())return;let t,n;if(e.method===l.type.method)n=e=>{const t=e.id,n=M[String(t)];n&&n.cancel()};else{const i=O[e.method];i&&(n=i.handler,t=i.type)}if(n||D)try{!function(e){if(I!==f.Off&&A&&e.method!==m.type.method)if(j===p.Text){let t;I===f.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),A.log(`Received notification '${e.method}'.`,t)}else te("receive-notification",e)}(e),n?void 0===e.params?(void 0!==t&&0!==t.numberOfParams&&t.parameterStructures!==r.ParameterStructures.byName&&b.error(`Notification ${e.method} defines ${t.numberOfParams} params but recevied none.`),n()):Array.isArray(e.params)?(void 0!==t&&(t.parameterStructures===r.ParameterStructures.byName&&b.error(`Notification ${e.method} defines parameters by name but received parameters by position`),t.numberOfParams!==e.params.length&&b.error(`Notification ${e.method} defines ${t.numberOfParams} params but received ${e.params.length} argumennts`)),n(...e.params)):(void 0!==t&&t.parameterStructures===r.ParameterStructures.byPosition&&b.error(`Notification ${e.method} defines parameters by position but received parameters by name`),n(e.params)):D&&D(e.method,e.params)}catch(t){t.message?b.error(`Notification handler '${e.method}' failed with message: ${t.message}`):b.error(`Notification handler '${e.method}' failed unexpectedly.`)}else $.fire(e)}(e):r.isResponseMessage(e)?function(e){if(!X())if(null===e.id)e.error?b.error(`Received response message without id: Error is: \n${JSON.stringify(e.error,void 0,4)}`):b.error("Received response message without id. No further error information provided.");else{const t=String(e.id),n=N[t];if(function(e,t){if(I!==f.Off&&A)if(j===p.Text){let n;if(I===f.Verbose&&(e.error&&e.error.data?n=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?n=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(n="No result returned.\n\n")),t){const i=e.error?` Request failed: ${e.error.message} (${e.error.code}).`:"";A.log(`Received response '${t.method} - (${e.id})' in ${Date.now()-t.timerStart}ms.${i}`,n)}else A.log(`Received response ${e.id} without active response promise.`,n)}else te("receive-response",e)}(e,n),n){delete N[t];try{if(e.error){const t=e.error;n.reject(new r.ResponseError(t.code,t.message,t.data))}else{if(void 0===e.result)throw new Error("Should never happen.");n.resolve(e.result)}}catch(e){e.message?b.error(`Response handler '${n.method}' failed with message: ${e.message}`):b.error(`Response handler '${n.method}' failed unexpectedly.`)}}}}(e):function(e){if(!e)return void b.error("Received empty message.");b.error(`Received message which is neither a response nor a notification message:\n${JSON.stringify(e,null,4)}`);const t=e;if(o.string(t.id)||o.number(t.id)){const e=String(t.id),n=N[e];n&&n.reject(new Error("The received response has neither a result nor an error property."))}}(e)}finally{Q()}}()})))}e.onClose(J),e.onError((function(e){F.fire([e,void 0,void 0])})),n.onClose(J),n.onError((function(e){F.fire(e)}));const Z=e=>{try{if(r.isNotificationMessage(e)&&e.method===l.type.method){const t=H(e.params.id),i=L.get(t);if(r.isRequestMessage(i)){const o=null==v?void 0:v.connectionStrategy,r=o&&o.cancelUndispatched?o.cancelUndispatched(i,z):void 0;if(r&&(void 0!==r.error||void 0!==r.result))return L.delete(t),r.id=i.id,ee(r,e.method,Date.now()),void n.write(r)}}!function(e,t){var n;r.isRequestMessage(t)?e.set(H(t.id),t):r.isResponseMessage(t)?e.set(null===(n=t.id)?"res-unknown-"+(++S).toString():"res-"+n.toString(),t):e.set("not-"+(++w).toString(),t)}(L,e)}finally{Q()}};function ee(e,t,n){if(I!==f.Off&&A)if(j===p.Text){let i;I===f.Verbose&&(e.error&&e.error.data?i=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?i=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(i="No result returned.\n\n")),A.log(`Sending response '${t} - (${e.id})'. Processing request took ${Date.now()-n}ms`,i)}else te("send-response",e)}function te(e,t){if(!A||I===f.Off)return;const n={isLSPMessage:!0,type:e,message:t,timestamp:Date.now()};A.log(n)}function ne(){if(Y())throw new T(g.Closed,"Connection is closed.");if(X())throw new T(g.Disposed,"Connection is disposed.")}function ie(e){return void 0===e?null:e}function oe(e){return null===e?void 0:e}function re(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}function se(e,t){switch(e){case r.ParameterStructures.auto:return re(t)?oe(t):[ie(t)];case r.ParameterStructures.byName:if(!re(t))throw new Error("Recevied parameters by name but param is not an object literal.");return oe(t);case r.ParameterStructures.byPosition:return[ie(t)];default:throw new Error(`Unknown parameter structure ${e.toString()}`)}}function ae(e,t){let n;const i=e.numberOfParams;switch(i){case 0:n=void 0;break;case 1:n=se(e.parameterStructures,t[0]);break;default:n=[];for(let e=0;e<t.length&&e<i;e++)n.push(ie(t[e]));if(t.length<i)for(let e=t.length;e<i;e++)n.push(null)}return n}const ce={sendNotification:(e,...t)=>{let i,s;if(ne(),o.string(e)){i=e;const n=t[0];let o=0,a=r.ParameterStructures.auto;r.ParameterStructures.is(n)&&(o=1,a=n);let c=t.length;const l=c-o;switch(l){case 0:s=void 0;break;case 1:s=se(a,t[o]);break;default:if(a===r.ParameterStructures.byName)throw new Error(`Recevied ${l} parameters for 'by Name' notification parameter structure.`);s=t.slice(o,c).map((e=>ie(e)))}}else{const n=t;i=e.method,s=ae(e,n)}const a={jsonrpc:C,method:i,params:s};!function(e){if(I!==f.Off&&A)if(j===p.Text){let t;I===f.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),A.log(`Sending notification '${e.method}'.`,t)}else te("send-notification",e)}(a),n.write(a)},onNotification:(e,t)=>{let n;return ne(),o.func(e)?D=e:t&&(o.string(e)?(n=e,O[e]={type:void 0,handler:t}):(n=e.method,O[e.method]={type:e,handler:t})),{dispose:()=>{void 0!==n?delete O[n]:D=void 0}}},onProgress:(e,t,n)=>{if(K.has(t))throw new Error(`Progress handler for token ${t} already registered`);return K.set(t,n),{dispose:()=>{K.delete(t)}}},sendProgress:(e,t,n)=>{ce.sendNotification(d.type,{token:t,value:n})},onUnhandledProgress:U.event,sendRequest:(e,...t)=>{let i,s,a;if(ne(),function(){if(!G())throw new Error("Call listen() first.")}(),o.string(e)){i=e;const n=t[0],o=t[t.length-1];let l=0,d=r.ParameterStructures.auto;r.ParameterStructures.is(n)&&(l=1,d=n);let u=t.length;c.CancellationToken.is(o)&&(u-=1,a=o);const f=u-l;switch(f){case 0:s=void 0;break;case 1:s=se(d,t[l]);break;default:if(d===r.ParameterStructures.byName)throw new Error(`Recevied ${f} parameters for 'by Name' request parameter structure.`);s=t.slice(l,u).map((e=>ie(e)))}}else{const n=t;i=e.method,s=ae(e,n);const o=e.numberOfParams;a=c.CancellationToken.is(n[o])?n[o]:void 0}const l=R++;let d;return a&&(d=a.onCancellationRequested((()=>{V.sender.sendCancellation(ce,l)}))),new Promise(((e,t)=>{const o={jsonrpc:C,id:l,method:i,params:s};let a={method:i,timerStart:Date.now(),resolve:t=>{e(t),V.sender.cleanup(l),null==d||d.dispose()},reject:e=>{t(e),V.sender.cleanup(l),null==d||d.dispose()}};!function(e){if(I!==f.Off&&A)if(j===p.Text){let t;I===f.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),A.log(`Sending request '${e.method} - (${e.id})'.`,t)}else te("send-request",e)}(o);try{n.write(o)}catch(e){a.reject(new r.ResponseError(r.ErrorCodes.MessageWriteError,e.message?e.message:"Unknown reason")),a=null}a&&(N[String(l)]=a)}))},onRequest:(e,t)=>{ne();let n=null;return u.is(e)?(n=void 0,x=e):o.string(e)?(n=null,void 0!==t&&(n=e,E[e]={handler:t,type:void 0})):void 0!==t&&(n=e.method,E[e.method]={type:e,handler:t}),{dispose:()=>{null!==n&&(void 0!==n?delete E[n]:x=void 0)}}},trace:(e,t,n)=>{let i=!1,r=p.Text;void 0!==n&&(o.boolean(n)?i=n:(i=n.sendNotification||!1,r=n.traceFormat||p.Text)),I=e,j=r,A=I===f.Off?void 0:t,!i||Y()||X()||ce.sendNotification(h.type,{value:f.toString(e)})},onError:F.event,onClose:W.event,onUnhandledNotification:$.event,onDispose:B.event,end:()=>{n.end()},dispose:()=>{if(X())return;q=k.Disposed,B.fire(void 0);const t=new Error("Connection got disposed.");Object.keys(N).forEach((e=>{N[e].reject(t)})),N=Object.create(null),M=Object.create(null),L=new s.LinkedMap,o.func(n.dispose)&&n.dispose(),o.func(e.dispose)&&e.dispose()},listen:()=>{ne(),function(){if(G())throw new T(g.AlreadyListening,"Connection is already listening")}(),q=k.Listening,e.listen(Z)},inspect:()=>{i.default().console.log("inspect")}};return ce.onNotification(m.type,(e=>{I!==f.Off&&A&&A.log(e.message,I===f.Verbose?e.verbose:void 0)})),ce.onNotification(d.type,(e=>{const t=K.get(e.token);t?t(e.value):U.fire(e)})),ce}},8159:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Disposable=void 0,(t.Disposable||(t.Disposable={})).create=function(e){return{dispose:e}}},345:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Emitter=t.Event=void 0;const i=n(8094);!function(e){const t={dispose(){}};e.None=function(){return t}}(t.Event||(t.Event={}));class o{add(e,t=null,n){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(n)&&n.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let n=!1;for(let i=0,o=this._callbacks.length;i<o;i++)if(this._callbacks[i]===e){if(this._contexts[i]===t)return this._callbacks.splice(i,1),void this._contexts.splice(i,1);n=!0}if(n)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];const t=[],n=this._callbacks.slice(0),o=this._contexts.slice(0);for(let r=0,s=n.length;r<s;r++)try{t.push(n[r].apply(o[r],e))}catch(e){i.default().console.error(e)}return t}isEmpty(){return!this._callbacks||0===this._callbacks.length}dispose(){this._callbacks=void 0,this._contexts=void 0}}class r{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,n)=>{this._callbacks||(this._callbacks=new o),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);const i={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,t),i.dispose=r._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(n)&&n.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}t.Emitter=r,r._noop=function(){}},8472:(e,t)=>{function n(e){return"string"==typeof e||e instanceof String}function i(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=n,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=i,t.stringArray=function(e){return i(e)&&e.every((e=>n(e)))}},5164:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.LRUCache=t.LinkedMap=t.Touch=void 0,function(e){e.None=0,e.First=1,e.AsOld=e.First,e.Last=2,e.AsNew=e.Last}(n=t.Touch||(t.Touch={}));class i{constructor(){this[Symbol.toStringTag]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return null===(e=this._head)||void 0===e?void 0:e.value}get last(){var e;return null===(e=this._tail)||void 0===e?void 0:e.value}has(e){return this._map.has(e)}get(e,t=n.None){const i=this._map.get(e);if(i)return t!==n.None&&this.touch(i,t),i.value}set(e,t,i=n.None){let o=this._map.get(e);if(o)o.value=t,i!==n.None&&this.touch(o,i);else{switch(o={key:e,value:t,next:void 0,previous:void 0},i){case n.None:this.addItemLast(o);break;case n.First:this.addItemFirst(o);break;case n.Last:default:this.addItemLast(o)}this._map.set(e,o),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const n=this._state;let i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){const e=this,t=this._state;let n=this._head;const i={[Symbol.iterator]:()=>i,next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){const e={value:n.key,done:!1};return n=n.next,e}return{value:void 0,done:!0}}};return i}values(){const e=this,t=this._state;let n=this._head;const i={[Symbol.iterator]:()=>i,next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){const e={value:n.value,done:!1};return n=n.next,e}return{value:void 0,done:!0}}};return i}entries(){const e=this,t=this._state;let n=this._head;const i={[Symbol.iterator]:()=>i,next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){const e={value:[n.key,n.value],done:!1};return n=n.next,e}return{value:void 0,done:!0}}};return i}[Symbol.iterator](){return this.entries()}trimOld(e){if(e>=this.size)return;if(0===e)return void this.clear();let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");e.next=this._head,this._head.previous=e}else this._tail=e;this._head=e,this._state++}addItemLast(e){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");e.previous=this._tail,this._tail.next=e}else this._head=e;this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(t===n.First||t===n.Last)if(t===n.First){if(e===this._head)return;const t=e.next,n=e.previous;e===this._tail?(n.next=void 0,this._tail=n):(t.previous=n,n.next=t),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===n.Last){if(e===this._tail)return;const t=e.next,n=e.previous;e===this._head?(t.previous=void 0,this._head=t):(t.previous=n,n.next=t),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}toJSON(){const e=[];return this.forEach(((t,n)=>{e.push([n,t])})),e}fromJSON(e){this.clear();for(const[t,n]of e)this.set(t,n)}}t.LinkedMap=i,t.LRUCache=class extends i{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=n.AsNew){return super.get(e,t)}peek(e){return super.get(e,n.None)}set(e,t){return super.set(e,t,n.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}},5506:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractMessageBuffer=void 0,t.AbstractMessageBuffer=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){const t="string"==typeof e?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(){if(0===this._chunks.length)return;let e=0,t=0,n=0,i=0;e:for(;t<this._chunks.length;){const o=this._chunks[t];for(n=0;n<o.length;){switch(o[n]){case 13:switch(e){case 0:e=1;break;case 2:e=3;break;default:e=0}break;case 10:switch(e){case 1:e=2;break;case 3:e=4,n++;break e;default:e=0}break;default:e=0}n++}i+=o.byteLength,t++}if(4!==e)return;const o=this._read(i+n),r=new Map,s=this.toString(o,"ascii").split("\r\n");if(s.length<2)return r;for(let e=0;e<s.length-2;e++){const t=s[e],n=t.indexOf(":");if(-1===n)throw new Error("Message header must separate key and value using :");const i=t.substr(0,n),o=t.substr(n+1).trim();r.set(i,o)}return r}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(0===e)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){const t=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(t)}if(this._chunks[0].byteLength>e){const t=this._chunks[0],n=this.asNative(t,e);return this._chunks[0]=t.slice(e),this._totalLength-=e,n}const t=this.allocNative(e);let n=0;for(;e>0;){const i=this._chunks[0];if(i.byteLength>e){const o=i.slice(0,e);t.set(o,n),n+=e,this._chunks[0]=i.slice(e),this._totalLength-=e,e-=e}else t.set(i,n),n+=i.byteLength,this._chunks.shift(),this._totalLength-=i.byteLength,e-=i.byteLength}return t}}},4806:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=void 0;const i=n(8094),o=n(8472),r=n(345);var s;(t.MessageReader||(t.MessageReader={})).is=function(e){let t=e;return t&&o.func(t.listen)&&o.func(t.dispose)&&o.func(t.onError)&&o.func(t.onClose)&&o.func(t.onPartialMessage)};class a{constructor(){this.errorEmitter=new r.Emitter,this.closeEmitter=new r.Emitter,this.partialMessageEmitter=new r.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${o.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageReader=a,function(e){e.fromOptions=function(e){var t;let n,o;const r=new Map;let s;const a=new Map;if(void 0===e||"string"==typeof e)n=null!=e?e:"utf-8";else{if(n=null!==(t=e.charset)&&void 0!==t?t:"utf-8",void 0!==e.contentDecoder&&(o=e.contentDecoder,r.set(o.name,o)),void 0!==e.contentDecoders)for(const t of e.contentDecoders)r.set(t.name,t);if(void 0!==e.contentTypeDecoder&&(s=e.contentTypeDecoder,a.set(s.name,s)),void 0!==e.contentTypeDecoders)for(const t of e.contentTypeDecoders)a.set(t.name,t)}return void 0===s&&(s=i.default().applicationJson.decoder,a.set(s.name,s)),{charset:n,contentDecoder:o,contentDecoders:r,contentTypeDecoder:s,contentTypeDecoders:a}}}(s||(s={})),t.ReadableStreamMessageReader=class extends a{constructor(e,t){super(),this.readable=e,this.options=s.fromOptions(t),this.buffer=i.default().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;const t=this.readable.onData((e=>{this.onData(e)}));return this.readable.onError((e=>this.fireError(e))),this.readable.onClose((()=>this.fireClose())),t}onData(e){for(this.buffer.append(e);;){if(-1===this.nextMessageLength){const e=this.buffer.tryReadHeaders();if(!e)return;const t=e.get("Content-Length");if(!t)throw new Error("Header must provide a Content-Length property.");const n=parseInt(t);if(isNaN(n))throw new Error("Content-Length value must be a number.");this.nextMessageLength=n}const e=this.buffer.tryReadBody(this.nextMessageLength);if(void 0===e)return void this.setPartialMessageTimer();let t;this.clearPartialMessageTimer(),this.nextMessageLength=-1,t=void 0!==this.options.contentDecoder?this.options.contentDecoder.decode(e):Promise.resolve(e),t.then((e=>{this.options.contentTypeDecoder.decode(e,this.options).then((e=>{this.callback(e)}),(e=>{this.fireError(e)}))}),(e=>{this.fireError(e)}))}}clearPartialMessageTimer(){this.partialMessageTimer&&(i.default().timer.clearTimeout(this.partialMessageTimer),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),this._partialMessageTimeout<=0||(this.partialMessageTimer=i.default().timer.setTimeout(((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())}),this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}},9248:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WriteableStreamMessageWriter=t.AbstractMessageWriter=t.MessageWriter=void 0;const i=n(8094),o=n(8472),r=n(6791),s=n(345);var a;(t.MessageWriter||(t.MessageWriter={})).is=function(e){let t=e;return t&&o.func(t.dispose)&&o.func(t.onClose)&&o.func(t.onError)&&o.func(t.write)};class c{constructor(){this.errorEmitter=new s.Emitter,this.closeEmitter=new s.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,n){this.errorEmitter.fire([this.asError(e),t,n])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${o.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageWriter=c,function(e){e.fromOptions=function(e){var t,n;return void 0===e||"string"==typeof e?{charset:null!=e?e:"utf-8",contentTypeEncoder:i.default().applicationJson.encoder}:{charset:null!==(t=e.charset)&&void 0!==t?t:"utf-8",contentEncoder:e.contentEncoder,contentTypeEncoder:null!==(n=e.contentTypeEncoder)&&void 0!==n?n:i.default().applicationJson.encoder}}}(a||(a={})),t.WriteableStreamMessageWriter=class extends c{constructor(e,t){super(),this.writable=e,this.options=a.fromOptions(t),this.errorCount=0,this.writeSemaphore=new r.Semaphore(1),this.writable.onError((e=>this.fireError(e))),this.writable.onClose((()=>this.fireClose()))}async write(e){return this.writeSemaphore.lock((async()=>this.options.contentTypeEncoder.encode(e,this.options).then((e=>void 0!==this.options.contentEncoder?this.options.contentEncoder.encode(e):e)).then((t=>{const n=[];return n.push("Content-Length: ",t.byteLength.toString(),"\r\n"),n.push("\r\n"),this.doWrite(e,n,t)}),(e=>{throw this.fireError(e),e}))))}async doWrite(e,t,n){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(n)}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}}},5285:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isResponseMessage=t.isNotificationMessage=t.isRequestMessage=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=t.NotificationType2=t.NotificationType1=t.NotificationType0=t.NotificationType=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType=t.RequestType0=t.AbstractMessageSignature=t.ParameterStructures=t.ResponseError=t.ErrorCodes=void 0;const i=n(8472);var o;!function(e){e.ParseError=-32700,e.InvalidRequest=-32600,e.MethodNotFound=-32601,e.InvalidParams=-32602,e.InternalError=-32603,e.jsonrpcReservedErrorRangeStart=-32099,e.serverErrorStart=e.jsonrpcReservedErrorRangeStart,e.MessageWriteError=-32099,e.MessageReadError=-32098,e.ServerNotInitialized=-32002,e.UnknownErrorCode=-32001,e.jsonrpcReservedErrorRangeEnd=-32e3,e.serverErrorEnd=e.jsonrpcReservedErrorRangeEnd}(o=t.ErrorCodes||(t.ErrorCodes={}));class r extends Error{constructor(e,t,n){super(t),this.code=i.number(e)?e:o.UnknownErrorCode,this.data=n,Object.setPrototypeOf(this,r.prototype)}toJson(){return{code:this.code,message:this.message,data:this.data}}}t.ResponseError=r;class s{constructor(e){this.kind=e}static is(e){return e===s.auto||e===s.byName||e===s.byPosition}toString(){return this.kind}}t.ParameterStructures=s,s.auto=new s("auto"),s.byPosition=new s("byPosition"),s.byName=new s("byName");class a{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return s.auto}}t.AbstractMessageSignature=a,t.RequestType0=class extends a{constructor(e){super(e,0)}},t.RequestType=class extends a{constructor(e,t=s.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.RequestType1=class extends a{constructor(e,t=s.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.RequestType2=class extends a{constructor(e){super(e,2)}},t.RequestType3=class extends a{constructor(e){super(e,3)}},t.RequestType4=class extends a{constructor(e){super(e,4)}},t.RequestType5=class extends a{constructor(e){super(e,5)}},t.RequestType6=class extends a{constructor(e){super(e,6)}},t.RequestType7=class extends a{constructor(e){super(e,7)}},t.RequestType8=class extends a{constructor(e){super(e,8)}},t.RequestType9=class extends a{constructor(e){super(e,9)}},t.NotificationType=class extends a{constructor(e,t=s.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.NotificationType0=class extends a{constructor(e){super(e,0)}},t.NotificationType1=class extends a{constructor(e,t=s.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.NotificationType2=class extends a{constructor(e){super(e,2)}},t.NotificationType3=class extends a{constructor(e){super(e,3)}},t.NotificationType4=class extends a{constructor(e){super(e,4)}},t.NotificationType5=class extends a{constructor(e){super(e,5)}},t.NotificationType6=class extends a{constructor(e){super(e,6)}},t.NotificationType7=class extends a{constructor(e){super(e,7)}},t.NotificationType8=class extends a{constructor(e){super(e,8)}},t.NotificationType9=class extends a{constructor(e){super(e,9)}},t.isRequestMessage=function(e){const t=e;return t&&i.string(t.method)&&(i.string(t.id)||i.number(t.id))},t.isNotificationMessage=function(e){const t=e;return t&&i.string(t.method)&&void 0===e.id},t.isResponseMessage=function(e){const t=e;return t&&(void 0!==t.result||!!t.error)&&(i.string(t.id)||i.number(t.id)||null===t.id)}},8094:(e,t)=>{let n;function i(){if(void 0===n)throw new Error("No runtime abstraction layer installed");return n}Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.install=function(e){if(void 0===e)throw new Error("No runtime abstraction layer provided");n=e}}(i||(i={})),t.default=i},6791:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Semaphore=void 0;const i=n(8094);t.Semaphore=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise(((t,n)=>{this._waiting.push({thunk:e,resolve:t,reject:n}),this.runNext()}))}get active(){return this._active}runNext(){0!==this._waiting.length&&this._active!==this._capacity&&i.default().timer.setImmediate((()=>this.doRunNext()))}doRunNext(){if(0===this._waiting.length||this._active===this._capacity)return;const e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const t=e.thunk();t instanceof Promise?t.then((t=>{this._active--,e.resolve(t),this.runNext()}),(t=>{this._active--,e.reject(t),this.runNext()})):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}}},1694:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageConnection=t.createServerSocketTransport=t.createClientSocketTransport=t.createServerPipeTransport=t.createClientPipeTransport=t.generateRandomPipeName=t.StreamMessageWriter=t.StreamMessageReader=t.SocketMessageWriter=t.SocketMessageReader=t.IPCMessageWriter=t.IPCMessageReader=void 0;const r=n(3590);r.default.install();const s=n(5748),a=n(1017),c=n(2037),l=n(6113),d=n(1808);o(n(5748),t);class u extends s.AbstractMessageReader{constructor(e){super(),this.process=e;let t=this.process;t.on("error",(e=>this.fireError(e))),t.on("close",(()=>this.fireClose()))}listen(e){return this.process.on("message",e),s.Disposable.create((()=>this.process.off("message",e)))}}t.IPCMessageReader=u;class f extends s.AbstractMessageWriter{constructor(e){super(),this.process=e,this.errorCount=0;let t=this.process;t.on("error",(e=>this.fireError(e))),t.on("close",(()=>this.fireClose))}write(e){try{return"function"==typeof this.process.send&&this.process.send(e,void 0,void 0,(t=>{t?(this.errorCount++,this.handleError(t,e)):this.errorCount=0})),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}}t.IPCMessageWriter=f;class p extends s.ReadableStreamMessageReader{constructor(e,t="utf-8"){super(r.default().stream.asReadableStream(e),t)}}t.SocketMessageReader=p;class h extends s.WriteableStreamMessageWriter{constructor(e,t){super(r.default().stream.asWritableStream(e),t),this.socket=e}dispose(){super.dispose(),this.socket.destroy()}}t.SocketMessageWriter=h;class m extends s.ReadableStreamMessageReader{constructor(e,t){super(r.default().stream.asReadableStream(e),t)}}t.StreamMessageReader=m;class g extends s.WriteableStreamMessageWriter{constructor(e,t){super(r.default().stream.asWritableStream(e),t)}}t.StreamMessageWriter=g;const y=process.env.XDG_RUNTIME_DIR,v=new Map([["linux",107],["darwin",103]]);t.generateRandomPipeName=function(){const e=l.randomBytes(21).toString("hex");if("win32"===process.platform)return`\\\\.\\pipe\\vscode-jsonrpc-${e}-sock`;let t;t=y?a.join(y,`vscode-ipc-${e}.sock`):a.join(c.tmpdir(),`vscode-${e}.sock`);const n=v.get(process.platform);return void 0!==n&&t.length>=n&&r.default().console.warn(`WARNING: IPC handle "${t}" is longer than ${n} characters.`),t},t.createClientPipeTransport=function(e,t="utf-8"){let n;const i=new Promise(((e,t)=>{n=e}));return new Promise(((o,r)=>{let s=d.createServer((e=>{s.close(),n([new p(e,t),new h(e,t)])}));s.on("error",r),s.listen(e,(()=>{s.removeListener("error",r),o({onConnected:()=>i})}))}))},t.createServerPipeTransport=function(e,t="utf-8"){const n=d.createConnection(e);return[new p(n,t),new h(n,t)]},t.createClientSocketTransport=function(e,t="utf-8"){let n;const i=new Promise(((e,t)=>{n=e}));return new Promise(((o,r)=>{const s=d.createServer((e=>{s.close(),n([new p(e,t),new h(e,t)])}));s.on("error",r),s.listen(e,"127.0.0.1",(()=>{s.removeListener("error",r),o({onConnected:()=>i})}))}))},t.createServerSocketTransport=function(e,t="utf-8"){const n=d.createConnection(e,"127.0.0.1");return[new p(n,t),new h(n,t)]},t.createMessageConnection=function(e,t,n,i){n||(n=s.NullLogger);const o=function(e){const t=e;return void 0!==t.read&&void 0!==t.addListener}(e)?new m(e):e,r=function(e){const t=e;return void 0!==t.write&&void 0!==t.addListener}(t)?new g(t):t;return s.ConnectionStrategy.is(i)&&(i={connectionStrategy:i}),s.createMessageConnection(o,r,n,i)}},3590:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=n(8094),o=n(3837),r=n(8159),s=n(5506);class a extends s.AbstractMessageBuffer{constructor(e="utf-8"){super(e)}emptyBuffer(){return a.emptyBuffer}fromString(e,t){return Buffer.from(e,t)}toString(e,t){return e instanceof Buffer?e.toString(t):new o.TextDecoder(t).decode(e)}asNative(e,t){return void 0===t?e instanceof Buffer?e:Buffer.from(e):e instanceof Buffer?e.slice(0,t):Buffer.from(e,0,t)}allocNative(e){return Buffer.allocUnsafe(e)}}a.emptyBuffer=Buffer.allocUnsafe(0);class c{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),r.Disposable.create((()=>this.stream.off("close",e)))}onError(e){return this.stream.on("error",e),r.Disposable.create((()=>this.stream.off("error",e)))}onEnd(e){return this.stream.on("end",e),r.Disposable.create((()=>this.stream.off("end",e)))}onData(e){return this.stream.on("data",e),r.Disposable.create((()=>this.stream.off("data",e)))}}class l{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),r.Disposable.create((()=>this.stream.off("close",e)))}onError(e){return this.stream.on("error",e),r.Disposable.create((()=>this.stream.off("error",e)))}onEnd(e){return this.stream.on("end",e),r.Disposable.create((()=>this.stream.off("end",e)))}write(e,t){return new Promise(((n,i)=>{const o=e=>{null==e?n():i(e)};"string"==typeof e?this.stream.write(e,t,o):this.stream.write(e,o)}))}end(){this.stream.end()}}const d=Object.freeze({messageBuffer:Object.freeze({create:e=>new a(e)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(e,t)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(e,void 0,0),t.charset))}catch(e){return Promise.reject(e)}}}),decoder:Object.freeze({name:"application/json",decode:(e,t)=>{try{return e instanceof Buffer?Promise.resolve(JSON.parse(e.toString(t.charset))):Promise.resolve(JSON.parse(new o.TextDecoder(t.charset).decode(e)))}catch(e){return Promise.reject(e)}}})}),stream:Object.freeze({asReadableStream:e=>new c(e),asWritableStream:e=>new l(e)}),console,timer:Object.freeze({setTimeout:(e,t,...n)=>setTimeout(e,t,...n),clearTimeout(e){clearTimeout(e)},setImmediate:(e,...t)=>setImmediate(e,...t),clearImmediate(e){clearImmediate(e)}})});function u(){return d}!function(e){e.install=function(){i.default.install(d)}}(u||(u={})),t.default=u},2659:(e,t,n)=>{e.exports=n(1694)},559:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.LSPErrorCodes=t.createProtocolConnection=void 0,o(n(1694),t),o(n(2880),t),o(n(4742),t),o(n(7304),t);var r,s=n(7558);Object.defineProperty(t,"createProtocolConnection",{enumerable:!0,get:function(){return s.createProtocolConnection}}),(r=t.LSPErrorCodes||(t.LSPErrorCodes={})).lspReservedErrorRangeStart=-32899,r.ContentModified=-32801,r.RequestCancelled=-32800,r.lspReservedErrorRangeEnd=-32800},7558:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createProtocolConnection=void 0;const i=n(1694);t.createProtocolConnection=function(e,t,n,o){return i.ConnectionStrategy.is(o)&&(o={connectionStrategy:o}),i.createMessageConnection(e,t,n,o)}},4742:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProtocolNotificationType=t.ProtocolNotificationType0=t.ProtocolRequestType=t.ProtocolRequestType0=t.RegistrationType=void 0;const i=n(1694);t.RegistrationType=class{constructor(e){this.method=e}};class o extends i.RequestType0{constructor(e){super(e)}}t.ProtocolRequestType0=o;class r extends i.RequestType{constructor(e){super(e,i.ParameterStructures.byName)}}t.ProtocolRequestType=r;class s extends i.NotificationType0{constructor(e){super(e)}}t.ProtocolNotificationType0=s;class a extends i.NotificationType{constructor(e){super(e,i.ParameterStructures.byName)}}t.ProtocolNotificationType=a},2565:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CallHierarchyOutgoingCallsRequest=t.CallHierarchyIncomingCallsRequest=t.CallHierarchyPrepareRequest=void 0;const i=n(4742);var o,r,s;(s=t.CallHierarchyPrepareRequest||(t.CallHierarchyPrepareRequest={})).method="textDocument/prepareCallHierarchy",s.type=new i.ProtocolRequestType(s.method),(r=t.CallHierarchyIncomingCallsRequest||(t.CallHierarchyIncomingCallsRequest={})).method="callHierarchy/incomingCalls",r.type=new i.ProtocolRequestType(r.method),(o=t.CallHierarchyOutgoingCallsRequest||(t.CallHierarchyOutgoingCallsRequest={})).method="callHierarchy/outgoingCalls",o.type=new i.ProtocolRequestType(o.method)},5509:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorPresentationRequest=t.DocumentColorRequest=void 0;const i=n(4742);var o;(o=t.DocumentColorRequest||(t.DocumentColorRequest={})).method="textDocument/documentColor",o.type=new i.ProtocolRequestType(o.method),(t.ColorPresentationRequest||(t.ColorPresentationRequest={})).type=new i.ProtocolRequestType("textDocument/colorPresentation")},7296:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigurationRequest=void 0;const i=n(4742);(t.ConfigurationRequest||(t.ConfigurationRequest={})).type=new i.ProtocolRequestType("workspace/configuration")},9137:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DeclarationRequest=void 0;const i=n(4742);var o;(o=t.DeclarationRequest||(t.DeclarationRequest={})).method="textDocument/declaration",o.type=new i.ProtocolRequestType(o.method)},2235:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WillDeleteFilesRequest=t.DidDeleteFilesNotification=t.DidRenameFilesNotification=t.WillRenameFilesRequest=t.DidCreateFilesNotification=t.WillCreateFilesRequest=t.FileOperationPatternKind=void 0;const i=n(4742);var o,r,s,a,c,l,d;(d=t.FileOperationPatternKind||(t.FileOperationPatternKind={})).file="file",d.folder="folder",(l=t.WillCreateFilesRequest||(t.WillCreateFilesRequest={})).method="workspace/willCreateFiles",l.type=new i.ProtocolRequestType(l.method),(c=t.DidCreateFilesNotification||(t.DidCreateFilesNotification={})).method="workspace/didCreateFiles",c.type=new i.ProtocolNotificationType(c.method),(a=t.WillRenameFilesRequest||(t.WillRenameFilesRequest={})).method="workspace/willRenameFiles",a.type=new i.ProtocolRequestType(a.method),(s=t.DidRenameFilesNotification||(t.DidRenameFilesNotification={})).method="workspace/didRenameFiles",s.type=new i.ProtocolNotificationType(s.method),(r=t.DidDeleteFilesNotification||(t.DidDeleteFilesNotification={})).method="workspace/didDeleteFiles",r.type=new i.ProtocolNotificationType(r.method),(o=t.WillDeleteFilesRequest||(t.WillDeleteFilesRequest={})).method="workspace/willDeleteFiles",o.type=new i.ProtocolRequestType(o.method)},5171:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FoldingRangeRequest=t.FoldingRangeKind=void 0;const i=n(4742);var o,r;(r=t.FoldingRangeKind||(t.FoldingRangeKind={})).Comment="comment",r.Imports="imports",r.Region="region",(o=t.FoldingRangeRequest||(t.FoldingRangeRequest={})).method="textDocument/foldingRange",o.type=new i.ProtocolRequestType(o.method)},2441:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ImplementationRequest=void 0;const i=n(4742);var o;(o=t.ImplementationRequest||(t.ImplementationRequest={})).method="textDocument/implementation",o.type=new i.ProtocolRequestType(o.method)},7304:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentLinkRequest=t.CodeLensRefreshRequest=t.CodeLensResolveRequest=t.CodeLensRequest=t.WorkspaceSymbolRequest=t.CodeActionResolveRequest=t.CodeActionRequest=t.DocumentSymbolRequest=t.DocumentHighlightRequest=t.ReferencesRequest=t.DefinitionRequest=t.SignatureHelpRequest=t.SignatureHelpTriggerKind=t.HoverRequest=t.CompletionResolveRequest=t.CompletionRequest=t.CompletionTriggerKind=t.PublishDiagnosticsNotification=t.WatchKind=t.FileChangeType=t.DidChangeWatchedFilesNotification=t.WillSaveTextDocumentWaitUntilRequest=t.WillSaveTextDocumentNotification=t.TextDocumentSaveReason=t.DidSaveTextDocumentNotification=t.DidCloseTextDocumentNotification=t.DidChangeTextDocumentNotification=t.TextDocumentContentChangeEvent=t.DidOpenTextDocumentNotification=t.TextDocumentSyncKind=t.TelemetryEventNotification=t.LogMessageNotification=t.ShowMessageRequest=t.ShowMessageNotification=t.MessageType=t.DidChangeConfigurationNotification=t.ExitNotification=t.ShutdownRequest=t.InitializedNotification=t.InitializeError=t.InitializeRequest=t.WorkDoneProgressOptions=t.TextDocumentRegistrationOptions=t.StaticRegistrationOptions=t.FailureHandlingKind=t.ResourceOperationKind=t.UnregistrationRequest=t.RegistrationRequest=t.DocumentSelector=t.DocumentFilter=void 0,t.MonikerRequest=t.MonikerKind=t.UniquenessLevel=t.WillDeleteFilesRequest=t.DidDeleteFilesNotification=t.WillRenameFilesRequest=t.DidRenameFilesNotification=t.WillCreateFilesRequest=t.DidCreateFilesNotification=t.FileOperationPatternKind=t.LinkedEditingRangeRequest=t.ShowDocumentRequest=t.SemanticTokensRegistrationType=t.SemanticTokensRefreshRequest=t.SemanticTokensRangeRequest=t.SemanticTokensDeltaRequest=t.SemanticTokensRequest=t.TokenFormat=t.SemanticTokens=t.SemanticTokenModifiers=t.SemanticTokenTypes=t.CallHierarchyPrepareRequest=t.CallHierarchyOutgoingCallsRequest=t.CallHierarchyIncomingCallsRequest=t.WorkDoneProgressCancelNotification=t.WorkDoneProgressCreateRequest=t.WorkDoneProgress=t.SelectionRangeRequest=t.DeclarationRequest=t.FoldingRangeRequest=t.ColorPresentationRequest=t.DocumentColorRequest=t.ConfigurationRequest=t.DidChangeWorkspaceFoldersNotification=t.WorkspaceFoldersRequest=t.TypeDefinitionRequest=t.ImplementationRequest=t.ApplyWorkspaceEditRequest=t.ExecuteCommandRequest=t.PrepareRenameRequest=t.RenameRequest=t.PrepareSupportDefaultBehavior=t.DocumentOnTypeFormattingRequest=t.DocumentRangeFormattingRequest=t.DocumentFormattingRequest=t.DocumentLinkResolveRequest=void 0;const i=n(9348),o=n(4742),r=n(2441);Object.defineProperty(t,"ImplementationRequest",{enumerable:!0,get:function(){return r.ImplementationRequest}});const s=n(8685);Object.defineProperty(t,"TypeDefinitionRequest",{enumerable:!0,get:function(){return s.TypeDefinitionRequest}});const a=n(1343);Object.defineProperty(t,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return a.WorkspaceFoldersRequest}}),Object.defineProperty(t,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return a.DidChangeWorkspaceFoldersNotification}});const c=n(7296);Object.defineProperty(t,"ConfigurationRequest",{enumerable:!0,get:function(){return c.ConfigurationRequest}});const l=n(5509);Object.defineProperty(t,"DocumentColorRequest",{enumerable:!0,get:function(){return l.DocumentColorRequest}}),Object.defineProperty(t,"ColorPresentationRequest",{enumerable:!0,get:function(){return l.ColorPresentationRequest}});const d=n(5171);Object.defineProperty(t,"FoldingRangeRequest",{enumerable:!0,get:function(){return d.FoldingRangeRequest}});const u=n(9137);Object.defineProperty(t,"DeclarationRequest",{enumerable:!0,get:function(){return u.DeclarationRequest}});const f=n(2964);Object.defineProperty(t,"SelectionRangeRequest",{enumerable:!0,get:function(){return f.SelectionRangeRequest}});const p=n(7450);Object.defineProperty(t,"WorkDoneProgress",{enumerable:!0,get:function(){return p.WorkDoneProgress}}),Object.defineProperty(t,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return p.WorkDoneProgressCreateRequest}}),Object.defineProperty(t,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return p.WorkDoneProgressCancelNotification}});const h=n(2565);Object.defineProperty(t,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return h.CallHierarchyIncomingCallsRequest}}),Object.defineProperty(t,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return h.CallHierarchyOutgoingCallsRequest}}),Object.defineProperty(t,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return h.CallHierarchyPrepareRequest}});const m=n(5402);Object.defineProperty(t,"SemanticTokenTypes",{enumerable:!0,get:function(){return m.SemanticTokenTypes}}),Object.defineProperty(t,"SemanticTokenModifiers",{enumerable:!0,get:function(){return m.SemanticTokenModifiers}}),Object.defineProperty(t,"SemanticTokens",{enumerable:!0,get:function(){return m.SemanticTokens}}),Object.defineProperty(t,"TokenFormat",{enumerable:!0,get:function(){return m.TokenFormat}}),Object.defineProperty(t,"SemanticTokensRequest",{enumerable:!0,get:function(){return m.SemanticTokensRequest}}),Object.defineProperty(t,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return m.SemanticTokensDeltaRequest}}),Object.defineProperty(t,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return m.SemanticTokensRangeRequest}}),Object.defineProperty(t,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return m.SemanticTokensRefreshRequest}}),Object.defineProperty(t,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return m.SemanticTokensRegistrationType}});const g=n(903);Object.defineProperty(t,"ShowDocumentRequest",{enumerable:!0,get:function(){return g.ShowDocumentRequest}});const y=n(7323);Object.defineProperty(t,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return y.LinkedEditingRangeRequest}});const v=n(2235);Object.defineProperty(t,"FileOperationPatternKind",{enumerable:!0,get:function(){return v.FileOperationPatternKind}}),Object.defineProperty(t,"DidCreateFilesNotification",{enumerable:!0,get:function(){return v.DidCreateFilesNotification}}),Object.defineProperty(t,"WillCreateFilesRequest",{enumerable:!0,get:function(){return v.WillCreateFilesRequest}}),Object.defineProperty(t,"DidRenameFilesNotification",{enumerable:!0,get:function(){return v.DidRenameFilesNotification}}),Object.defineProperty(t,"WillRenameFilesRequest",{enumerable:!0,get:function(){return v.WillRenameFilesRequest}}),Object.defineProperty(t,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return v.DidDeleteFilesNotification}}),Object.defineProperty(t,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return v.WillDeleteFilesRequest}});const b=n(9219);var _,k,T,R,w,S,C,x,E,D,O,K,P,A,L,N,M,I,j,q,F,W,$,U,B,V,H,z,G,Y,X,J,Q,Z,ee,te,ne,ie,oe,re;Object.defineProperty(t,"UniquenessLevel",{enumerable:!0,get:function(){return b.UniquenessLevel}}),Object.defineProperty(t,"MonikerKind",{enumerable:!0,get:function(){return b.MonikerKind}}),Object.defineProperty(t,"MonikerRequest",{enumerable:!0,get:function(){return b.MonikerRequest}}),function(e){e.is=function(e){const t=e;return i.string(t.language)||i.string(t.scheme)||i.string(t.pattern)}}(_=t.DocumentFilter||(t.DocumentFilter={})),function(e){e.is=function(e){if(!Array.isArray(e))return!1;for(let t of e)if(!i.string(t)&&!_.is(t))return!1;return!0}}(k=t.DocumentSelector||(t.DocumentSelector={})),(t.RegistrationRequest||(t.RegistrationRequest={})).type=new o.ProtocolRequestType("client/registerCapability"),(t.UnregistrationRequest||(t.UnregistrationRequest={})).type=new o.ProtocolRequestType("client/unregisterCapability"),(re=t.ResourceOperationKind||(t.ResourceOperationKind={})).Create="create",re.Rename="rename",re.Delete="delete",(oe=t.FailureHandlingKind||(t.FailureHandlingKind={})).Abort="abort",oe.Transactional="transactional",oe.TextOnlyTransactional="textOnlyTransactional",oe.Undo="undo",(t.StaticRegistrationOptions||(t.StaticRegistrationOptions={})).hasId=function(e){const t=e;return t&&i.string(t.id)&&t.id.length>0},(t.TextDocumentRegistrationOptions||(t.TextDocumentRegistrationOptions={})).is=function(e){const t=e;return t&&(null===t.documentSelector||k.is(t.documentSelector))},(ie=t.WorkDoneProgressOptions||(t.WorkDoneProgressOptions={})).is=function(e){const t=e;return i.objectLiteral(t)&&(void 0===t.workDoneProgress||i.boolean(t.workDoneProgress))},ie.hasWorkDoneProgress=function(e){const t=e;return t&&i.boolean(t.workDoneProgress)},(t.InitializeRequest||(t.InitializeRequest={})).type=new o.ProtocolRequestType("initialize"),(t.InitializeError||(t.InitializeError={})).unknownProtocolVersion=1,(t.InitializedNotification||(t.InitializedNotification={})).type=new o.ProtocolNotificationType("initialized"),(t.ShutdownRequest||(t.ShutdownRequest={})).type=new o.ProtocolRequestType0("shutdown"),(t.ExitNotification||(t.ExitNotification={})).type=new o.ProtocolNotificationType0("exit"),(t.DidChangeConfigurationNotification||(t.DidChangeConfigurationNotification={})).type=new o.ProtocolNotificationType("workspace/didChangeConfiguration"),(ne=t.MessageType||(t.MessageType={})).Error=1,ne.Warning=2,ne.Info=3,ne.Log=4,(t.ShowMessageNotification||(t.ShowMessageNotification={})).type=new o.ProtocolNotificationType("window/showMessage"),(t.ShowMessageRequest||(t.ShowMessageRequest={})).type=new o.ProtocolRequestType("window/showMessageRequest"),(t.LogMessageNotification||(t.LogMessageNotification={})).type=new o.ProtocolNotificationType("window/logMessage"),(t.TelemetryEventNotification||(t.TelemetryEventNotification={})).type=new o.ProtocolNotificationType("telemetry/event"),(te=t.TextDocumentSyncKind||(t.TextDocumentSyncKind={})).None=0,te.Full=1,te.Incremental=2,(ee=t.DidOpenTextDocumentNotification||(t.DidOpenTextDocumentNotification={})).method="textDocument/didOpen",ee.type=new o.ProtocolNotificationType(ee.method),(Z=t.TextDocumentContentChangeEvent||(t.TextDocumentContentChangeEvent={})).isIncremental=function(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0!==t.range&&(void 0===t.rangeLength||"number"==typeof t.rangeLength)},Z.isFull=function(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0===t.range&&void 0===t.rangeLength},(Q=t.DidChangeTextDocumentNotification||(t.DidChangeTextDocumentNotification={})).method="textDocument/didChange",Q.type=new o.ProtocolNotificationType(Q.method),(J=t.DidCloseTextDocumentNotification||(t.DidCloseTextDocumentNotification={})).method="textDocument/didClose",J.type=new o.ProtocolNotificationType(J.method),(X=t.DidSaveTextDocumentNotification||(t.DidSaveTextDocumentNotification={})).method="textDocument/didSave",X.type=new o.ProtocolNotificationType(X.method),(Y=t.TextDocumentSaveReason||(t.TextDocumentSaveReason={})).Manual=1,Y.AfterDelay=2,Y.FocusOut=3,(G=t.WillSaveTextDocumentNotification||(t.WillSaveTextDocumentNotification={})).method="textDocument/willSave",G.type=new o.ProtocolNotificationType(G.method),(z=t.WillSaveTextDocumentWaitUntilRequest||(t.WillSaveTextDocumentWaitUntilRequest={})).method="textDocument/willSaveWaitUntil",z.type=new o.ProtocolRequestType(z.method),(t.DidChangeWatchedFilesNotification||(t.DidChangeWatchedFilesNotification={})).type=new o.ProtocolNotificationType("workspace/didChangeWatchedFiles"),(H=t.FileChangeType||(t.FileChangeType={})).Created=1,H.Changed=2,H.Deleted=3,(V=t.WatchKind||(t.WatchKind={})).Create=1,V.Change=2,V.Delete=4,(t.PublishDiagnosticsNotification||(t.PublishDiagnosticsNotification={})).type=new o.ProtocolNotificationType("textDocument/publishDiagnostics"),(B=t.CompletionTriggerKind||(t.CompletionTriggerKind={})).Invoked=1,B.TriggerCharacter=2,B.TriggerForIncompleteCompletions=3,(U=t.CompletionRequest||(t.CompletionRequest={})).method="textDocument/completion",U.type=new o.ProtocolRequestType(U.method),($=t.CompletionResolveRequest||(t.CompletionResolveRequest={})).method="completionItem/resolve",$.type=new o.ProtocolRequestType($.method),(W=t.HoverRequest||(t.HoverRequest={})).method="textDocument/hover",W.type=new o.ProtocolRequestType(W.method),(F=t.SignatureHelpTriggerKind||(t.SignatureHelpTriggerKind={})).Invoked=1,F.TriggerCharacter=2,F.ContentChange=3,(q=t.SignatureHelpRequest||(t.SignatureHelpRequest={})).method="textDocument/signatureHelp",q.type=new o.ProtocolRequestType(q.method),(j=t.DefinitionRequest||(t.DefinitionRequest={})).method="textDocument/definition",j.type=new o.ProtocolRequestType(j.method),(I=t.ReferencesRequest||(t.ReferencesRequest={})).method="textDocument/references",I.type=new o.ProtocolRequestType(I.method),(M=t.DocumentHighlightRequest||(t.DocumentHighlightRequest={})).method="textDocument/documentHighlight",M.type=new o.ProtocolRequestType(M.method),(N=t.DocumentSymbolRequest||(t.DocumentSymbolRequest={})).method="textDocument/documentSymbol",N.type=new o.ProtocolRequestType(N.method),(L=t.CodeActionRequest||(t.CodeActionRequest={})).method="textDocument/codeAction",L.type=new o.ProtocolRequestType(L.method),(A=t.CodeActionResolveRequest||(t.CodeActionResolveRequest={})).method="codeAction/resolve",A.type=new o.ProtocolRequestType(A.method),(P=t.WorkspaceSymbolRequest||(t.WorkspaceSymbolRequest={})).method="workspace/symbol",P.type=new o.ProtocolRequestType(P.method),(K=t.CodeLensRequest||(t.CodeLensRequest={})).method="textDocument/codeLens",K.type=new o.ProtocolRequestType(K.method),(O=t.CodeLensResolveRequest||(t.CodeLensResolveRequest={})).method="codeLens/resolve",O.type=new o.ProtocolRequestType(O.method),(D=t.CodeLensRefreshRequest||(t.CodeLensRefreshRequest={})).method="workspace/codeLens/refresh",D.type=new o.ProtocolRequestType0(D.method),(E=t.DocumentLinkRequest||(t.DocumentLinkRequest={})).method="textDocument/documentLink",E.type=new o.ProtocolRequestType(E.method),(x=t.DocumentLinkResolveRequest||(t.DocumentLinkResolveRequest={})).method="documentLink/resolve",x.type=new o.ProtocolRequestType(x.method),(C=t.DocumentFormattingRequest||(t.DocumentFormattingRequest={})).method="textDocument/formatting",C.type=new o.ProtocolRequestType(C.method),(S=t.DocumentRangeFormattingRequest||(t.DocumentRangeFormattingRequest={})).method="textDocument/rangeFormatting",S.type=new o.ProtocolRequestType(S.method),(w=t.DocumentOnTypeFormattingRequest||(t.DocumentOnTypeFormattingRequest={})).method="textDocument/onTypeFormatting",w.type=new o.ProtocolRequestType(w.method),(t.PrepareSupportDefaultBehavior||(t.PrepareSupportDefaultBehavior={})).Identifier=1,(R=t.RenameRequest||(t.RenameRequest={})).method="textDocument/rename",R.type=new o.ProtocolRequestType(R.method),(T=t.PrepareRenameRequest||(t.PrepareRenameRequest={})).method="textDocument/prepareRename",T.type=new o.ProtocolRequestType(T.method),(t.ExecuteCommandRequest||(t.ExecuteCommandRequest={})).type=new o.ProtocolRequestType("workspace/executeCommand"),(t.ApplyWorkspaceEditRequest||(t.ApplyWorkspaceEditRequest={})).type=new o.ProtocolRequestType("workspace/applyEdit")},7323:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LinkedEditingRangeRequest=void 0;const i=n(4742);var o;(o=t.LinkedEditingRangeRequest||(t.LinkedEditingRangeRequest={})).method="textDocument/linkedEditingRange",o.type=new i.ProtocolRequestType(o.method)},9219:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MonikerRequest=t.MonikerKind=t.UniquenessLevel=void 0;const i=n(4742);var o,r,s;(s=t.UniquenessLevel||(t.UniquenessLevel={})).document="document",s.project="project",s.group="group",s.scheme="scheme",s.global="global",(r=t.MonikerKind||(t.MonikerKind={})).import="import",r.export="export",r.local="local",(o=t.MonikerRequest||(t.MonikerRequest={})).method="textDocument/moniker",o.type=new i.ProtocolRequestType(o.method)},7450:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WorkDoneProgressCancelNotification=t.WorkDoneProgressCreateRequest=t.WorkDoneProgress=void 0;const i=n(1694),o=n(4742);var r;(r=t.WorkDoneProgress||(t.WorkDoneProgress={})).type=new i.ProgressType,r.is=function(e){return e===r.type},(t.WorkDoneProgressCreateRequest||(t.WorkDoneProgressCreateRequest={})).type=new o.ProtocolRequestType("window/workDoneProgress/create"),(t.WorkDoneProgressCancelNotification||(t.WorkDoneProgressCancelNotification={})).type=new o.ProtocolNotificationType("window/workDoneProgress/cancel")},2964:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionRangeRequest=void 0;const i=n(4742);var o;(o=t.SelectionRangeRequest||(t.SelectionRangeRequest={})).method="textDocument/selectionRange",o.type=new i.ProtocolRequestType(o.method)},5402:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticTokensRefreshRequest=t.SemanticTokensRangeRequest=t.SemanticTokensDeltaRequest=t.SemanticTokensRequest=t.SemanticTokensRegistrationType=t.TokenFormat=t.SemanticTokens=t.SemanticTokenModifiers=t.SemanticTokenTypes=void 0;const i=n(4742);var o,r,s,a,c,l,d;(d=t.SemanticTokenTypes||(t.SemanticTokenTypes={})).namespace="namespace",d.type="type",d.class="class",d.enum="enum",d.interface="interface",d.struct="struct",d.typeParameter="typeParameter",d.parameter="parameter",d.variable="variable",d.property="property",d.enumMember="enumMember",d.event="event",d.function="function",d.method="method",d.macro="macro",d.keyword="keyword",d.modifier="modifier",d.comment="comment",d.string="string",d.number="number",d.regexp="regexp",d.operator="operator",(l=t.SemanticTokenModifiers||(t.SemanticTokenModifiers={})).declaration="declaration",l.definition="definition",l.readonly="readonly",l.static="static",l.deprecated="deprecated",l.abstract="abstract",l.async="async",l.modification="modification",l.documentation="documentation",l.defaultLibrary="defaultLibrary",(t.SemanticTokens||(t.SemanticTokens={})).is=function(e){const t=e;return void 0!==t&&(void 0===t.resultId||"string"==typeof t.resultId)&&Array.isArray(t.data)&&(0===t.data.length||"number"==typeof t.data[0])},(t.TokenFormat||(t.TokenFormat={})).Relative="relative",(c=t.SemanticTokensRegistrationType||(t.SemanticTokensRegistrationType={})).method="textDocument/semanticTokens",c.type=new i.RegistrationType(c.method),(a=t.SemanticTokensRequest||(t.SemanticTokensRequest={})).method="textDocument/semanticTokens/full",a.type=new i.ProtocolRequestType(a.method),(s=t.SemanticTokensDeltaRequest||(t.SemanticTokensDeltaRequest={})).method="textDocument/semanticTokens/full/delta",s.type=new i.ProtocolRequestType(s.method),(r=t.SemanticTokensRangeRequest||(t.SemanticTokensRangeRequest={})).method="textDocument/semanticTokens/range",r.type=new i.ProtocolRequestType(r.method),(o=t.SemanticTokensRefreshRequest||(t.SemanticTokensRefreshRequest={})).method="workspace/semanticTokens/refresh",o.type=new i.ProtocolRequestType0(o.method)},903:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ShowDocumentRequest=void 0;const i=n(4742);var o;(o=t.ShowDocumentRequest||(t.ShowDocumentRequest={})).method="window/showDocument",o.type=new i.ProtocolRequestType(o.method)},8685:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TypeDefinitionRequest=void 0;const i=n(4742);var o;(o=t.TypeDefinitionRequest||(t.TypeDefinitionRequest={})).method="textDocument/typeDefinition",o.type=new i.ProtocolRequestType(o.method)},1343:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DidChangeWorkspaceFoldersNotification=t.WorkspaceFoldersRequest=void 0;const i=n(4742);(t.WorkspaceFoldersRequest||(t.WorkspaceFoldersRequest={})).type=new i.ProtocolRequestType0("workspace/workspaceFolders"),(t.DidChangeWorkspaceFoldersNotification||(t.DidChangeWorkspaceFoldersNotification={})).type=new i.ProtocolNotificationType("workspace/didChangeWorkspaceFolders")},9348:(e,t)=>{function n(e){return"string"==typeof e||e instanceof String}function i(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.objectLiteral=t.typedArray=t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=n,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=i,t.stringArray=function(e){return i(e)&&e.every((e=>n(e)))},t.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},t.objectLiteral=function(e){return null!==e&&"object"==typeof e}},7745:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.createProtocolConnection=void 0;const r=n(2659);o(n(2659),t),o(n(559),t),t.createProtocolConnection=function(e,t,n,i){return r.createMessageConnection(e,t,n,i)}},4057:(e,t,n)=>{e.exports=n(7745)},6288:(e,t,n)=>{n.r(t),n.d(t,{TextDocument:()=>i});var i,o=function(){function e(e,t,n,i){this._uri=e,this._languageId=t,this._version=n,this._content=i,this._lineOffsets=void 0}return Object.defineProperty(e.prototype,"uri",{get:function(){return this._uri},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"languageId",{get:function(){return this._languageId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!0,configurable:!0}),e.prototype.getText=function(e){if(e){var t=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(t,n)}return this._content},e.prototype.update=function(t,n){for(var i=0,o=t;i<o.length;i++){var r=o[i];if(e.isIncremental(r)){var c=a(r.range),l=this.offsetAt(c.start),d=this.offsetAt(c.end);this._content=this._content.substring(0,l)+r.text+this._content.substring(d,this._content.length);var u=Math.max(c.start.line,0),f=Math.max(c.end.line,0),p=this._lineOffsets,h=s(r.text,!1,l);if(f-u===h.length)for(var m=0,g=h.length;m<g;m++)p[m+u+1]=h[m];else h.length<1e4?p.splice.apply(p,[u+1,f-u].concat(h)):this._lineOffsets=p=p.slice(0,u+1).concat(h,p.slice(f+1));var y=r.text.length-(d-l);if(0!==y)for(m=u+1+h.length,g=p.length;m<g;m++)p[m]=p[m]+y}else{if(!e.isFull(r))throw new Error("Unknown change event received");this._content=r.text,this._lineOffsets=void 0}}this._version=n},e.prototype.getLineOffsets=function(){return void 0===this._lineOffsets&&(this._lineOffsets=s(this._content,!0)),this._lineOffsets},e.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var t=this.getLineOffsets(),n=0,i=t.length;if(0===i)return{line:0,character:e};for(;n<i;){var o=Math.floor((n+i)/2);t[o]>e?i=o:n=o+1}var r=n-1;return{line:r,character:e-t[r]}},e.prototype.offsetAt=function(e){var t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;var n=t[e.line],i=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,i),n)},Object.defineProperty(e.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!0,configurable:!0}),e.isIncremental=function(e){var t=e;return null!=t&&"string"==typeof t.text&&void 0!==t.range&&(void 0===t.rangeLength||"number"==typeof t.rangeLength)},e.isFull=function(e){var t=e;return null!=t&&"string"==typeof t.text&&void 0===t.range&&void 0===t.rangeLength},e}();function r(e,t){if(e.length<=1)return e;var n=e.length/2|0,i=e.slice(0,n),o=e.slice(n);r(i,t),r(o,t);for(var s=0,a=0,c=0;s<i.length&&a<o.length;){var l=t(i[s],o[a]);e[c++]=l<=0?i[s++]:o[a++]}for(;s<i.length;)e[c++]=i[s++];for(;a<o.length;)e[c++]=o[a++];return e}function s(e,t,n){void 0===n&&(n=0);for(var i=t?[n]:[],o=0;o<e.length;o++){var r=e.charCodeAt(o);13!==r&&10!==r||(13===r&&o+1<e.length&&10===e.charCodeAt(o+1)&&o++,i.push(n+o+1))}return i}function a(e){var t=e.start,n=e.end;return t.line>n.line||t.line===n.line&&t.character>n.character?{start:n,end:t}:e}function c(e){var t=a(e.range);return t!==e.range?{newText:e.newText,range:t}:e}!function(e){e.create=function(e,t,n,i){return new o(e,t,n,i)},e.update=function(e,t,n){if(e instanceof o)return e.update(t,n),e;throw new Error("TextDocument.update: document must be created by TextDocument.create")},e.applyEdits=function(e,t){for(var n=e.getText(),i=0,o=[],s=0,a=r(t.map(c),(function(e,t){var n=e.range.start.line-t.range.start.line;return 0===n?e.range.start.character-t.range.start.character:n}));s<a.length;s++){var l=a[s],d=e.offsetAt(l.range.start);if(d<i)throw new Error("Overlapping edit");d>i&&o.push(n.substring(i,d)),l.newText.length&&o.push(l.newText),i=e.offsetAt(l.range.end)}return o.push(n.substr(i)),o.join("")}}(i||(i={}))},2880:(e,t,n)=>{var i,o,r,s,a,c,l,d,u,f,p,h,m,g,y,v,b,_,k,T,R,w,S,C,x,E;n.r(t),n.d(t,{AnnotatedTextEdit:()=>R,ChangeAnnotation:()=>k,ChangeAnnotationIdentifier:()=>T,CodeAction:()=>ee,CodeActionContext:()=>Z,CodeActionKind:()=>Q,CodeDescription:()=>y,CodeLens:()=>te,Color:()=>l,ColorInformation:()=>d,ColorPresentation:()=>u,Command:()=>b,CompletionItem:()=>F,CompletionItemKind:()=>N,CompletionItemTag:()=>I,CompletionList:()=>W,CreateFile:()=>S,DeleteFile:()=>x,Diagnostic:()=>v,DiagnosticRelatedInformation:()=>h,DiagnosticSeverity:()=>m,DiagnosticTag:()=>g,DocumentHighlight:()=>z,DocumentHighlightKind:()=>H,DocumentLink:()=>ie,DocumentSymbol:()=>J,EOL:()=>le,FoldingRange:()=>p,FoldingRangeKind:()=>f,FormattingOptions:()=>ne,Hover:()=>U,InsertReplaceEdit:()=>j,InsertTextFormat:()=>M,InsertTextMode:()=>q,Location:()=>a,LocationLink:()=>c,MarkedString:()=>$,MarkupContent:()=>L,MarkupKind:()=>A,OptionalVersionedTextDocumentIdentifier:()=>K,ParameterInformation:()=>B,Position:()=>r,Range:()=>s,RenameFile:()=>C,SelectionRange:()=>oe,SignatureInformation:()=>V,SymbolInformation:()=>X,SymbolKind:()=>G,SymbolTag:()=>Y,TextDocument:()=>ce,TextDocumentEdit:()=>w,TextDocumentIdentifier:()=>D,TextDocumentItem:()=>P,TextEdit:()=>_,VersionedTextDocumentIdentifier:()=>O,WorkspaceChange:()=>ae,WorkspaceEdit:()=>E,integer:()=>i,uinteger:()=>o}),function(e){e.MIN_VALUE=-2147483648,e.MAX_VALUE=2147483647}(i||(i={})),function(e){e.MIN_VALUE=0,e.MAX_VALUE=2147483647}(o||(o={})),function(e){e.create=function(e,t){return e===Number.MAX_VALUE&&(e=o.MAX_VALUE),t===Number.MAX_VALUE&&(t=o.MAX_VALUE),{line:e,character:t}},e.is=function(e){var t=e;return de.objectLiteral(t)&&de.uinteger(t.line)&&de.uinteger(t.character)}}(r||(r={})),function(e){e.create=function(e,t,n,i){if(de.uinteger(e)&&de.uinteger(t)&&de.uinteger(n)&&de.uinteger(i))return{start:r.create(e,t),end:r.create(n,i)};if(r.is(e)&&r.is(t))return{start:e,end:t};throw new Error("Range#create called with invalid arguments["+e+", "+t+", "+n+", "+i+"]")},e.is=function(e){var t=e;return de.objectLiteral(t)&&r.is(t.start)&&r.is(t.end)}}(s||(s={})),function(e){e.create=function(e,t){return{uri:e,range:t}},e.is=function(e){var t=e;return de.defined(t)&&s.is(t.range)&&(de.string(t.uri)||de.undefined(t.uri))}}(a||(a={})),function(e){e.create=function(e,t,n,i){return{targetUri:e,targetRange:t,targetSelectionRange:n,originSelectionRange:i}},e.is=function(e){var t=e;return de.defined(t)&&s.is(t.targetRange)&&de.string(t.targetUri)&&(s.is(t.targetSelectionRange)||de.undefined(t.targetSelectionRange))&&(s.is(t.originSelectionRange)||de.undefined(t.originSelectionRange))}}(c||(c={})),function(e){e.create=function(e,t,n,i){return{red:e,green:t,blue:n,alpha:i}},e.is=function(e){var t=e;return de.numberRange(t.red,0,1)&&de.numberRange(t.green,0,1)&&de.numberRange(t.blue,0,1)&&de.numberRange(t.alpha,0,1)}}(l||(l={})),function(e){e.create=function(e,t){return{range:e,color:t}},e.is=function(e){var t=e;return s.is(t.range)&&l.is(t.color)}}(d||(d={})),function(e){e.create=function(e,t,n){return{label:e,textEdit:t,additionalTextEdits:n}},e.is=function(e){var t=e;return de.string(t.label)&&(de.undefined(t.textEdit)||_.is(t))&&(de.undefined(t.additionalTextEdits)||de.typedArray(t.additionalTextEdits,_.is))}}(u||(u={})),function(e){e.Comment="comment",e.Imports="imports",e.Region="region"}(f||(f={})),function(e){e.create=function(e,t,n,i,o){var r={startLine:e,endLine:t};return de.defined(n)&&(r.startCharacter=n),de.defined(i)&&(r.endCharacter=i),de.defined(o)&&(r.kind=o),r},e.is=function(e){var t=e;return de.uinteger(t.startLine)&&de.uinteger(t.startLine)&&(de.undefined(t.startCharacter)||de.uinteger(t.startCharacter))&&(de.undefined(t.endCharacter)||de.uinteger(t.endCharacter))&&(de.undefined(t.kind)||de.string(t.kind))}}(p||(p={})),function(e){e.create=function(e,t){return{location:e,message:t}},e.is=function(e){var t=e;return de.defined(t)&&a.is(t.location)&&de.string(t.message)}}(h||(h={})),function(e){e.Error=1,e.Warning=2,e.Information=3,e.Hint=4}(m||(m={})),function(e){e.Unnecessary=1,e.Deprecated=2}(g||(g={})),function(e){e.is=function(e){var t=e;return null!=t&&de.string(t.href)}}(y||(y={})),function(e){e.create=function(e,t,n,i,o,r){var s={range:e,message:t};return de.defined(n)&&(s.severity=n),de.defined(i)&&(s.code=i),de.defined(o)&&(s.source=o),de.defined(r)&&(s.relatedInformation=r),s},e.is=function(e){var t,n=e;return de.defined(n)&&s.is(n.range)&&de.string(n.message)&&(de.number(n.severity)||de.undefined(n.severity))&&(de.integer(n.code)||de.string(n.code)||de.undefined(n.code))&&(de.undefined(n.codeDescription)||de.string(null===(t=n.codeDescription)||void 0===t?void 0:t.href))&&(de.string(n.source)||de.undefined(n.source))&&(de.undefined(n.relatedInformation)||de.typedArray(n.relatedInformation,h.is))}}(v||(v={})),function(e){e.create=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o={title:e,command:t};return de.defined(n)&&n.length>0&&(o.arguments=n),o},e.is=function(e){var t=e;return de.defined(t)&&de.string(t.title)&&de.string(t.command)}}(b||(b={})),function(e){e.replace=function(e,t){return{range:e,newText:t}},e.insert=function(e,t){return{range:{start:e,end:e},newText:t}},e.del=function(e){return{range:e,newText:""}},e.is=function(e){var t=e;return de.objectLiteral(t)&&de.string(t.newText)&&s.is(t.range)}}(_||(_={})),function(e){e.create=function(e,t,n){var i={label:e};return void 0!==t&&(i.needsConfirmation=t),void 0!==n&&(i.description=n),i},e.is=function(e){var t=e;return void 0!==t&&de.objectLiteral(t)&&de.string(t.label)&&(de.boolean(t.needsConfirmation)||void 0===t.needsConfirmation)&&(de.string(t.description)||void 0===t.description)}}(k||(k={})),function(e){e.is=function(e){return"string"==typeof e}}(T||(T={})),function(e){e.replace=function(e,t,n){return{range:e,newText:t,annotationId:n}},e.insert=function(e,t,n){return{range:{start:e,end:e},newText:t,annotationId:n}},e.del=function(e,t){return{range:e,newText:"",annotationId:t}},e.is=function(e){var t=e;return _.is(t)&&(k.is(t.annotationId)||T.is(t.annotationId))}}(R||(R={})),function(e){e.create=function(e,t){return{textDocument:e,edits:t}},e.is=function(e){var t=e;return de.defined(t)&&K.is(t.textDocument)&&Array.isArray(t.edits)}}(w||(w={})),function(e){e.create=function(e,t,n){var i={kind:"create",uri:e};return void 0===t||void 0===t.overwrite&&void 0===t.ignoreIfExists||(i.options=t),void 0!==n&&(i.annotationId=n),i},e.is=function(e){var t=e;return t&&"create"===t.kind&&de.string(t.uri)&&(void 0===t.options||(void 0===t.options.overwrite||de.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||de.boolean(t.options.ignoreIfExists)))&&(void 0===t.annotationId||T.is(t.annotationId))}}(S||(S={})),function(e){e.create=function(e,t,n,i){var o={kind:"rename",oldUri:e,newUri:t};return void 0===n||void 0===n.overwrite&&void 0===n.ignoreIfExists||(o.options=n),void 0!==i&&(o.annotationId=i),o},e.is=function(e){var t=e;return t&&"rename"===t.kind&&de.string(t.oldUri)&&de.string(t.newUri)&&(void 0===t.options||(void 0===t.options.overwrite||de.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||de.boolean(t.options.ignoreIfExists)))&&(void 0===t.annotationId||T.is(t.annotationId))}}(C||(C={})),function(e){e.create=function(e,t,n){var i={kind:"delete",uri:e};return void 0===t||void 0===t.recursive&&void 0===t.ignoreIfNotExists||(i.options=t),void 0!==n&&(i.annotationId=n),i},e.is=function(e){var t=e;return t&&"delete"===t.kind&&de.string(t.uri)&&(void 0===t.options||(void 0===t.options.recursive||de.boolean(t.options.recursive))&&(void 0===t.options.ignoreIfNotExists||de.boolean(t.options.ignoreIfNotExists)))&&(void 0===t.annotationId||T.is(t.annotationId))}}(x||(x={})),function(e){e.is=function(e){var t=e;return t&&(void 0!==t.changes||void 0!==t.documentChanges)&&(void 0===t.documentChanges||t.documentChanges.every((function(e){return de.string(e.kind)?S.is(e)||C.is(e)||x.is(e):w.is(e)})))}}(E||(E={}));var D,O,K,P,A,L,N,M,I,j,q,F,W,$,U,B,V,H,z,G,Y,X,J,Q,Z,ee,te,ne,ie,oe,re=function(){function e(e,t){this.edits=e,this.changeAnnotations=t}return e.prototype.insert=function(e,t,n){var i,o;if(void 0===n?i=_.insert(e,t):T.is(n)?(o=n,i=R.insert(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(n),i=R.insert(e,t,o)),this.edits.push(i),void 0!==o)return o},e.prototype.replace=function(e,t,n){var i,o;if(void 0===n?i=_.replace(e,t):T.is(n)?(o=n,i=R.replace(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(n),i=R.replace(e,t,o)),this.edits.push(i),void 0!==o)return o},e.prototype.delete=function(e,t){var n,i;if(void 0===t?n=_.del(e):T.is(t)?(i=t,n=R.del(e,t)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(t),n=R.del(e,i)),this.edits.push(n),void 0!==i)return i},e.prototype.add=function(e){this.edits.push(e)},e.prototype.all=function(){return this.edits},e.prototype.clear=function(){this.edits.splice(0,this.edits.length)},e.prototype.assertChangeAnnotations=function(e){if(void 0===e)throw new Error("Text edit change is not configured to manage change annotations.")},e}(),se=function(){function e(e){this._annotations=void 0===e?Object.create(null):e,this._counter=0,this._size=0}return e.prototype.all=function(){return this._annotations},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),e.prototype.manage=function(e,t){var n;if(T.is(e)?n=e:(n=this.nextId(),t=e),void 0!==this._annotations[n])throw new Error("Id "+n+" is already in use.");if(void 0===t)throw new Error("No annotation provided for id "+n);return this._annotations[n]=t,this._size++,n},e.prototype.nextId=function(){return this._counter++,this._counter.toString()},e}(),ae=function(){function e(e){var t=this;this._textEditChanges=Object.create(null),void 0!==e?(this._workspaceEdit=e,e.documentChanges?(this._changeAnnotations=new se(e.changeAnnotations),e.changeAnnotations=this._changeAnnotations.all(),e.documentChanges.forEach((function(e){if(w.is(e)){var n=new re(e.edits,t._changeAnnotations);t._textEditChanges[e.textDocument.uri]=n}}))):e.changes&&Object.keys(e.changes).forEach((function(n){var i=new re(e.changes[n]);t._textEditChanges[n]=i}))):this._workspaceEdit={}}return Object.defineProperty(e.prototype,"edit",{get:function(){return this.initDocumentChanges(),void 0!==this._changeAnnotations&&(0===this._changeAnnotations.size?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),e.prototype.getTextEditChange=function(e){if(K.is(e)){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var t={uri:e.uri,version:e.version};if(!(i=this._textEditChanges[t.uri])){var n={textDocument:t,edits:o=[]};this._workspaceEdit.documentChanges.push(n),i=new re(o,this._changeAnnotations),this._textEditChanges[t.uri]=i}return i}if(this.initChanges(),void 0===this._workspaceEdit.changes)throw new Error("Workspace edit is not configured for normal text edit changes.");var i;if(!(i=this._textEditChanges[e])){var o=[];this._workspaceEdit.changes[e]=o,i=new re(o),this._textEditChanges[e]=i}return i},e.prototype.initDocumentChanges=function(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._changeAnnotations=new se,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},e.prototype.initChanges=function(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._workspaceEdit.changes=Object.create(null))},e.prototype.createFile=function(e,t,n){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var i,o,r;if(k.is(t)||T.is(t)?i=t:n=t,void 0===i?o=S.create(e,n):(r=T.is(i)?i:this._changeAnnotations.manage(i),o=S.create(e,n,r)),this._workspaceEdit.documentChanges.push(o),void 0!==r)return r},e.prototype.renameFile=function(e,t,n,i){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var o,r,s;if(k.is(n)||T.is(n)?o=n:i=n,void 0===o?r=C.create(e,t,i):(s=T.is(o)?o:this._changeAnnotations.manage(o),r=C.create(e,t,i,s)),this._workspaceEdit.documentChanges.push(r),void 0!==s)return s},e.prototype.deleteFile=function(e,t,n){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var i,o,r;if(k.is(t)||T.is(t)?i=t:n=t,void 0===i?o=x.create(e,n):(r=T.is(i)?i:this._changeAnnotations.manage(i),o=x.create(e,n,r)),this._workspaceEdit.documentChanges.push(o),void 0!==r)return r},e}();!function(e){e.create=function(e){return{uri:e}},e.is=function(e){var t=e;return de.defined(t)&&de.string(t.uri)}}(D||(D={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){var t=e;return de.defined(t)&&de.string(t.uri)&&de.integer(t.version)}}(O||(O={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){var t=e;return de.defined(t)&&de.string(t.uri)&&(null===t.version||de.integer(t.version))}}(K||(K={})),function(e){e.create=function(e,t,n,i){return{uri:e,languageId:t,version:n,text:i}},e.is=function(e){var t=e;return de.defined(t)&&de.string(t.uri)&&de.string(t.languageId)&&de.integer(t.version)&&de.string(t.text)}}(P||(P={})),function(e){e.PlainText="plaintext",e.Markdown="markdown"}(A||(A={})),function(e){e.is=function(t){var n=t;return n===e.PlainText||n===e.Markdown}}(A||(A={})),function(e){e.is=function(e){var t=e;return de.objectLiteral(e)&&A.is(t.kind)&&de.string(t.value)}}(L||(L={})),function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25}(N||(N={})),function(e){e.PlainText=1,e.Snippet=2}(M||(M={})),function(e){e.Deprecated=1}(I||(I={})),function(e){e.create=function(e,t,n){return{newText:e,insert:t,replace:n}},e.is=function(e){var t=e;return t&&de.string(t.newText)&&s.is(t.insert)&&s.is(t.replace)}}(j||(j={})),function(e){e.asIs=1,e.adjustIndentation=2}(q||(q={})),function(e){e.create=function(e){return{label:e}}}(F||(F={})),function(e){e.create=function(e,t){return{items:e||[],isIncomplete:!!t}}}(W||(W={})),function(e){e.fromPlainText=function(e){return e.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")},e.is=function(e){var t=e;return de.string(t)||de.objectLiteral(t)&&de.string(t.language)&&de.string(t.value)}}($||($={})),function(e){e.is=function(e){var t=e;return!!t&&de.objectLiteral(t)&&(L.is(t.contents)||$.is(t.contents)||de.typedArray(t.contents,$.is))&&(void 0===e.range||s.is(e.range))}}(U||(U={})),function(e){e.create=function(e,t){return t?{label:e,documentation:t}:{label:e}}}(B||(B={})),function(e){e.create=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o={label:e};return de.defined(t)&&(o.documentation=t),de.defined(n)?o.parameters=n:o.parameters=[],o}}(V||(V={})),function(e){e.Text=1,e.Read=2,e.Write=3}(H||(H={})),function(e){e.create=function(e,t){var n={range:e};return de.number(t)&&(n.kind=t),n}}(z||(z={})),function(e){e.File=1,e.Module=2,e.Namespace=3,e.Package=4,e.Class=5,e.Method=6,e.Property=7,e.Field=8,e.Constructor=9,e.Enum=10,e.Interface=11,e.Function=12,e.Variable=13,e.Constant=14,e.String=15,e.Number=16,e.Boolean=17,e.Array=18,e.Object=19,e.Key=20,e.Null=21,e.EnumMember=22,e.Struct=23,e.Event=24,e.Operator=25,e.TypeParameter=26}(G||(G={})),function(e){e.Deprecated=1}(Y||(Y={})),function(e){e.create=function(e,t,n,i,o){var r={name:e,kind:t,location:{uri:i,range:n}};return o&&(r.containerName=o),r}}(X||(X={})),function(e){e.create=function(e,t,n,i,o,r){var s={name:e,detail:t,kind:n,range:i,selectionRange:o};return void 0!==r&&(s.children=r),s},e.is=function(e){var t=e;return t&&de.string(t.name)&&de.number(t.kind)&&s.is(t.range)&&s.is(t.selectionRange)&&(void 0===t.detail||de.string(t.detail))&&(void 0===t.deprecated||de.boolean(t.deprecated))&&(void 0===t.children||Array.isArray(t.children))&&(void 0===t.tags||Array.isArray(t.tags))}}(J||(J={})),function(e){e.Empty="",e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports",e.SourceFixAll="source.fixAll"}(Q||(Q={})),function(e){e.create=function(e,t){var n={diagnostics:e};return null!=t&&(n.only=t),n},e.is=function(e){var t=e;return de.defined(t)&&de.typedArray(t.diagnostics,v.is)&&(void 0===t.only||de.typedArray(t.only,de.string))}}(Z||(Z={})),function(e){e.create=function(e,t,n){var i={title:e},o=!0;return"string"==typeof t?(o=!1,i.kind=t):b.is(t)?i.command=t:i.edit=t,o&&void 0!==n&&(i.kind=n),i},e.is=function(e){var t=e;return t&&de.string(t.title)&&(void 0===t.diagnostics||de.typedArray(t.diagnostics,v.is))&&(void 0===t.kind||de.string(t.kind))&&(void 0!==t.edit||void 0!==t.command)&&(void 0===t.command||b.is(t.command))&&(void 0===t.isPreferred||de.boolean(t.isPreferred))&&(void 0===t.edit||E.is(t.edit))}}(ee||(ee={})),function(e){e.create=function(e,t){var n={range:e};return de.defined(t)&&(n.data=t),n},e.is=function(e){var t=e;return de.defined(t)&&s.is(t.range)&&(de.undefined(t.command)||b.is(t.command))}}(te||(te={})),function(e){e.create=function(e,t){return{tabSize:e,insertSpaces:t}},e.is=function(e){var t=e;return de.defined(t)&&de.uinteger(t.tabSize)&&de.boolean(t.insertSpaces)}}(ne||(ne={})),function(e){e.create=function(e,t,n){return{range:e,target:t,data:n}},e.is=function(e){var t=e;return de.defined(t)&&s.is(t.range)&&(de.undefined(t.target)||de.string(t.target))}}(ie||(ie={})),function(e){e.create=function(e,t){return{range:e,parent:t}},e.is=function(t){var n=t;return void 0!==n&&s.is(n.range)&&(void 0===n.parent||e.is(n.parent))}}(oe||(oe={}));var ce,le=["\n","\r\n","\r"];!function(e){function t(e,n){if(e.length<=1)return e;var i=e.length/2|0,o=e.slice(0,i),r=e.slice(i);t(o,n),t(r,n);for(var s=0,a=0,c=0;s<o.length&&a<r.length;){var l=n(o[s],r[a]);e[c++]=l<=0?o[s++]:r[a++]}for(;s<o.length;)e[c++]=o[s++];for(;a<r.length;)e[c++]=r[a++];return e}e.create=function(e,t,n,i){return new ue(e,t,n,i)},e.is=function(e){var t=e;return!!(de.defined(t)&&de.string(t.uri)&&(de.undefined(t.languageId)||de.string(t.languageId))&&de.uinteger(t.lineCount)&&de.func(t.getText)&&de.func(t.positionAt)&&de.func(t.offsetAt))},e.applyEdits=function(e,n){for(var i=e.getText(),o=t(n,(function(e,t){var n=e.range.start.line-t.range.start.line;return 0===n?e.range.start.character-t.range.start.character:n})),r=i.length,s=o.length-1;s>=0;s--){var a=o[s],c=e.offsetAt(a.range.start),l=e.offsetAt(a.range.end);if(!(l<=r))throw new Error("Overlapping edit");i=i.substring(0,c)+a.newText+i.substring(l,i.length),r=c}return i}}(ce||(ce={}));var de,ue=function(){function e(e,t,n,i){this._uri=e,this._languageId=t,this._version=n,this._content=i,this._lineOffsets=void 0}return Object.defineProperty(e.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),e.prototype.getText=function(e){if(e){var t=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(t,n)}return this._content},e.prototype.update=function(e,t){this._content=e.text,this._version=t,this._lineOffsets=void 0},e.prototype.getLineOffsets=function(){if(void 0===this._lineOffsets){for(var e=[],t=this._content,n=!0,i=0;i<t.length;i++){n&&(e.push(i),n=!1);var o=t.charAt(i);n="\r"===o||"\n"===o,"\r"===o&&i+1<t.length&&"\n"===t.charAt(i+1)&&i++}n&&t.length>0&&e.push(t.length),this._lineOffsets=e}return this._lineOffsets},e.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var t=this.getLineOffsets(),n=0,i=t.length;if(0===i)return r.create(0,e);for(;n<i;){var o=Math.floor((n+i)/2);t[o]>e?i=o:n=o+1}var s=n-1;return r.create(s,e-t[s])},e.prototype.offsetAt=function(e){var t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;var n=t[e.line],i=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,i),n)},Object.defineProperty(e.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),e}();!function(e){var t=Object.prototype.toString;e.defined=function(e){return void 0!==e},e.undefined=function(e){return void 0===e},e.boolean=function(e){return!0===e||!1===e},e.string=function(e){return"[object String]"===t.call(e)},e.number=function(e){return"[object Number]"===t.call(e)},e.numberRange=function(e,n,i){return"[object Number]"===t.call(e)&&n<=e&&e<=i},e.integer=function(e){return"[object Number]"===t.call(e)&&-2147483648<=e&&e<=2147483647},e.uinteger=function(e){return"[object Number]"===t.call(e)&&0<=e&&e<=2147483647},e.func=function(e){return"[object Function]"===t.call(e)},e.objectLiteral=function(e){return null!==e&&"object"==typeof e},e.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)}}(de||(de={}))},9936:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.ProposedFeatures=t.SemanticTokensBuilder=void 0;const r=n(7255);Object.defineProperty(t,"SemanticTokensBuilder",{enumerable:!0,get:function(){return r.SemanticTokensBuilder}}),o(n(7745),t),o(n(6717),t),(t.ProposedFeatures||(t.ProposedFeatures={})).all={__brand:"features"}},4225:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CallHierarchyFeature=void 0;const i=n(7745);t.CallHierarchyFeature=e=>class extends e{get callHierarchy(){return{onPrepare:e=>{this.connection.onRequest(i.CallHierarchyPrepareRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t),void 0)))},onIncomingCalls:e=>{const t=i.CallHierarchyIncomingCallsRequest.type;this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))},onOutgoingCalls:e=>{const t=i.CallHierarchyOutgoingCallsRequest.type;this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}}},3606:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigurationFeature=void 0;const i=n(7745),o=n(6960);t.ConfigurationFeature=e=>class extends e{getConfiguration(e){return e?o.string(e)?this._getConfiguration({section:e}):this._getConfiguration(e):this._getConfiguration({})}_getConfiguration(e){let t={items:Array.isArray(e)?e:[e]};return this.connection.sendRequest(i.ConfigurationRequest.type,t).then((t=>Array.isArray(e)?t:t[0]))}}},7695:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FileOperationsFeature=void 0;const i=n(7745);t.FileOperationsFeature=e=>class extends e{onDidCreateFiles(e){this.connection.onNotification(i.DidCreateFilesNotification.type,(t=>{e(t)}))}onDidRenameFiles(e){this.connection.onNotification(i.DidRenameFilesNotification.type,(t=>{e(t)}))}onDidDeleteFiles(e){this.connection.onNotification(i.DidDeleteFilesNotification.type,(t=>{e(t)}))}onWillCreateFiles(e){return this.connection.onRequest(i.WillCreateFilesRequest.type,((t,n)=>e(t,n)))}onWillRenameFiles(e){return this.connection.onRequest(i.WillRenameFilesRequest.type,((t,n)=>e(t,n)))}onWillDeleteFiles(e){return this.connection.onRequest(i.WillDeleteFilesRequest.type,((t,n)=>e(t,n)))}}},7129:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LinkedEditingRangeFeature=void 0;const i=n(7745);t.LinkedEditingRangeFeature=e=>class extends e{onLinkedEditingRange(e){this.connection.onRequest(i.LinkedEditingRangeRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t),void 0)))}}},8535:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MonikerFeature=void 0;const i=n(7745);t.MonikerFeature=e=>class extends e{get moniker(){return{on:e=>{const t=i.MonikerRequest.type;this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}}},3787:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.attachPartialResult=t.ProgressFeature=t.attachWorkDone=void 0;const i=n(7745),o=n(7867);class r{constructor(e,t){this._connection=e,this._token=t,r.Instances.set(this._token,this)}begin(e,t,n,o){let r={kind:"begin",title:e,percentage:t,message:n,cancellable:o};this._connection.sendProgress(i.WorkDoneProgress.type,this._token,r)}report(e,t){let n={kind:"report"};"number"==typeof e?(n.percentage=e,void 0!==t&&(n.message=t)):n.message=e,this._connection.sendProgress(i.WorkDoneProgress.type,this._token,n)}done(){r.Instances.delete(this._token),this._connection.sendProgress(i.WorkDoneProgress.type,this._token,{kind:"end"})}}r.Instances=new Map;class s extends r{constructor(e,t){super(e,t),this._source=new i.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose(),super.done()}cancel(){this._source.cancel()}}class a{constructor(){}begin(){}report(){}done(){}}class c extends a{constructor(){super(),this._source=new i.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose()}cancel(){this._source.cancel()}}var l;t.attachWorkDone=function(e,t){if(void 0===t||void 0===t.workDoneToken)return new a;const n=t.workDoneToken;return delete t.workDoneToken,new r(e,n)},t.ProgressFeature=e=>class extends e{constructor(){super(),this._progressSupported=!1}initialize(e){var t;!0===(null===(t=null==e?void 0:e.window)||void 0===t?void 0:t.workDoneProgress)&&(this._progressSupported=!0,this.connection.onNotification(i.WorkDoneProgressCancelNotification.type,(e=>{let t=r.Instances.get(e.token);(t instanceof s||t instanceof c)&&t.cancel()})))}attachWorkDoneProgress(e){return void 0===e?new a:new r(this.connection,e)}createWorkDoneProgress(){if(this._progressSupported){const e=o.generateUuid();return this.connection.sendRequest(i.WorkDoneProgressCreateRequest.type,{token:e}).then((()=>new s(this.connection,e)))}return Promise.resolve(new c)}},function(e){e.type=new i.ProgressType}(l||(l={}));class d{constructor(e,t){this._connection=e,this._token=t}report(e){this._connection.sendProgress(l.type,this._token,e)}}t.attachPartialResult=function(e,t){if(void 0===t||void 0===t.partialResultToken)return;const n=t.partialResultToken;return delete t.partialResultToken,new d(e,n)}},7255:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticTokensBuilder=t.SemanticTokensFeature=void 0;const i=n(7745);t.SemanticTokensFeature=e=>class extends e{get semanticTokens(){return{on:e=>{const t=i.SemanticTokensRequest.type;this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))},onDelta:e=>{const t=i.SemanticTokensDeltaRequest.type;this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))},onRange:e=>{const t=i.SemanticTokensRangeRequest.type;this.connection.onRequest(t,((n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}},t.SemanticTokensBuilder=class{constructor(){this._prevData=void 0,this.initialize()}initialize(){this._id=Date.now(),this._prevLine=0,this._prevChar=0,this._data=[],this._dataLen=0}push(e,t,n,i,o){let r=e,s=t;this._dataLen>0&&(r-=this._prevLine,0===r&&(s-=this._prevChar)),this._data[this._dataLen++]=r,this._data[this._dataLen++]=s,this._data[this._dataLen++]=n,this._data[this._dataLen++]=i,this._data[this._dataLen++]=o,this._prevLine=e,this._prevChar=t}get id(){return this._id.toString()}previousResult(e){this.id===e&&(this._prevData=this._data),this.initialize()}build(){return this._prevData=void 0,{resultId:this.id,data:this._data}}canBuildEdits(){return void 0!==this._prevData}buildEdits(){if(void 0!==this._prevData){const e=this._prevData.length,t=this._data.length;let n=0;for(;n<t&&n<e&&this._prevData[n]===this._data[n];)n++;if(n<t&&n<e){let i=0;for(;i<t&&i<e&&this._prevData[e-1-i]===this._data[t-1-i];)i++;const o=this._data.slice(n,t-i);return{resultId:this.id,edits:[{start:n,deleteCount:e-i-n,data:o}]}}return n<t?{resultId:this.id,edits:[{start:n,deleteCount:0,data:this._data.slice(n)}]}:n<e?{resultId:this.id,edits:[{start:n,deleteCount:e-n}]}:{resultId:this.id,edits:[]}}return this.build()}}},6717:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createConnection=t.combineFeatures=t.combineLanguagesFeatures=t.combineWorkspaceFeatures=t.combineWindowFeatures=t.combineClientFeatures=t.combineTracerFeatures=t.combineTelemetryFeatures=t.combineConsoleFeatures=t._LanguagesImpl=t.BulkUnregistration=t.BulkRegistration=t.ErrorMessageTracker=t.TextDocuments=void 0;const i=n(7745),o=n(6960),r=n(7867),s=n(3787),a=n(3606),c=n(518),l=n(4225),d=n(7255),u=n(9283),f=n(7695),p=n(7129),h=n(8535);function m(e){if(null!==e)return e}t.TextDocuments=class{constructor(e){this._documents=Object.create(null),this._configuration=e,this._onDidChangeContent=new i.Emitter,this._onDidOpen=new i.Emitter,this._onDidClose=new i.Emitter,this._onDidSave=new i.Emitter,this._onWillSave=new i.Emitter}get onDidChangeContent(){return this._onDidChangeContent.event}get onDidOpen(){return this._onDidOpen.event}get onWillSave(){return this._onWillSave.event}onWillSaveWaitUntil(e){this._willSaveWaitUntil=e}get onDidSave(){return this._onDidSave.event}get onDidClose(){return this._onDidClose.event}get(e){return this._documents[e]}all(){return Object.keys(this._documents).map((e=>this._documents[e]))}keys(){return Object.keys(this._documents)}listen(e){e.__textDocumentSync=i.TextDocumentSyncKind.Full,e.onDidOpenTextDocument((e=>{let t=e.textDocument,n=this._configuration.create(t.uri,t.languageId,t.version,t.text);this._documents[t.uri]=n;let i=Object.freeze({document:n});this._onDidOpen.fire(i),this._onDidChangeContent.fire(i)})),e.onDidChangeTextDocument((e=>{let t=e.textDocument,n=e.contentChanges;if(0===n.length)return;let i=this._documents[t.uri];const{version:o}=t;if(null==o)throw new Error(`Received document change event for ${t.uri} without valid version identifier`);i=this._configuration.update(i,n,o),this._documents[t.uri]=i,this._onDidChangeContent.fire(Object.freeze({document:i}))})),e.onDidCloseTextDocument((e=>{let t=this._documents[e.textDocument.uri];t&&(delete this._documents[e.textDocument.uri],this._onDidClose.fire(Object.freeze({document:t})))})),e.onWillSaveTextDocument((e=>{let t=this._documents[e.textDocument.uri];t&&this._onWillSave.fire(Object.freeze({document:t,reason:e.reason}))})),e.onWillSaveTextDocumentWaitUntil(((e,t)=>{let n=this._documents[e.textDocument.uri];return n&&this._willSaveWaitUntil?this._willSaveWaitUntil(Object.freeze({document:n,reason:e.reason}),t):[]})),e.onDidSaveTextDocument((e=>{let t=this._documents[e.textDocument.uri];t&&this._onDidSave.fire(Object.freeze({document:t}))}))}},t.ErrorMessageTracker=class{constructor(){this._messages=Object.create(null)}add(e){let t=this._messages[e];t||(t=0),t++,this._messages[e]=t}sendErrors(e){Object.keys(this._messages).forEach((t=>{e.window.showErrorMessage(t)}))}};class g{constructor(){}rawAttach(e){this._rawConnection=e}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}fillServerCapabilities(e){}initialize(e){}error(e){this.send(i.MessageType.Error,e)}warn(e){this.send(i.MessageType.Warning,e)}info(e){this.send(i.MessageType.Info,e)}log(e){this.send(i.MessageType.Log,e)}send(e,t){this._rawConnection&&this._rawConnection.sendNotification(i.LogMessageNotification.type,{type:e,message:t})}}const y=u.ShowDocumentFeature(s.ProgressFeature(class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}showErrorMessage(e,...t){let n={type:i.MessageType.Error,message:e,actions:t};return this.connection.sendRequest(i.ShowMessageRequest.type,n).then(m)}showWarningMessage(e,...t){let n={type:i.MessageType.Warning,message:e,actions:t};return this.connection.sendRequest(i.ShowMessageRequest.type,n).then(m)}showInformationMessage(e,...t){let n={type:i.MessageType.Info,message:e,actions:t};return this.connection.sendRequest(i.ShowMessageRequest.type,n).then(m)}}));(t.BulkRegistration||(t.BulkRegistration={})).create=function(){return new v};class v{constructor(){this._registrations=[],this._registered=new Set}add(e,t){const n=o.string(e)?e:e.method;if(this._registered.has(n))throw new Error(`${n} is already added to this registration`);const i=r.generateUuid();this._registrations.push({id:i,method:n,registerOptions:t||{}}),this._registered.add(n)}asRegistrationParams(){return{registrations:this._registrations}}}(t.BulkUnregistration||(t.BulkUnregistration={})).create=function(){return new b(void 0,[])};class b{constructor(e,t){this._connection=e,this._unregistrations=new Map,t.forEach((e=>{this._unregistrations.set(e.method,e)}))}get isAttached(){return!!this._connection}attach(e){this._connection=e}add(e){this._unregistrations.set(e.method,e)}dispose(){let e=[];for(let t of this._unregistrations.values())e.push(t);let t={unregisterations:e};this._connection.sendRequest(i.UnregistrationRequest.type,t).then(void 0,(e=>{this._connection.console.info("Bulk unregistration failed.")}))}disposeSingle(e){const t=o.string(e)?e:e.method,n=this._unregistrations.get(t);if(!n)return!1;let r={unregisterations:[n]};return this._connection.sendRequest(i.UnregistrationRequest.type,r).then((()=>{this._unregistrations.delete(t)}),(e=>{this._connection.console.info(`Un-registering request handler for ${n.id} failed.`)})),!0}}class _{attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}register(e,t,n){return e instanceof v?this.registerMany(e):e instanceof b?this.registerSingle1(e,t,n):this.registerSingle2(e,t)}registerSingle1(e,t,n){const s=o.string(t)?t:t.method,a=r.generateUuid();let c={registrations:[{id:a,method:s,registerOptions:n||{}}]};return e.isAttached||e.attach(this.connection),this.connection.sendRequest(i.RegistrationRequest.type,c).then((t=>(e.add({id:a,method:s}),e)),(e=>(this.connection.console.info(`Registering request handler for ${s} failed.`),Promise.reject(e))))}registerSingle2(e,t){const n=o.string(e)?e:e.method,s=r.generateUuid();let a={registrations:[{id:s,method:n,registerOptions:t||{}}]};return this.connection.sendRequest(i.RegistrationRequest.type,a).then((e=>i.Disposable.create((()=>{this.unregisterSingle(s,n)}))),(e=>(this.connection.console.info(`Registering request handler for ${n} failed.`),Promise.reject(e))))}unregisterSingle(e,t){let n={unregisterations:[{id:e,method:t}]};return this.connection.sendRequest(i.UnregistrationRequest.type,n).then(void 0,(t=>{this.connection.console.info(`Un-registering request handler for ${e} failed.`)}))}registerMany(e){let t=e.asRegistrationParams();return this.connection.sendRequest(i.RegistrationRequest.type,t).then((()=>new b(this._connection,t.registrations.map((e=>({id:e.id,method:e.method}))))),(e=>(this.connection.console.info("Bulk registration failed."),Promise.reject(e))))}}const k=f.FileOperationsFeature(c.WorkspaceFoldersFeature(a.ConfigurationFeature(class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}applyEdit(e){let t=(n=e)&&n.edit?e:{edit:e};var n;return this.connection.sendRequest(i.ApplyWorkspaceEditRequest.type,t)}})));class T{constructor(){this._trace=i.Trace.Off}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}set trace(e){this._trace=e}log(e,t){this._trace!==i.Trace.Off&&this.connection.sendNotification(i.LogTraceNotification.type,{message:e,verbose:this._trace===i.Trace.Verbose?t:void 0})}}class R{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}logEvent(e){this.connection.sendNotification(i.TelemetryEventNotification.type,e)}}class w{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}attachWorkDoneProgress(e){return s.attachWorkDone(this.connection,e)}attachPartialResultProgress(e,t){return s.attachPartialResult(this.connection,t)}}t._LanguagesImpl=w;const S=h.MonikerFeature(p.LinkedEditingRangeFeature(d.SemanticTokensFeature(l.CallHierarchyFeature(w))));function C(e,t){return function(n){return t(e(n))}}function x(e,t){return function(n){return t(e(n))}}function E(e,t){return function(n){return t(e(n))}}function D(e,t){return function(n){return t(e(n))}}function O(e,t){return function(n){return t(e(n))}}function K(e,t){return function(n){return t(e(n))}}t.combineConsoleFeatures=C,t.combineTelemetryFeatures=x,t.combineTracerFeatures=E,t.combineClientFeatures=D,t.combineWindowFeatures=O,t.combineWorkspaceFeatures=K,t.combineLanguagesFeatures=function(e,t){return function(n){return t(e(n))}},t.combineFeatures=function(e,t){function n(e,t,n){return e&&t?n(e,t):e||t}return{__brand:"features",console:n(e.console,t.console,C),tracer:n(e.tracer,t.tracer,E),telemetry:n(e.telemetry,t.telemetry,x),client:n(e.client,t.client,D),window:n(e.window,t.window,O),workspace:n(e.workspace,t.workspace,K)}},t.createConnection=function(e,t,n){const r=n&&n.console?new(n.console(g)):new g,a=e(r);r.rawAttach(a);const c=n&&n.tracer?new(n.tracer(T)):new T,l=n&&n.telemetry?new(n.telemetry(R)):new R,d=n&&n.client?new(n.client(_)):new _,u=n&&n.window?new(n.window(y)):new y,f=n&&n.workspace?new(n.workspace(k)):new k,p=n&&n.languages?new(n.languages(S)):new S,h=[r,c,l,d,u,f,p];function m(e){return e instanceof Promise?e:o.thenable(e)?new Promise(((t,n)=>{e.then((e=>t(e)),(e=>n(e)))})):Promise.resolve(e)}let v,b,w,C={listen:()=>a.listen(),sendRequest:(e,...t)=>a.sendRequest(o.string(e)?e:e.method,...t),onRequest:(e,t)=>a.onRequest(e,t),sendNotification:(e,t)=>{const n=o.string(e)?e:e.method;1===arguments.length?a.sendNotification(n):a.sendNotification(n,t)},onNotification:(e,t)=>a.onNotification(e,t),onProgress:a.onProgress,sendProgress:a.sendProgress,onInitialize:e=>b=e,onInitialized:e=>a.onNotification(i.InitializedNotification.type,e),onShutdown:e=>v=e,onExit:e=>w=e,get console(){return r},get telemetry(){return l},get tracer(){return c},get client(){return d},get window(){return u},get workspace(){return f},get languages(){return p},onDidChangeConfiguration:e=>a.onNotification(i.DidChangeConfigurationNotification.type,e),onDidChangeWatchedFiles:e=>a.onNotification(i.DidChangeWatchedFilesNotification.type,e),__textDocumentSync:void 0,onDidOpenTextDocument:e=>a.onNotification(i.DidOpenTextDocumentNotification.type,e),onDidChangeTextDocument:e=>a.onNotification(i.DidChangeTextDocumentNotification.type,e),onDidCloseTextDocument:e=>a.onNotification(i.DidCloseTextDocumentNotification.type,e),onWillSaveTextDocument:e=>a.onNotification(i.WillSaveTextDocumentNotification.type,e),onWillSaveTextDocumentWaitUntil:e=>a.onRequest(i.WillSaveTextDocumentWaitUntilRequest.type,e),onDidSaveTextDocument:e=>a.onNotification(i.DidSaveTextDocumentNotification.type,e),sendDiagnostics:e=>a.sendNotification(i.PublishDiagnosticsNotification.type,e),onHover:e=>a.onRequest(i.HoverRequest.type,((t,n)=>e(t,n,s.attachWorkDone(a,t),void 0))),onCompletion:e=>a.onRequest(i.CompletionRequest.type,((t,n)=>e(t,n,s.attachWorkDone(a,t),s.attachPartialResult(a,t)))),onCompletionResolve:e=>a.onRequest(i.CompletionResolveRequest.type,e),onSignatureHelp:e=>a.onRequest(i.SignatureHelpRequest.type,((t,n)=>e(t,n,s.attachWorkDone(a,t),void 0))),onDeclaration:e=>a.onRequest(i.DeclarationRequest.type,((t,n)=>e(t,n,s.attachWorkDone(a,t),s.attachPartialResult(a,t)))),onDefinition:e=>a.onRequest(i.DefinitionRequest.type,((t,n)=>e(t,n,s.attachWorkDone(a,t),s.attachPartialResult(a,t)))),onTypeDefinition:e=>a.onRequest(i.TypeDefinitionRequest.type,((t,n)=>e(t,n,s.attachWorkDone(a,t),s.attachPartialResult(a,t)))),onImplementation:e=>a.onRequest(i.ImplementationRequest.type,((t,n)=>e(t,n,s.attachWorkDone(a,t),s.attachPartialResult(a,t)))),onReferences:e=>a.onRequest(i.ReferencesRequest.type,((t,n)=>e(t,n,s.attachWorkDone(a,t),s.attachPartialResult(a,t)))),onDocumentHighlight:e=>a.onRequest(i.DocumentHighlightRequest.type,((t,n)=>e(t,n,s.attachWorkDone(a,t),s.attachPartialResult(a,t)))),onDocumentSymbol:e=>a.onRequest(i.DocumentSymbolRequest.type,((t,n)=>e(t,n,s.attachWorkDone(a,t),s.attachPartialResult(a,t)))),onWorkspaceSymbol:e=>a.onRequest(i.WorkspaceSymbolRequest.type,((t,n)=>e(t,n,s.attachWorkDone(a,t),s.attachPartialResult(a,t)))),onCodeAction:e=>a.onRequest(i.CodeActionRequest.type,((t,n)=>e(t,n,s.attachWorkDone(a,t),s.attachPartialResult(a,t)))),onCodeActionResolve:e=>a.onRequest(i.CodeActionResolveRequest.type,((t,n)=>e(t,n))),onCodeLens:e=>a.onRequest(i.CodeLensRequest.type,((t,n)=>e(t,n,s.attachWorkDone(a,t),s.attachPartialResult(a,t)))),onCodeLensResolve:e=>a.onRequest(i.CodeLensResolveRequest.type,((t,n)=>e(t,n))),onDocumentFormatting:e=>a.onRequest(i.DocumentFormattingRequest.type,((t,n)=>e(t,n,s.attachWorkDone(a,t),void 0))),onDocumentRangeFormatting:e=>a.onRequest(i.DocumentRangeFormattingRequest.type,((t,n)=>e(t,n,s.attachWorkDone(a,t),void 0))),onDocumentOnTypeFormatting:e=>a.onRequest(i.DocumentOnTypeFormattingRequest.type,((t,n)=>e(t,n))),onRenameRequest:e=>a.onRequest(i.RenameRequest.type,((t,n)=>e(t,n,s.attachWorkDone(a,t),void 0))),onPrepareRename:e=>a.onRequest(i.PrepareRenameRequest.type,((t,n)=>e(t,n))),onDocumentLinks:e=>a.onRequest(i.DocumentLinkRequest.type,((t,n)=>e(t,n,s.attachWorkDone(a,t),s.attachPartialResult(a,t)))),onDocumentLinkResolve:e=>a.onRequest(i.DocumentLinkResolveRequest.type,((t,n)=>e(t,n))),onDocumentColor:e=>a.onRequest(i.DocumentColorRequest.type,((t,n)=>e(t,n,s.attachWorkDone(a,t),s.attachPartialResult(a,t)))),onColorPresentation:e=>a.onRequest(i.ColorPresentationRequest.type,((t,n)=>e(t,n,s.attachWorkDone(a,t),s.attachPartialResult(a,t)))),onFoldingRanges:e=>a.onRequest(i.FoldingRangeRequest.type,((t,n)=>e(t,n,s.attachWorkDone(a,t),s.attachPartialResult(a,t)))),onSelectionRanges:e=>a.onRequest(i.SelectionRangeRequest.type,((t,n)=>e(t,n,s.attachWorkDone(a,t),s.attachPartialResult(a,t)))),onExecuteCommand:e=>a.onRequest(i.ExecuteCommandRequest.type,((t,n)=>e(t,n,s.attachWorkDone(a,t),void 0))),dispose:()=>a.dispose()};for(let e of h)e.attach(C);return a.onRequest(i.InitializeRequest.type,(e=>{t.initialize(e),o.string(e.trace)&&(c.trace=i.Trace.fromString(e.trace));for(let t of h)t.initialize(e.capabilities);if(b)return m(b(e,(new i.CancellationTokenSource).token,s.attachWorkDone(a,e),void 0)).then((e=>{if(e instanceof i.ResponseError)return e;let t=e;t||(t={capabilities:{}});let n=t.capabilities;n||(n={},t.capabilities=n),void 0===n.textDocumentSync||null===n.textDocumentSync?n.textDocumentSync=o.number(C.__textDocumentSync)?C.__textDocumentSync:i.TextDocumentSyncKind.None:o.number(n.textDocumentSync)||o.number(n.textDocumentSync.change)||(n.textDocumentSync.change=o.number(C.__textDocumentSync)?C.__textDocumentSync:i.TextDocumentSyncKind.None);for(let e of h)e.fillServerCapabilities(n);return t}));{let e={capabilities:{textDocumentSync:i.TextDocumentSyncKind.None}};for(let t of h)t.fillServerCapabilities(e.capabilities);return e}})),a.onRequest(i.ShutdownRequest.type,(()=>(t.shutdownReceived=!0,v?v((new i.CancellationTokenSource).token):void 0))),a.onNotification(i.ExitNotification.type,(()=>{try{w&&w()}finally{t.shutdownReceived?t.exit(0):t.exit(1)}})),a.onNotification(i.SetTraceNotification.type,(e=>{c.trace=i.Trace.fromString(e.value)})),C}},9283:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ShowDocumentFeature=void 0;const i=n(7745);t.ShowDocumentFeature=e=>class extends e{showDocument(e){return this.connection.sendRequest(i.ShowDocumentRequest.type,e)}}},6960:(e,t)=>{function n(e){return"string"==typeof e||e instanceof String}function i(e){return"function"==typeof e}function o(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.thenable=t.typedArray=t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=n,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=i,t.array=o,t.stringArray=function(e){return o(e)&&e.every((e=>n(e)))},t.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},t.thenable=function(e){return e&&i(e.then)}},7867:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateUuid=t.parse=t.isUUID=t.v4=t.empty=void 0;class n{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}}class i extends n{constructor(){super([i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),"-",i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),"-","4",i._randomHex(),i._randomHex(),i._randomHex(),"-",i._oneOf(i._timeHighBits),i._randomHex(),i._randomHex(),i._randomHex(),"-",i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex(),i._randomHex()].join(""))}static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return i._oneOf(i._chars)}}function o(){return new i}i._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"],i._timeHighBits=["8","9","a","b"],t.empty=new n("00000000-0000-0000-0000-000000000000"),t.v4=o;const r=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function s(e){return r.test(e)}t.isUUID=s,t.parse=function(e){if(!s(e))throw new Error("invalid uuid");return new n(e)},t.generateUuid=function(){return o().asHex()}},518:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceFoldersFeature=void 0;const i=n(7745);t.WorkspaceFoldersFeature=e=>class extends e{initialize(e){let t=e.workspace;t&&t.workspaceFolders&&(this._onDidChangeWorkspaceFolders=new i.Emitter,this.connection.onNotification(i.DidChangeWorkspaceFoldersNotification.type,(e=>{this._onDidChangeWorkspaceFolders.fire(e.event)})))}getWorkspaceFolders(){return this.connection.sendRequest(i.WorkspaceFoldersRequest.type)}get onDidChangeWorkspaceFolders(){if(!this._onDidChangeWorkspaceFolders)throw new Error("Client doesn't support sending workspace folder change events.");return this._unregistration||(this._unregistration=this.connection.client.register(i.DidChangeWorkspaceFoldersNotification.type)),this._onDidChangeWorkspaceFolders.event}}},1507:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resolveModulePath=t.FileSystem=t.resolveGlobalYarnPath=t.resolveGlobalNodePath=t.resolve=t.uriToFilePath=void 0;const i=n(7310),o=n(1017),r=n(7147),s=n(2081);function a(){return"win32"===process.platform}function c(e,t,n,i){const a=["var p = process;","p.on('message',function(m){","if(m.c==='e'){","p.exit(0);","}","else if(m.c==='rs'){","try{","var r=require.resolve(m.a);","p.send({c:'r',s:true,r:r});","}","catch(err){","p.send({c:'r',s:false});","}","}","});"].join("");return new Promise(((c,l)=>{let d=process.env,u=Object.create(null);Object.keys(d).forEach((e=>u[e]=d[e])),t&&r.existsSync(t)&&(u.NODE_PATH?u.NODE_PATH=t+o.delimiter+u.NODE_PATH:u.NODE_PATH=t,i&&i(`NODE_PATH value is: ${u.NODE_PATH}`)),u.ELECTRON_RUN_AS_NODE="1";try{let t=s.fork("",[],{cwd:n,env:u,execArgv:["-e",a]});if(void 0===t.pid)return void l(new Error(`Starting process to resolve node module  ${e} failed`));t.on("error",(e=>{l(e)})),t.on("message",(n=>{"r"===n.c&&(t.send({c:"e"}),n.s?c(n.r):l(new Error(`Failed to resolve module: ${e}`)))}));let i={c:"rs",a:e};t.send(i)}catch(e){l(e)}}))}function l(e){let t="npm";const n=Object.create(null);Object.keys(process.env).forEach((e=>n[e]=process.env[e])),n.NO_UPDATE_NOTIFIER="true";const i={encoding:"utf8",env:n};a()&&(t="npm.cmd",i.shell=!0);let r=()=>{};try{process.on("SIGPIPE",r);let n=s.spawnSync(t,["config","get","prefix"],i).stdout;if(!n)return void(e&&e("'npm config get prefix' didn't return a value."));let c=n.trim();return e&&e(`'npm config get prefix' value is: ${c}`),c.length>0?a()?o.join(c,"node_modules"):o.join(c,"lib","node_modules"):void 0}catch(e){return}finally{process.removeListener("SIGPIPE",r)}}var d;t.uriToFilePath=function(e){let t=i.parse(e);if("file:"!==t.protocol||!t.path)return;let n=t.path.split("/");for(var r=0,s=n.length;r<s;r++)n[r]=decodeURIComponent(n[r]);if("win32"===process.platform&&n.length>1){let e=n[0],t=n[1];0===e.length&&t.length>1&&":"===t[1]&&n.shift()}return o.normalize(n.join("/"))},t.resolve=c,t.resolveGlobalNodePath=l,t.resolveGlobalYarnPath=function(e){let t="yarn",n={encoding:"utf8"};a()&&(t="yarn.cmd",n.shell=!0);let i=()=>{};try{process.on("SIGPIPE",i);let r=s.spawnSync(t,["global","dir","--json"],n),a=r.stdout;if(!a)return void(e&&(e("'yarn global dir' didn't return a value."),r.stderr&&e(r.stderr)));let c=a.trim().split(/\r?\n/);for(let e of c)try{let t=JSON.parse(e);if("log"===t.type)return o.join(t.data,"node_modules")}catch(e){}return}catch(e){return}finally{process.removeListener("SIGPIPE",i)}},function(e){let t;function n(){return void 0!==t||(t=!("win32"===process.platform||r.existsSync(__filename.toUpperCase())&&r.existsSync(__filename.toLowerCase()))),t}e.isCaseSensitive=n,e.isParent=function(e,t){return n()?0===o.normalize(t).indexOf(o.normalize(e)):0===o.normalize(t).toLowerCase().indexOf(o.normalize(e).toLowerCase())}}(d=t.FileSystem||(t.FileSystem={})),t.resolveModulePath=function(e,t,n,i){return n?(o.isAbsolute(n)||(n=o.join(e,n)),c(t,n,n,i).then((e=>d.isParent(n,e)?e:Promise.reject(new Error(`Failed to load ${t} from node path location.`)))).then(void 0,(n=>c(t,l(i),e,i)))):c(t,l(i),e,i)}},2374:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.createConnection=t.Files=void 0;const r=n(6960),s=n(6717),a=n(1507),c=n(4057);var l;o(n(4057),t),o(n(9936),t),(l=t.Files||(t.Files={})).uriToFilePath=a.uriToFilePath,l.resolveGlobalNodePath=a.resolveGlobalNodePath,l.resolveGlobalYarnPath=a.resolveGlobalYarnPath,l.resolve=a.resolve,l.resolveModulePath=a.resolveModulePath;let d,u=!1;!function(){const e="--clientProcessId";function t(e){try{let t=parseInt(e);isNaN(t)||(d=setInterval((()=>{try{process.kill(t,0)}catch(e){process.exit(u?0:1)}}),3e3))}catch(e){}}for(let n=2;n<process.argv.length;n++){let i=process.argv[n];if(i===e&&n+1<process.argv.length)return void t(process.argv[n+1]);{let n=i.split("=");n[0]===e&&t(n[1])}}}();const f={initialize:e=>{const t=e.processId;r.number(t)&&void 0===d&&setInterval((()=>{try{process.kill(t,0)}catch(e){process.exit(u?0:1)}}),3e3)},get shutdownReceived(){return u},set shutdownReceived(e){u=e},exit:e=>{process.exit(e)}};t.createConnection=function(e,t,n,i){let o,a,l,d;return void 0!==e&&"features"===e.__brand&&(o=e,e=t,t=n,n=i),c.ConnectionStrategy.is(e)||c.ConnectionOptions.is(e)?d=e:(a=e,l=t,d=n),function(e,t,n,i){if(!e&&!t&&process.argv.length>2){let n,i,r=process.argv.slice(2);for(let s=0;s<r.length;s++){let a=r[s];if("--node-ipc"===a){e=new c.IPCMessageReader(process),t=new c.IPCMessageWriter(process);break}if("--stdio"===a){e=process.stdin,t=process.stdout;break}if("--socket"===a){n=parseInt(r[s+1]);break}if("--pipe"===a){i=r[s+1];break}var o=a.split("=");if("--socket"===o[0]){n=parseInt(o[1]);break}if("--pipe"===o[0]){i=o[1];break}}if(n){let i=c.createServerSocketTransport(n);e=i[0],t=i[1]}else if(i){let n=c.createServerPipeTransport(i);e=n[0],t=n[1]}}var a="Use arguments of createConnection or set command line parameters: '--node-ipc', '--stdio' or '--socket={number}'";if(!e)throw new Error("Connection input stream is not set. "+a);if(!t)throw new Error("Connection output stream is not set. "+a);if(r.func(e.read)&&r.func(e.on)){let t=e;t.on("end",(()=>{process.exit(u?0:1)})),t.on("close",(()=>{process.exit(u?0:1)}))}return s.createConnection((i=>c.createProtocolConnection(e,t,i,n)),f,i)}(a,l,d,o)}},433:(e,t,n)=>{e.exports=n(2374)},6630:(e,t,n)=>{var i;n.r(t),n.d(t,{URI:()=>o,Utils:()=>r}),i=(()=>{var e={470:e=>{function t(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function n(e,t){for(var n,i="",o=0,r=-1,s=0,a=0;a<=e.length;++a){if(a<e.length)n=e.charCodeAt(a);else{if(47===n)break;n=47}if(47===n){if(r===a-1||1===s);else if(r!==a-1&&2===s){if(i.length<2||2!==o||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2))if(i.length>2){var c=i.lastIndexOf("/");if(c!==i.length-1){-1===c?(i="",o=0):o=(i=i.slice(0,c)).length-1-i.lastIndexOf("/"),r=a,s=0;continue}}else if(2===i.length||1===i.length){i="",o=0,r=a,s=0;continue}t&&(i.length>0?i+="/..":i="..",o=2)}else i.length>0?i+="/"+e.slice(r+1,a):i=e.slice(r+1,a),o=a-r-1;r=a,s=0}else 46===n&&-1!==s?++s:s=-1}return i}var i={resolve:function(){for(var e,i="",o=!1,r=arguments.length-1;r>=-1&&!o;r--){var s;r>=0?s=arguments[r]:(void 0===e&&(e=process.cwd()),s=e),t(s),0!==s.length&&(i=s+"/"+i,o=47===s.charCodeAt(0))}return i=n(i,!o),o?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(e){if(t(e),0===e.length)return".";var i=47===e.charCodeAt(0),o=47===e.charCodeAt(e.length-1);return 0!==(e=n(e,!i)).length||i||(e="."),e.length>0&&o&&(e+="/"),i?"/"+e:e},isAbsolute:function(e){return t(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,n=0;n<arguments.length;++n){var o=arguments[n];t(o),o.length>0&&(void 0===e?e=o:e+="/"+o)}return void 0===e?".":i.normalize(e)},relative:function(e,n){if(t(e),t(n),e===n)return"";if((e=i.resolve(e))===(n=i.resolve(n)))return"";for(var o=1;o<e.length&&47===e.charCodeAt(o);++o);for(var r=e.length,s=r-o,a=1;a<n.length&&47===n.charCodeAt(a);++a);for(var c=n.length-a,l=s<c?s:c,d=-1,u=0;u<=l;++u){if(u===l){if(c>l){if(47===n.charCodeAt(a+u))return n.slice(a+u+1);if(0===u)return n.slice(a+u)}else s>l&&(47===e.charCodeAt(o+u)?d=u:0===u&&(d=0));break}var f=e.charCodeAt(o+u);if(f!==n.charCodeAt(a+u))break;47===f&&(d=u)}var p="";for(u=o+d+1;u<=r;++u)u!==r&&47!==e.charCodeAt(u)||(0===p.length?p+="..":p+="/..");return p.length>0?p+n.slice(a+d):(a+=d,47===n.charCodeAt(a)&&++a,n.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(t(e),0===e.length)return".";for(var n=e.charCodeAt(0),i=47===n,o=-1,r=!0,s=e.length-1;s>=1;--s)if(47===(n=e.charCodeAt(s))){if(!r){o=s;break}}else r=!1;return-1===o?i?"/":".":i&&1===o?"//":e.slice(0,o)},basename:function(e,n){if(void 0!==n&&"string"!=typeof n)throw new TypeError('"ext" argument must be a string');t(e);var i,o=0,r=-1,s=!0;if(void 0!==n&&n.length>0&&n.length<=e.length){if(n.length===e.length&&n===e)return"";var a=n.length-1,c=-1;for(i=e.length-1;i>=0;--i){var l=e.charCodeAt(i);if(47===l){if(!s){o=i+1;break}}else-1===c&&(s=!1,c=i+1),a>=0&&(l===n.charCodeAt(a)?-1==--a&&(r=i):(a=-1,r=c))}return o===r?r=c:-1===r&&(r=e.length),e.slice(o,r)}for(i=e.length-1;i>=0;--i)if(47===e.charCodeAt(i)){if(!s){o=i+1;break}}else-1===r&&(s=!1,r=i+1);return-1===r?"":e.slice(o,r)},extname:function(e){t(e);for(var n=-1,i=0,o=-1,r=!0,s=0,a=e.length-1;a>=0;--a){var c=e.charCodeAt(a);if(47!==c)-1===o&&(r=!1,o=a+1),46===c?-1===n?n=a:1!==s&&(s=1):-1!==n&&(s=-1);else if(!r){i=a+1;break}}return-1===n||-1===o||0===s||1===s&&n===o-1&&n===i+1?"":e.slice(n,o)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var n=t.dir||t.root,i=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+i:n+"/"+i:i}(0,e)},parse:function(e){t(e);var n={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return n;var i,o=e.charCodeAt(0),r=47===o;r?(n.root="/",i=1):i=0;for(var s=-1,a=0,c=-1,l=!0,d=e.length-1,u=0;d>=i;--d)if(47!==(o=e.charCodeAt(d)))-1===c&&(l=!1,c=d+1),46===o?-1===s?s=d:1!==u&&(u=1):-1!==s&&(u=-1);else if(!l){a=d+1;break}return-1===s||-1===c||0===u||1===u&&s===c-1&&s===a+1?-1!==c&&(n.base=n.name=0===a&&r?e.slice(1,c):e.slice(a,c)):(0===a&&r?(n.name=e.slice(1,s),n.base=e.slice(1,c)):(n.name=e.slice(a,s),n.base=e.slice(a,c)),n.ext=e.slice(s,c)),a>0?n.dir=e.slice(0,a-1):r&&(n.dir="/"),n},sep:"/",delimiter:":",win32:null,posix:null};i.posix=i,e.exports=i},447:(e,t,n)=>{var i;if(n.r(t),n.d(t,{URI:()=>h,Utils:()=>S}),"object"==typeof process)i="win32"===process.platform;else if("object"==typeof navigator){var o=navigator.userAgent;i=o.indexOf("Windows")>=0}var r,s,a=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),c=/^\w[\w\d+.-]*$/,l=/^\//,d=/^\/\//,u="",f="/",p=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,h=function(){function e(e,t,n,i,o,r){void 0===r&&(r=!1),"object"==typeof e?(this.scheme=e.scheme||u,this.authority=e.authority||u,this.path=e.path||u,this.query=e.query||u,this.fragment=e.fragment||u):(this.scheme=function(e,t){return e||t?e:"file"}(e,r),this.authority=t||u,this.path=function(e,t){switch(e){case"https":case"http":case"file":t?t[0]!==f&&(t=f+t):t=f}return t}(this.scheme,n||u),this.query=i||u,this.fragment=o||u,function(e,t){if(!e.scheme&&t)throw new Error('[UriError]: Scheme is missing: {scheme: "", authority: "'+e.authority+'", path: "'+e.path+'", query: "'+e.query+'", fragment: "'+e.fragment+'"}');if(e.scheme&&!c.test(e.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(e.path)if(e.authority){if(!l.test(e.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(d.test(e.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}(this,r))}return e.isUri=function(t){return t instanceof e||!!t&&"string"==typeof t.authority&&"string"==typeof t.fragment&&"string"==typeof t.path&&"string"==typeof t.query&&"string"==typeof t.scheme&&"function"==typeof t.fsPath&&"function"==typeof t.with&&"function"==typeof t.toString},Object.defineProperty(e.prototype,"fsPath",{get:function(){return _(this,!1)},enumerable:!1,configurable:!0}),e.prototype.with=function(e){if(!e)return this;var t=e.scheme,n=e.authority,i=e.path,o=e.query,r=e.fragment;return void 0===t?t=this.scheme:null===t&&(t=u),void 0===n?n=this.authority:null===n&&(n=u),void 0===i?i=this.path:null===i&&(i=u),void 0===o?o=this.query:null===o&&(o=u),void 0===r?r=this.fragment:null===r&&(r=u),t===this.scheme&&n===this.authority&&i===this.path&&o===this.query&&r===this.fragment?this:new g(t,n,i,o,r)},e.parse=function(e,t){void 0===t&&(t=!1);var n=p.exec(e);return n?new g(n[2]||u,w(n[4]||u),w(n[5]||u),w(n[7]||u),w(n[9]||u),t):new g(u,u,u,u,u)},e.file=function(e){var t=u;if(i&&(e=e.replace(/\\/g,f)),e[0]===f&&e[1]===f){var n=e.indexOf(f,2);-1===n?(t=e.substring(2),e=f):(t=e.substring(2,n),e=e.substring(n)||f)}return new g("file",t,e,u,u)},e.from=function(e){return new g(e.scheme,e.authority,e.path,e.query,e.fragment)},e.prototype.toString=function(e){return void 0===e&&(e=!1),k(this,e)},e.prototype.toJSON=function(){return this},e.revive=function(t){if(t){if(t instanceof e)return t;var n=new g(t);return n._formatted=t.external,n._fsPath=t._sep===m?t.fsPath:null,n}return t},e}(),m=i?1:void 0,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._formatted=null,t._fsPath=null,t}return a(t,e),Object.defineProperty(t.prototype,"fsPath",{get:function(){return this._fsPath||(this._fsPath=_(this,!1)),this._fsPath},enumerable:!1,configurable:!0}),t.prototype.toString=function(e){return void 0===e&&(e=!1),e?k(this,!0):(this._formatted||(this._formatted=k(this,!1)),this._formatted)},t.prototype.toJSON=function(){var e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=m),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e},t}(h),y=((s={})[58]="%3A",s[47]="%2F",s[63]="%3F",s[35]="%23",s[91]="%5B",s[93]="%5D",s[64]="%40",s[33]="%21",s[36]="%24",s[38]="%26",s[39]="%27",s[40]="%28",s[41]="%29",s[42]="%2A",s[43]="%2B",s[44]="%2C",s[59]="%3B",s[61]="%3D",s[32]="%20",s);function v(e,t){for(var n=void 0,i=-1,o=0;o<e.length;o++){var r=e.charCodeAt(o);if(r>=97&&r<=122||r>=65&&r<=90||r>=48&&r<=57||45===r||46===r||95===r||126===r||t&&47===r)-1!==i&&(n+=encodeURIComponent(e.substring(i,o)),i=-1),void 0!==n&&(n+=e.charAt(o));else{void 0===n&&(n=e.substr(0,o));var s=y[r];void 0!==s?(-1!==i&&(n+=encodeURIComponent(e.substring(i,o)),i=-1),n+=s):-1===i&&(i=o)}}return-1!==i&&(n+=encodeURIComponent(e.substring(i))),void 0!==n?n:e}function b(e){for(var t=void 0,n=0;n<e.length;n++){var i=e.charCodeAt(n);35===i||63===i?(void 0===t&&(t=e.substr(0,n)),t+=y[i]):void 0!==t&&(t+=e[n])}return void 0!==t?t:e}function _(e,t){var n;return n=e.authority&&e.path.length>1&&"file"===e.scheme?"//"+e.authority+e.path:47===e.path.charCodeAt(0)&&(e.path.charCodeAt(1)>=65&&e.path.charCodeAt(1)<=90||e.path.charCodeAt(1)>=97&&e.path.charCodeAt(1)<=122)&&58===e.path.charCodeAt(2)?t?e.path.substr(1):e.path[1].toLowerCase()+e.path.substr(2):e.path,i&&(n=n.replace(/\//g,"\\")),n}function k(e,t){var n=t?b:v,i="",o=e.scheme,r=e.authority,s=e.path,a=e.query,c=e.fragment;if(o&&(i+=o,i+=":"),(r||"file"===o)&&(i+=f,i+=f),r){var l=r.indexOf("@");if(-1!==l){var d=r.substr(0,l);r=r.substr(l+1),-1===(l=d.indexOf(":"))?i+=n(d,!1):(i+=n(d.substr(0,l),!1),i+=":",i+=n(d.substr(l+1),!1)),i+="@"}-1===(l=(r=r.toLowerCase()).indexOf(":"))?i+=n(r,!1):(i+=n(r.substr(0,l),!1),i+=r.substr(l))}if(s){if(s.length>=3&&47===s.charCodeAt(0)&&58===s.charCodeAt(2))(u=s.charCodeAt(1))>=65&&u<=90&&(s="/"+String.fromCharCode(u+32)+":"+s.substr(3));else if(s.length>=2&&58===s.charCodeAt(1)){var u;(u=s.charCodeAt(0))>=65&&u<=90&&(s=String.fromCharCode(u+32)+":"+s.substr(2))}i+=n(s,!0)}return a&&(i+="?",i+=n(a,!1)),c&&(i+="#",i+=t?c:v(c,!1)),i}function T(e){try{return decodeURIComponent(e)}catch(t){return e.length>3?e.substr(0,3)+T(e.substr(3)):e}}var R=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function w(e){return e.match(R)?e.replace(R,(function(e){return T(e)})):e}var S,C=n(470),x=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),o=0;for(t=0;t<n;t++)for(var r=arguments[t],s=0,a=r.length;s<a;s++,o++)i[o]=r[s];return i},E=C.posix||C;!function(e){e.joinPath=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.with({path:E.join.apply(E,x([e.path],t))})},e.resolvePath=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=e.path||"/";return e.with({path:E.resolve.apply(E,x([i],t))})},e.dirname=function(e){var t=E.dirname(e.path);return 1===t.length&&46===t.charCodeAt(0)?e:e.with({path:t})},e.basename=function(e){return E.basename(e.path)},e.extname=function(e){return E.extname(e.path)}}(S||(S={}))}},t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={exports:{}};return e[i](o,o.exports,n),o.exports}return n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(447)})();const{URI:o,Utils:r}=i},2081:e=>{e.exports=require("child_process")},6113:e=>{e.exports=require("crypto")},7147:e=>{e.exports=require("fs")},1808:e=>{e.exports=require("net")},2037:e=>{e.exports=require("os")},1017:e=>{e.exports=require("path")},7282:e=>{e.exports=require("process")},7310:e=>{e.exports=require("url")},3837:e=>{e.exports=require("util")}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,n),r.exports}n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};(()=>{var e=i;Object.defineProperty(e,"__esModule",{value:!0});const t=n(7147),o=n(6630),r=n(1017),s=n(6288),a=n(433),c=n(3939),l=n(701);let d,u,f=new a.TextDocuments(s.TextDocument),p=!1,h=!1,m=!1,g=!1,y=0;async function v(e){let t,n=e.uri;(t=c.lexers[n=n.toLowerCase()])&&(t.initlibdirs(),t.diagnostics.length&&t.parseScript(),c.libfuncs[n]&&(c.libfuncs[n].length=0,c.libfuncs[n].push(...Object.values(t.declaration).filter((e=>e.kind===a.SymbolKind.Class||e.kind===a.SymbolKind.Function))))),1&c.extsettings.AutoLibInclude&&R(n)}function b(e=!1){let n=0,i=(0,c.runscript)('\n\t#NoTrayIcon\n\t#Warn All, Off\n\ts := "", _H := false, Append := SubStr(A_AhkVersion, 1, 3) = "2.0" ? "FileAppend" : "FileAppend2"\n\tfor _, p in [A_MyDocuments,A_Desktop,A_AhkPath,A_ProgramFiles,A_Programs,A_AhkVersion]\n\t\ts .= p "|"\n\ttry _H := !!A_ThreadID\n\t%Append%(s _H "`n", "*", "UTF-8")\n\tFileAppend2(text, file) {\n\t\tencode := "UTF-8"\n\t\tFileAppend %text%, %file%, %encode%\n\t}',(i=>{var o,r;if(!(i=i.trim())){let i=c.ahkpath_cur||c.extsettings.InterpreterPath;if(w([i])[0].endsWith("[UIAccess]")){let o=!1,r=i.replace(/_uia\.exe$/i,".exe");if(n=2,i!==r&&(0,t.existsSync)(r)&&!w([r])[0].endsWith("[UIAccess]")&&((0,c.set_ahkpath)(r),(o=b(e))&&(n=0),(0,c.set_ahkpath)(i)),d.window.showWarningMessage(c.setting.uialimit()),o)return}else n=1;return void(c.pathenv.mydocuments||d.window.showErrorMessage(c.setting.getenverr()))}let s=i.split("|"),a=["mydocuments","desktop","ahkpath","programfiles","programs","version","h"],l="";for(let e in s)c.pathenv[a[e]]=s[e].toLowerCase();if(y=1,(null===(o=c.pathenv.version)||void 0===o?void 0:o.match(/^1\./))&&d.window.showErrorMessage(c.setting.versionerr()),e||(c.libdirs.length=0,(0,t.existsSync)(l=c.pathenv.mydocuments+"\\autohotkey\\lib")&&c.libdirs.push(l.toLowerCase()),(0,t.existsSync)(l=(c.ahkpath_cur||c.pathenv.ahkpath).replace(/[^\\/]+$/,"lib"))&&c.libdirs.push(l.toLowerCase())),c.pathenv.h=(null!==(r=c.pathenv.h)&&void 0!==r?r:"0").slice(0,1),"1"===c.pathenv.h?(c.isahk2_h||((0,c.set_ahk_h)(!0),e=!1),p||(p=!0,(0,c.loadahk2)("ahk2_h"))):(c.isahk2_h&&((0,c.set_ahk_h)(!1),e=!1),p&&(p=!1,(0,c.initahk2cache)(),(0,c.loadahk2)())),!e){for(const e in c.lexers){let t=c.lexers[e];t.d||(t.initlibdirs(),(Object.keys(t.include).length||t.diagnostics.length)&&(t.parseScript(),(0,c.parseinclude)(t.include,t.scriptdir),t.relevance=(0,c.getincludetable)(t.uri).list))}(0,c.sendDiagnostics)(),(0,c.clearLibfuns)(),c.extsettings.AutoLibInclude>1&&_()}}));if(i){if(!c.pathenv.ahkpath&&2!==n)return y<3&&setTimeout((()=>{y++,b()}),1e3),!1}else d.window.showErrorMessage(c.setting.ahkpatherr());return i&&!n}async function _(){for(let e of c.libdirs)for(let t of(0,c.getallahkfiles)(e)){let e,n,i=o.URI.file(t).toString().toLowerCase();if(!c.libfuncs[i]){if(!(e=c.lexers[i])){if(!(n=(0,c.openFile)(t)))continue;e=new c.Lexer(n),e.parseScript()}c.libfuncs[i]=Object.values(e.declaration).filter((e=>e.kind===a.SymbolKind.Class||e.kind===a.SymbolKind.Function)),Object.defineProperty(c.libfuncs[i],"islib",{value:k(t,...c.libdirs),enumerable:!1}),await(0,c.sleep)(50)}}}function k(e,...t){let n=(0,r.basename)(e),i=0,o=n.endsWith(".ahk");for(const r of t){if(e.startsWith(r+"\\")){if(o)for(let e=i-1;e>=0;e--)if(c.libfuncs[t[e]+"\\"+n])return!1;return!0}i++}return!1}async function T(e,t){let n=(0,r.resolve)(e,"..").toLowerCase()===(0,r.resolve)(t,"..").toLowerCase();if(!n){let t=o.URI.file((0,r.resolve)(e,"../lib")).toString().toLowerCase();for(const e in c.libfuncs)e.startsWith(t)&&delete c.libfuncs[e]}b(n)&&f.all().forEach(v)}async function R(e){let t=c.lexers[e];c.libfuncs[e]||(c.libfuncs[e]=[],Object.defineProperty(c.libfuncs[e],"islib",{value:k(o.URI.parse(e).toString(),...c.libdirs),enumerable:!1})),setTimeout((async()=>{let n="",i=!1;(n=(0,c.inWorkspaceFolders)(t.document.uri))?(n=o.URI.parse(n).fsPath,i=!0):n=t.scriptdir+"\\lib";for(let t of(0,c.getallahkfiles)(n)){let n,r,s=o.URI.file(t).toString().toLowerCase();if(s!==e&&!c.libfuncs[s]){if(c.libfuncs[s]=[],Object.defineProperty(c.libfuncs[s],"islib",{value:k(t,...c.libdirs),enumerable:!1}),!(n=c.lexers[s])){if(!(r=(0,c.openFile)(t)))continue;n=new c.Lexer(r),n.parseScript(),i&&(c.lexers[s]=n)}c.libfuncs[s].push(...Object.values(n.declaration).filter((e=>e.kind===a.SymbolKind.Class||e.kind===a.SymbolKind.Function))),await(0,c.sleep)(50)}}}),500)}function w(e){return e.map((e=>{var t,n,i,o;try{let r=new l.PEFile(e),s=r.getResource(l.RESOURCE_TYPE.VERSION)[0].StringTable[0];if(null===(t=s.ProductName)||void 0===t?void 0:t.toLowerCase().startsWith("autohotkey")){let e=null!==(i=null===(n=r.getResource(l.RESOURCE_TYPE.MANIFEST)[0])||void 0===n?void 0:n.replace(/<!--[\s\S]*?-->/g,""))&&void 0!==i?i:"",t=`${s.ProductName} ${null!==(o=s.ProductVersion)&&void 0!==o?o:"unknown version"} ${r.isBit64?"64":"32"} bit`;return e.includes('uiAccess="true"')&&(t+=" [UIAccess]"),t}}catch(e){}return""}))}function S(e,t=!1){var n;let i={};for(let o of e){let e=(0,l.searchAndOpenPEFile)(o);if(e&&(null===(n=e.getExport())||void 0===n||n.Functions.map((e=>i[e.Name]=!0)),t))break}return delete i[""],Object.keys(i)}d=(0,a.createConnection)(a.ProposedFeatures.all),(0,c.set_Connection)(d,!1,S,(function(e){let n=c.ahkpath_cur||c.extsettings.InterpreterPath,i=`${n}:${e}`,r=o.URI.from({scheme:"ahkres",path:i}).toString().toLowerCase();if(c.lexers[r])return{uri:r,path:i};if(!(0,t.existsSync)(n))return;n=n.toLowerCase();let a=(null==u?void 0:u.exe)===n?u.data:(u={exe:n,data:new l.PEFile(n).getResource(l.RESOURCE_TYPE.RCDATA)}).data;if(!e||!a)return a;let d=a[e];if(d)try{return(c.lexers[r]=new c.Lexer(s.TextDocument.create(r,"ahk2",-10,new TextDecoder("utf8",{fatal:!0}).decode(d)))).parseScript(),{uri:r,path:i}}catch{delete a[e]}})),(0,c.set_dirname)(__dirname),(0,c.set_locale)(JSON.parse(process.env.VSCODE_NLS_CONFIG||process.env.AHK2_LS_CONFIG||"{}").locale),d.onInitialize((e=>{var n;let i=e.capabilities;(0,c.set_Workfolder)(null===(n=e.workspaceFolders)||void 0===n?void 0:n.map((e=>e.uri.toLowerCase()+"/"))),h=!(!i.workspace||!i.workspace.configuration),m=!(!i.workspace||!i.workspace.workspaceFolders),g=!!(i.textDocument&&i.textDocument.publishDiagnostics&&i.textDocument.publishDiagnostics.relatedInformation);const o={serverInfo:{name:"ahk2-language-server"},capabilities:{textDocumentSync:{openClose:!0,change:a.TextDocumentSyncKind.Incremental},completionProvider:{resolveProvider:!1,triggerCharacters:[".","#"]},signatureHelpProvider:{triggerCharacters:["(",","]},documentSymbolProvider:!0,definitionProvider:!0,documentFormattingProvider:!0,documentRangeFormattingProvider:!0,documentOnTypeFormattingProvider:{firstTriggerCharacter:"}",moreTriggerCharacter:["\n",...Object.keys(c.chinese_punctuations)]},executeCommandProvider:{commands:["ahk2.fix.include","ahk2.generate.comment","ahk2.generate.author","ahk2.resetinterpreterpath"]},hoverProvider:!0,foldingRangeProvider:!0,colorProvider:!0,codeActionProvider:!0,renameProvider:{prepareProvider:!0},referencesProvider:{workDoneProgress:!0},semanticTokensProvider:{legend:{tokenTypes:["class","function","method","parameter","variable","property","keyword","string","number"],tokenModifiers:["definition","readonly","static","deprecated","modification","documentation","defaultLibrary"]},full:{delta:!0},range:!0},workspaceSymbolProvider:!0}};let r,s;if(m&&(o.capabilities.workspace={workspaceFolders:{supported:!0}}),process.env.AHK2_LS_CONFIG)try{s=JSON.parse(process.env.AHK2_LS_CONFIG)}catch{}if(e.initializationOptions&&(s=Object.assign(null!=s?s:{},e.initializationOptions)),s){r=s.locale,"string"==typeof s.AutoLibInclude?s.AutoLibInclude=c.LibIncludeType[s.AutoLibInclude]:"boolean"==typeof s.AutoLibInclude&&(s.AutoLibInclude=s.AutoLibInclude?3:0),Object.assign(c.extsettings,s);try{(0,c.update_commentTags)(c.extsettings.CommentTags)}catch(e){setTimeout((()=>{d.console.error(e.message)}),1e3)}(0,t.existsSync)(c.extsettings.InterpreterPath)?b():setTimeout((()=>{d.window.showErrorMessage(c.setting.ahkpatherr())}),1e3)}return(null!=r?r:r=e.locale)&&(0,c.set_locale)(r),(0,c.loadlocalize)(),(0,c.initahk2cache)(),(0,c.loadahk2)(),o})),d.onInitialized((async()=>{h&&d.client.register(a.DidChangeConfigurationNotification.type,void 0),m&&d.workspace.onDidChangeWorkspaceFolders((e=>{let t=e.removed.map((e=>e.uri.toLowerCase()+"/"))||[];(0,c.set_Workfolder)(c.workspaceFolders.filter((e=>!t.includes(e)))),e.added.map((e=>c.workspaceFolders.push(e.uri.toLowerCase()+"/"))),(0,c.parseWorkspaceFolders)()})),(0,c.parseWorkspaceFolders)(),c.winapis.push(...S(["user32","kernel32","comctl32","gdi32"].map((e=>`C:\\Windows\\System32\\${e}.dll`))))})),d.onDidChangeConfiguration((async e=>{let t=null==e?void 0:e.settings;if(h&&!t&&(t=await d.workspace.getConfiguration("AutoHotkey2")),!t)return void d.window.showWarningMessage("Failed to obtain the configuration");let n={InterpreterPath:!1,AutoLibInclude:!1},i=c.extsettings.InterpreterPath;"string"==typeof t.AutoLibInclude?t.AutoLibInclude=c.LibIncludeType[t.AutoLibInclude]:"boolean"==typeof t.AutoLibInclude&&(t.AutoLibInclude=t.AutoLibInclude?3:0);for(let e in c.extsettings)c.extsettings[e]!==t[e]&&(n[e]=!0);if(Object.assign(c.extsettings,t),n.CommentTags)try{(0,c.update_commentTags)(c.extsettings.CommentTags)}catch(e){d.console.error(e.message)}n.InterpreterPath&&!c.ahkpath_cur&&T(i,c.extsettings.InterpreterPath),n.AutoLibInclude&&(c.extsettings.AutoLibInclude>1&&_(),1&c.extsettings.AutoLibInclude&&f.all().forEach((async e=>R(e.uri.toLowerCase()))))})),f.onDidOpen((async e=>{let t=e.document.uri.toLowerCase(),n=c.lexers[t];n?n.document=e.document:c.lexers[t]=n=new c.Lexer(e.document),n.actived=!0,1&c.extsettings.AutoLibInclude&&R(t)})),f.onDidClose((async e=>{let t=e.document.uri.toLowerCase();if(!c.lexers[t]||c.lexers[t].d&&!t.includes("?"))return;c.lexers[t].actived=!1;for(let e in c.lexers)if(c.lexers[e].actived)for(let n in c.lexers[e].relevance)if(n===t)return;d.sendDiagnostics({uri:c.lexers[t].document.uri,diagnostics:[]}),delete c.lexers[t];let n=[];for(let e in c.lexers)if(!c.lexers[e].actived&&(!c.lexers[e].d||e.includes("?"))){let t=!0;for(let n in c.lexers[e].relevance)if(c.lexers[n]&&c.lexers[n].actived){t=!1;break}t&&n.push(e)}for(let e of n)d.sendDiagnostics({uri:c.lexers[e].document.uri,diagnostics:[]}),delete c.lexers[e]})),f.onDidChangeContent((async e=>{var t;let n=e.document.uri.toLowerCase(),i=c.lexers[n],o=i.include,r=Object.keys(o).length;if(i.isparsed=!1,i.parseScript(),c.libfuncs[n]&&(c.libfuncs[n].length=0,c.libfuncs[n].push(...Object.values(i.declaration).filter((e=>e.kind===a.SymbolKind.Class||e.kind===a.SymbolKind.Function)))),Object.keys(i.include).length===r&&Object.keys(Object.assign(o,i.include)).length===r)return i.relevance||i.update_relevance(),void(0,c.sendDiagnostics)();(0,c.parseinclude)(i.include,i.scriptdir);for(const e in o)!i.include[e]&&(null===(t=c.lexers[e])||void 0===t?void 0:t.diagnostics.length)&&c.lexers[e].parseScript();!function(){for(const e in o)c.lexers[e]&&(c.lexers[e].relevance=(0,c.getincludetable)(e).list)}(),i.update_relevance(),(0,c.sendDiagnostics)()})),d.onDidChangeWatchedFiles((e=>{})),d.onCodeAction(c.codeActionProvider),d.onCompletion(c.completionProvider),d.onColorPresentation(c.colorPresentation),d.onDocumentColor(c.colorProvider),d.onDefinition(c.defintionProvider),d.onDocumentFormatting(c.documentFormatting),d.onDocumentRangeFormatting(c.rangeFormatting),d.onDocumentOnTypeFormatting(c.typeFormatting),d.onDocumentSymbol(c.symbolProvider),d.onFoldingRanges((async e=>c.lexers[e.textDocument.uri.toLowerCase()].foldingranges)),d.onHover(c.hoverProvider),d.onPrepareRename(c.prepareRename),d.onReferences(c.referenceProvider),d.onRenameRequest(c.renameProvider),d.onSignatureHelp(c.signatureProvider),d.onExecuteCommand((async function(e){let t=e.arguments||[];switch(e.command){case"ahk2.fix.include":(0,c.fixinclude)(t[0],t[1]);break;case"ahk2.generate.comment":(0,c.generateComment)(t);break;case"ahk2.generate.author":(0,c.generateAuthor)();break;case"ahk2.resetinterpreterpath":!async function(e){let t=c.ahkpath_cur||c.extsettings.InterpreterPath;e.toLowerCase()!==t.toLowerCase()&&((0,c.set_ahkpath)(e),T(t,e||c.extsettings.InterpreterPath))}(t[0])}})),d.onWorkspaceSymbol(c.workspaceSymbolProvider),d.languages.semanticTokens.on(c.semanticTokensOnFull),d.languages.semanticTokens.onDelta(c.semanticTokensOnDelta),d.languages.semanticTokens.onRange(c.semanticTokensOnRange),d.onRequest("ahk2.getAHKversion",w),d.onRequest("ahk2.getVersionInfo",(e=>{let t=c.lexers[e.toLowerCase()];if(t){let n=t.get_token(0);if(("TK_BLOCK_COMMENT"===n.type||""===n.type)&&n.content.match(/^\s*[;*]?\s*@(date|version)\b/im))return{uri:e,content:n.content,range:{start:t.document.positionAt(n.offset),end:t.document.positionAt(n.offset+n.length)}}}return null})),d.onRequest("ahk2.getContent",(e=>{var t;return null===(t=c.lexers[e.toLowerCase()])||void 0===t?void 0:t.document.getText()})),f.listen(d),d.listen()})();var o=exports;for(var r in i)o[r]=i[r];i.__esModule&&Object.defineProperty(o,"__esModule",{value:!0})})();